---
config:
  theme: dark
  themeVariables:
    primaryColor: '#E3F2FD'
    primaryTextColor: '#0D47A1'
    primaryBorderColor: '#2196F3'
    lineColor: '#1976D2'
    secondaryColor: '#F3E5F5'
    tertiaryColor: '#FFF3E0'
    noteBkgColor: '#FFFDE7'
    noteBorderColor: '#FBC02D'
  layout: elk
---
flowchart TB
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% DEMETERDOCS - PRICE LIST MANAGEMENT SYSTEM OVERVIEW
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% Purpose: Executive-level view of price list management system
    %% Scope: Complete flow from catalog setup to bulk operations
    %% Detail: High-level only - See subflows for implementation
    %% Updated: 2025-10-08 | Version: 1.0 | Mermaid v11.3.0+
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% LAYER 1: ADMIN ENTRY POINT
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    START@{ shape: stadium, label: "ğŸ›ï¸ Admin Accesses
    Price List Management
    Role: admin only" }

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% LAYER 2: MANAGEMENT TYPE SELECTION
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    SELECT_TYPE@{ shape: diamond, label: "Select Management Area?" }

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PATH 1: PACKAGING CATALOG MANAGEMENT
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% Detail: See 01_packaging_catalog_crud.mmd

    subgraph PACKAGING_PATH["ğŸ“¦ PACKAGING CATALOG MANAGEMENT"]
        direction TB

        PKG_ACTION@{ shape: diamond, label: "CRUD Operation?" }

        PKG_CREATE@{ shape: rect, label: "â• Create Packaging
        â€¢ Type: Maceta/Bandeja/Plug
        â€¢ Material: Plastic/Ceramic
        â€¢ Color: Black/White/Terra
        â€¢ Dimensions: Ã˜, Height
        â€¢ Volume: Liters
        â€¢ Auto-generate SKU" }

        PKG_READ@{ shape: rect, label: "ğŸ“‹ List/View Packaging
        Filters:
        â€¢ By Type
        â€¢ By Size
        â€¢ By Color
        Pagination: 50/page" }

        PKG_UPDATE@{ shape: rect, label: "âœï¸ Update Packaging
        Modify:
        â€¢ Dimensions
        â€¢ Color
        â€¢ Material
        âš ï¸ Affects current price list" }

        PKG_DELETE@{ shape: rect, label: "ğŸ—‘ï¸ Delete Packaging
        Validations:
        â€¢ Not in active price_list
        â€¢ Soft delete if has history
        â€¢ Cascade checks" }

        PKG_VALIDATE@{ shape: cyl, label: "Validate & Save
        DB: packaging_catalog
        Check: Unique SKU
        Check: Valid dimensions
        â±ï¸ < 100ms" }
    end

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PATH 2: PRODUCT CATALOG MANAGEMENT
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% Detail: See 02_product_catalog_crud.mmd

    subgraph PRODUCT_PATH["ğŸŒµ PRODUCT CATALOG MANAGEMENT"]
        direction TB

        PROD_LEVEL@{ shape: diamond, label: "Catalog Level?" }

        PROD_CAT@{ shape: rect, label: "ğŸ“ Manage Categories
        â€¢ Cactus
        â€¢ Suculenta
        â€¢ Injerto
        CRUD: Create/Update/Delete" }

        PROD_FAM@{ shape: rect, label: "ğŸ“‚ Manage Families
        Belongs to: Category
        â€¢ Scientific name
        â€¢ Common name
        Hierarchical structure" }

        PROD_ITEM@{ shape: rect, label: "ğŸŒ± Manage Products
        Belongs to: Family
        â€¢ SKU (unique)
        â€¢ Common name
        â€¢ Scientific name
        â€¢ Description" }

        PROD_VALIDATE@{ shape: cyl, label: "Validate & Save
        DB Tables:
        â€¢ product_categories
        â€¢ product_families
        â€¢ products
        Check: Referential integrity" }
    end

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PATH 3: PRICE LIST MANAGEMENT
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% Detail: See 03_price_list_management.mmd

    subgraph PRICE_PATH["ğŸ’° PRICE LIST MANAGEMENT"]
        direction TB

        PRICE_SELECT@{ shape: rect, label: "ğŸ”— Select Combination
        Product Category +
        Packaging Catalog

        Example:
        Cactus + R7 Black" }

        PRICE_FORM@{ shape: rect, label: "ğŸ“ Price Entry Form
        â€¢ Wholesale Unit Price ($)
        â€¢ Retail Unit Price ($)
        â€¢ SKU (auto or manual)
        â€¢ Units per Storage Box
        â€¢ Observations
        â€¢ Availability status" }

        PRICE_CALC@{ shape: rect, label: "ğŸ§® Auto Calculations
        wholesale_total_per_box =
        wholesale_unit_price Ã—
        units_per_box

        Validate: retail >= wholesale" }

        PRICE_SAVE@{ shape: cyl, label: "Save to Database
        DB: price_list

        Constraint:
        UNIQUE(packaging_id,
               category_id)

        â±ï¸ < 100ms" }
    end

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PATH 4: BULK OPERATIONS
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% Detail: See 04_bulk_edit_operations.mmd

    subgraph BULK_PATH["âš¡ BULK EDIT OPERATIONS"]
        direction TB

        BULK_TYPE@{ shape: diamond, label: "Bulk Operation Type?" }

        BULK_PRICE@{ shape: rect, label: "ğŸ’µ Bulk Price Update
        Operation:
        â€¢ Increase by X%
        â€¢ Decrease by X%

        Filters:
        â€¢ By category
        â€¢ By packaging type
        â€¢ By price range" }

        BULK_AVAIL@{ shape: rect, label: "ğŸ“Š Bulk Availability
        Change status:
        â€¢ Available
        â€¢ Out of Stock
        â€¢ Discontinued

        Apply to filtered items" }

        BULK_DISCOUNT@{ shape: rect, label: "ğŸ·ï¸ Bulk Discount
        Set discount_factor:
        â€¢ Percentage (0-100%)

        Apply to category/type" }

        BULK_PREVIEW@{ shape: rect, label: "ğŸ‘ï¸ Preview Changes
        Show affected items:
        â€¢ Count
        â€¢ Before/After values
        â€¢ Total impact

        Require confirmation" }

        BULK_EXECUTE@{ shape: cyl, label: "Execute Batch Update
        Single transaction:
        UPDATE price_list
        SET ... WHERE ...

        Audit log all changes
        â±ï¸ < 500ms (100 items)" }

        BULK_NOTIFY@{ shape: rect, label: "ğŸ“¢ Notify & Log
        â€¢ Audit trail
        â€¢ User notification
        â€¢ Change summary
        â€¢ Timestamp" }
    end

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% LAYER 3: RESULTS & VIEWS
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    DISPLAY@{ shape: rect, label: "ğŸ–¥ï¸ Display Results
    â€¢ Updated catalog view
    â€¢ Success messages
    â€¢ Change summary
    â€¢ Refresh lists" }

    EXPORT_OPTION@{ shape: diamond, label: "Export Data?" }

    EXPORT@{ shape: rect, label: "ğŸ“¤ Export Price List
    Formats:
    â€¢ Excel (.xlsx)
    â€¢ CSV
    â€¢ PDF (formatted)

    Include all metadata" }

    DOWNLOAD@{ shape: stadium, label: "â¬‡ï¸ Download File
    price_list_YYYYMMDD.xlsx" }

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% CONNECTIONS - MAIN FLOW
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    START --> SELECT_TYPE

    SELECT_TYPE -->|Packaging Catalog| PKG_ACTION
    SELECT_TYPE -->|Product Catalog| PROD_LEVEL
    SELECT_TYPE -->|Price List| PRICE_SELECT
    SELECT_TYPE -->|Bulk Operations| BULK_TYPE

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% CONNECTIONS - PACKAGING PATH
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    PKG_ACTION -->|Create| PKG_CREATE
    PKG_ACTION -->|Read/List| PKG_READ
    PKG_ACTION -->|Update| PKG_UPDATE
    PKG_ACTION -->|Delete| PKG_DELETE

    PKG_CREATE --> PKG_VALIDATE
    PKG_UPDATE --> PKG_VALIDATE
    PKG_DELETE --> PKG_VALIDATE
    PKG_VALIDATE --> DISPLAY

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% CONNECTIONS - PRODUCT PATH
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    PROD_LEVEL -->|Categories| PROD_CAT
    PROD_LEVEL -->|Families| PROD_FAM
    PROD_LEVEL -->|Products| PROD_ITEM

    PROD_CAT --> PROD_VALIDATE
    PROD_FAM --> PROD_VALIDATE
    PROD_ITEM --> PROD_VALIDATE
    PROD_VALIDATE --> DISPLAY

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% CONNECTIONS - PRICE PATH
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    PRICE_SELECT --> PRICE_FORM
    PRICE_FORM --> PRICE_CALC
    PRICE_CALC --> PRICE_SAVE
    PRICE_SAVE --> DISPLAY

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% CONNECTIONS - BULK PATH
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    BULK_TYPE -->|Update Prices| BULK_PRICE
    BULK_TYPE -->|Change Availability| BULK_AVAIL
    BULK_TYPE -->|Apply Discounts| BULK_DISCOUNT

    BULK_PRICE --> BULK_PREVIEW
    BULK_AVAIL --> BULK_PREVIEW
    BULK_DISCOUNT --> BULK_PREVIEW

    BULK_PREVIEW --> BULK_EXECUTE
    BULK_EXECUTE --> BULK_NOTIFY
    BULK_NOTIFY --> DISPLAY

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% CONNECTIONS - EXPORT
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    DISPLAY --> EXPORT_OPTION

    EXPORT_OPTION -->|No| DISPLAY
    EXPORT_OPTION -->|Yes| EXPORT

    EXPORT --> DOWNLOAD

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% STYLING
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    classDef packagingStyle fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    classDef productStyle fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px
    classDef priceStyle fill:#FFF3E0,stroke:#F57C00,stroke-width:2px
    classDef bulkStyle fill:#FFEBEE,stroke:#C62828,stroke-width:2px
    classDef exportStyle fill:#E8F5E9,stroke:#388E3C,stroke-width:2px

    class PKG_ACTION,PKG_CREATE,PKG_READ,PKG_UPDATE,PKG_DELETE,PKG_VALIDATE packagingStyle
    class PROD_LEVEL,PROD_CAT,PROD_FAM,PROD_ITEM,PROD_VALIDATE productStyle
    class PRICE_SELECT,PRICE_FORM,PRICE_CALC,PRICE_SAVE priceStyle
    class BULK_TYPE,BULK_PRICE,BULK_AVAIL,BULK_DISCOUNT,BULK_PREVIEW,BULK_EXECUTE,BULK_NOTIFY bulkStyle
    class EXPORT,DOWNLOAD exportStyle
