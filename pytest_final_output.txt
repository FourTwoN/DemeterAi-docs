
======================================================================
USING PostgreSQL + PostGIS TEST DATABASE
Database URL: postgresql+asyncpg://demeter_test:***@localhost:5434/demeterai_test
All tests (unit + integration) will use PostgreSQL
======================================================================

============================= test session starts ==============================
platform linux -- Python 3.12.11, pytest-8.4.2, pluggy-1.6.0 -- /home/lucasg/anaconda3/envs/demeterai_docs/bin/python3.12
cachedir: .pytest_cache
rootdir: /home/lucasg/proyectos/DemeterDocs
configfile: pyproject.toml
plugins: anyio-4.11.0, asyncio-1.2.0, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1327 items

tests/core/test_exceptions.py::TestAppBaseException::test_base_exception_creation PASSED [  0%]
tests/core/test_exceptions.py::TestAppBaseException::test_base_exception_default_values PASSED [  0%]
tests/core/test_exceptions.py::TestAppBaseException::test_base_exception_logs_server_errors PASSED [  0%]
tests/core/test_exceptions.py::TestAppBaseException::test_base_exception_logs_client_errors PASSED [  0%]
tests/core/test_exceptions.py::TestNotFoundException::test_not_found_exception_creation PASSED [  0%]
tests/core/test_exceptions.py::TestNotFoundException::test_not_found_exception_with_uuid PASSED [  0%]
tests/core/test_exceptions.py::TestValidationException::test_validation_exception_with_value PASSED [  0%]
tests/core/test_exceptions.py::TestValidationException::test_validation_exception_without_value PASSED [  0%]
tests/core/test_exceptions.py::TestProductMismatchException::test_product_mismatch_exception PASSED [  0%]
tests/core/test_exceptions.py::TestConfigNotFoundException::test_config_not_found_exception PASSED [  0%]
tests/core/test_exceptions.py::TestUnauthorizedException::test_unauthorized_exception_with_reason PASSED [  0%]
tests/core/test_exceptions.py::TestUnauthorizedException::test_unauthorized_exception_default PASSED [  0%]
tests/core/test_exceptions.py::TestForbiddenException::test_forbidden_exception_with_user_id PASSED [  0%]
tests/core/test_exceptions.py::TestForbiddenException::test_forbidden_exception_without_user_id PASSED [  1%]
tests/core/test_exceptions.py::TestDatabaseException::test_database_exception_complete PASSED [  1%]
tests/core/test_exceptions.py::TestDatabaseException::test_database_exception_minimal PASSED [  1%]
tests/core/test_exceptions.py::TestS3UploadException::test_s3_upload_exception PASSED [  1%]
tests/core/test_exceptions.py::TestMLProcessingException::test_ml_processing_exception PASSED [  1%]
tests/core/test_exceptions.py::TestExternalServiceException::test_external_service_exception_complete PASSED [  1%]
tests/core/test_exceptions.py::TestExternalServiceException::test_external_service_exception_minimal PASSED [  1%]
tests/core/test_exceptions.py::TestCeleryTaskException::test_celery_task_exception_complete PASSED [  1%]
tests/core/test_exceptions.py::TestCeleryTaskException::test_celery_task_exception_minimal PASSED [  1%]
tests/core/test_exceptions.py::TestExceptionHandlers::test_app_exception_handler_production_mode PASSED [  1%]
tests/core/test_exceptions.py::TestExceptionHandlers::test_app_exception_handler_debug_mode PASSED [  1%]
tests/core/test_exceptions.py::TestExceptionHandlers::test_generic_exception_handler PASSED [  1%]
tests/core/test_exceptions.py::TestExceptionHandlers::test_correlation_id_in_exception_response PASSED [  1%]
tests/core/test_exceptions.py::TestExceptionHandlers::test_timestamp_format_in_exception_response PASSED [  2%]
tests/core/test_exceptions.py::TestExceptionLogging::test_exception_includes_correlation_id_in_logs PASSED [  2%]
tests/core/test_exceptions.py::TestExceptionLogging::test_server_error_logs_with_stack_trace PASSED [  2%]
tests/core/test_exceptions.py::TestExceptionLogging::test_client_error_logs_without_stack_trace PASSED [  2%]
tests/core/test_exceptions.py::test_all_exceptions_inherit_from_base PASSED [  2%]
tests/core/test_exceptions.py::test_exception_count PASSED               [  2%]
tests/core/test_logging.py::TestLoggingConfiguration::test_setup_logging_default_level PASSED [  2%]
tests/core/test_logging.py::TestLoggingConfiguration::test_setup_logging_debug_level PASSED [  2%]
tests/core/test_logging.py::TestLoggingConfiguration::test_setup_logging_warning_level PASSED [  2%]
tests/core/test_logging.py::TestLoggingConfiguration::test_get_logger_returns_bound_logger PASSED [  2%]
tests/core/test_logging.py::TestCorrelationId::test_set_correlation_id_with_value PASSED [  2%]
tests/core/test_logging.py::TestCorrelationId::test_set_correlation_id_generates_uuid PASSED [  2%]
tests/core/test_logging.py::TestCorrelationId::test_get_correlation_id_empty_by_default PASSED [  2%]
tests/core/test_logging.py::TestCorrelationId::test_clear_correlation_id PASSED [  3%]
tests/core/test_logging.py::TestStructuredLogging::test_logger_outputs_json PASSED [  3%]
tests/core/test_logging.py::TestStructuredLogging::test_logger_includes_timestamp PASSED [  3%]
tests/core/test_logging.py::TestStructuredLogging::test_logger_includes_log_level PASSED [  3%]
tests/core/test_logging.py::TestStructuredLogging::test_logger_includes_correlation_id PASSED [  3%]
tests/core/test_logging.py::TestStructuredLogging::test_logger_without_correlation_id PASSED [  3%]
tests/core/test_logging.py::TestLogLevels::test_info_level_filters_debug PASSED [  3%]
tests/core/test_logging.py::TestLogLevels::test_warning_level_filters_info PASSED [  3%]
tests/core/test_logging.py::TestLogLevels::test_debug_level_shows_all PASSED [  3%]
tests/core/test_logging.py::TestExtraFields::test_logger_accepts_extra_fields PASSED [  3%]
tests/core/test_logging.py::TestExtraFields::test_logger_with_complex_extra_fields PASSED [  3%]
tests/db/test_session.py::TestDatabaseSession::test_engine_configuration PASSED [  3%]
tests/db/test_session.py::TestDatabaseSession::test_session_factory_exists PASSED [  3%]
tests/db/test_session.py::TestDatabaseSession::test_session_creation PASSED [  3%]
tests/db/test_session.py::TestDatabaseSession::test_get_db_session_dependency_success PASSED [  4%]
tests/db/test_session.py::TestDatabaseSession::test_get_db_session_dependency_rollback PASSED [  4%]
tests/db/test_session.py::TestDatabaseSession::test_connection_test_success PASSED [  4%]
tests/db/test_session.py::TestDatabaseSession::test_connection_test_failure PASSED [  4%]
tests/db/test_session.py::TestDatabaseSession::test_close_db_connection_success PASSED [  4%]
tests/db/test_session.py::TestDatabaseSession::test_close_db_connection_handles_errors PASSED [  4%]
tests/db/test_session.py::TestDatabaseSession::test_session_context_manager PASSED [  4%]
tests/db/test_session.py::TestDatabaseSession::test_multiple_sessions_concurrently PASSED [  4%]
tests/db/test_session.py::TestDatabaseConfiguration::test_database_url_format PASSED [  4%]
tests/db/test_session.py::TestDatabaseConfiguration::test_database_url_sync_format PASSED [  4%]
tests/db/test_session.py::TestDatabaseConfiguration::test_pool_size_configuration PASSED [  4%]
tests/db/test_session.py::TestDatabaseConfiguration::test_echo_sql_default PASSED [  4%]
tests/db/test_session.py::TestSessionTransactionManagement::test_auto_commit_on_success PASSED [  4%]
tests/db/test_session.py::TestSessionTransactionManagement::test_auto_rollback_on_error PASSED [  5%]
tests/db/test_session.py::TestSessionTransactionManagement::test_session_lifecycle_complete PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationAccuracy::test_estimation_accuracy_within_10_percent FAILED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationAccuracy::test_estimation_compensates_for_missed_detections FAILED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationAccuracy::test_estimation_bias_toward_overcount PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationPerspectiveCompensation::test_far_bands_have_smaller_plant_area PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationPerspectiveCompensation::test_gradient_plant_sizes_across_bands PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationPerformance::test_full_estimation_completes_under_2_seconds PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationPerformance::test_floor_suppression_performance PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationEndToEnd::test_estimations_match_db_schema FAILED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationEndToEnd::test_estimations_ready_for_bulk_insert PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationEndToEnd::test_multiple_containers_in_sequence PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationRobustness::test_handles_poor_lighting_conditions PASSED [  5%]
tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationRobustness::test_handles_high_density_residual_areas PASSED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationRealModels::test_load_both_models_same_worker SKIPPED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationRealModels::test_model_inference_works_after_loading SKIPPED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationRealModels::test_model_loaded_only_once_across_tasks PASSED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationRealModels::test_memory_usage_stable_after_100_loads PASSED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationPerformance::test_model_loading_time_acceptable PASSED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationPerformance::test_inference_performance_meets_targets SKIPPED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationPerformance::test_concurrent_model_access_no_deadlock PASSED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationCeleryTasks::test_task_uses_cached_model_across_invocations FAILED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationCeleryTasks::test_different_workers_use_different_models FAILED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationErrorRecovery::test_cache_recovers_after_failed_load PASSED [  6%]
tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationErrorRecovery::test_clear_cache_allows_reload PASSED [  6%]
tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineIntegration::test_complete_pipeline_with_real_services FAILED [  6%]
tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineIntegration::test_complete_pipeline_empty_image FAILED [  7%]
tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelinePerformance::test_pipeline_performance_cpu_benchmark FAILED [  7%]
tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineErrorRecovery::test_pipeline_handles_corrupted_image FAILED [  7%]
tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineErrorRecovery::test_pipeline_handles_missing_image FAILED [  7%]
tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineResultValidation::test_pipeline_results_match_database FAILED [  7%]
tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_create_and_persist_category ERROR [  7%]
tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_code_uniqueness_at_db_level ERROR [  7%]
tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_query_by_code ERROR [  7%]
tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_update_category ERROR [  7%]
tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_delete_category ERROR [  7%]
tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_order_by_name ERROR [  7%]
tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_count_categories ERROR [  7%]
tests/integration/models/test_product_size.py::TestProductSizeSeedData::test_seed_data_loaded ERROR [  7%]
tests/integration/models/test_product_size.py::TestProductSizeSeedData::test_seed_data_height_ranges ERROR [  7%]
tests/integration/models/test_product_size.py::TestProductSizeDBConstraints::test_code_unique_constraint_db_level ERROR [  8%]
tests/integration/models/test_product_size.py::TestProductSizeDBConstraints::test_code_check_constraint_min_length ERROR [  8%]
tests/integration/models/test_product_size.py::TestProductSizeQueries::test_order_by_sort_order ERROR [  8%]
tests/integration/models/test_product_size.py::TestProductSizeQueries::test_query_by_code ERROR [  8%]
tests/integration/models/test_product_size.py::TestProductSizeQueries::test_filter_with_height_range ERROR [  8%]
tests/integration/models/test_product_size.py::TestProductSizeQueries::test_filter_without_height_range ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateSeedData::test_seed_data_loaded ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateSeedData::test_seed_data_is_sellable_logic ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateDBConstraints::test_code_unique_constraint_db_level ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateDBConstraints::test_code_check_constraint_min_length ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateQueries::test_filter_by_is_sellable_true ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateQueries::test_filter_by_is_sellable_false ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateQueries::test_order_by_sort_order ERROR [  8%]
tests/integration/models/test_product_state.py::TestProductStateQueries::test_query_by_code ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGeneratedColumnArea::test_area_auto_calculated_on_insert ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGeneratedColumnArea::test_area_updates_when_geometry_changes ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGeneratedColumnArea::test_area_calculation_uses_geography_cast ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCentroidTrigger::test_centroid_auto_set_on_insert ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCentroidTrigger::test_centroid_within_polygon ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCentroidTrigger::test_centroid_updates_on_geometry_change ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_area_within_warehouse_success ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_area_outside_warehouse_rejected ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_area_partially_outside_rejected ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_update_area_outside_boundary_rejected ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaHierarchy::test_hierarchical_area_query ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCascadeDelete::test_cascade_delete_from_warehouse ERROR [  9%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCascadeDelete::test_cascade_delete_parent_area ERROR [ 10%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialQueries::test_find_area_by_gps_point ERROR [ 10%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialQueries::test_find_areas_within_radius ERROR [ 10%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGISTIndexPerformance::test_gist_index_used_for_spatial_query ERROR [ 10%]
tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCodeUniqueness::test_duplicate_code_rejected ERROR [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinCascadeDelete::test_cascade_delete_from_location ERROR [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinCascadeDelete::test_cascade_delete_from_area ERROR [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinCascadeDelete::test_cascade_delete_from_warehouse ERROR [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinRestrictDelete::test_restrict_delete_bin_type_with_bins SKIPPED [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinRestrictDelete::test_restrict_delete_bin_type_without_bins SKIPPED [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_confidence_high ERROR [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_confidence_low ERROR [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_container_type ERROR [ 10%]
tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_ml_model_version ERROR [ 11%]
tests/integration/models/test_storage_bin.py::TestStorageBinCodeUniqueness::test_code_uniqueness_enforced ERROR [ 11%]
tests/integration/models/test_storage_bin.py::TestStorageBinCodeUniqueness::test_different_codes_allowed ERROR [ 11%]
tests/integration/models/test_storage_bin.py::TestStorageBinForeignKeyIntegrity::test_invalid_storage_location_id ERROR [ 11%]
tests/integration/models/test_storage_bin.py::TestStorageBinForeignKeyIntegrity::test_null_storage_location_id ERROR [ 11%]
tests/integration/models/test_storage_bin.py::TestStorageBinForeignKeyIntegrity::test_null_storage_bin_type_id ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestSeedData::test_seed_data_loaded ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestSeedData::test_seed_data_integrity ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestRestrictDelete::test_delete_bin_type_with_storage_bins_fails ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestRestrictDelete::test_delete_bin_type_without_storage_bins_succeeds ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestRelationships::test_query_storage_bins_from_bin_type ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestRelationships::test_fk_integrity_storage_bins_to_bin_type ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestCodeUniqueness::test_create_two_types_with_same_code_fails ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestCodeUniqueness::test_create_types_with_different_codes_succeeds ERROR [ 11%]
tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_grid_type_with_null_rows_fails ERROR [ 12%]
tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_grid_type_with_null_columns_fails ERROR [ 12%]
tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_non_grid_type_with_null_rows_succeeds ERROR [ 12%]
tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_grid_type_with_rows_and_columns_succeeds ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationGeneratedColumnArea::test_area_always_zero_for_point ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCentroidTrigger::test_centroid_equals_coordinates_on_insert ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCentroidTrigger::test_centroid_updates_with_coordinates ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialContainment::test_location_within_area_success ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialContainment::test_location_outside_area_rejected ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialContainment::test_update_location_outside_area_rejected ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationQRCodeUniqueness::test_qr_code_uniqueness_enforced ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCascadeDelete::test_cascade_delete_from_area ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationPhotoSessionFK::test_photo_session_id_nullable ERROR [ 12%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialQueries::test_find_location_by_gps_point ERROR [ 13%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialQueries::test_find_locations_in_area ERROR [ 13%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationGISTIndexPerformance::test_gist_index_used_for_spatial_query ERROR [ 13%]
tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCodeUniqueness::test_duplicate_code_rejected ERROR [ 13%]
tests/integration/models/test_user_db.py::test_insert_user_all_fields ERROR [ 13%]
tests/integration/models/test_user_db.py::test_insert_user_minimal_fields ERROR [ 13%]
tests/integration/models/test_user_db.py::test_query_by_email ERROR      [ 13%]
tests/integration/models/test_user_db.py::test_query_by_role ERROR       [ 13%]
tests/integration/models/test_user_db.py::test_query_active_users ERROR  [ 13%]
tests/integration/models/test_user_db.py::test_unique_email_constraint_db ERROR [ 13%]
tests/integration/models/test_user_db.py::test_update_last_login ERROR   [ 13%]
tests/integration/models/test_user_db.py::test_soft_delete_user ERROR    [ 13%]
tests/integration/models/test_user_db.py::test_seed_admin_user_exists ERROR [ 13%]
tests/integration/models/test_user_db.py::test_case_insensitive_email ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGeneratedColumnArea::test_area_auto_calculated_on_insert ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGeneratedColumnArea::test_area_updates_when_geometry_changes ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGeneratedColumnArea::test_area_calculation_uses_geography_cast ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCentroidTrigger::test_centroid_auto_set_on_insert ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCentroidTrigger::test_centroid_within_polygon ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCentroidTrigger::test_centroid_updates_on_geometry_change ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseSpatialQueries::test_find_warehouses_within_radius ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseSpatialQueries::test_find_nearest_warehouse ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseSpatialQueries::test_point_in_polygon_localization ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGISTIndexPerformance::test_gist_index_used_for_spatial_query ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGISTIndexPerformance::test_gist_index_used_for_containment_query ERROR [ 14%]
tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCodeUniqueness::test_duplicate_code_rejected ERROR [ 14%]
tests/integration/tasks/test_ml_tasks_integration.py::TestMLTasksIntegration::test_ml_parent_task_updates_database ERROR [ 14%]
tests/integration/tasks/test_ml_tasks_integration.py::TestMLTasksIntegration::test_ml_child_task_with_real_session ERROR [ 15%]
tests/integration/tasks/test_ml_tasks_integration.py::TestMLTasksIntegration::test_ml_aggregation_callback_with_database ERROR [ 15%]
tests/integration/tasks/test_ml_tasks_integration.py::TestCeleryWorkerExecution::test_ml_parent_task_celery_dispatch SKIPPED [ 15%]
tests/integration/tasks/test_ml_tasks_integration.py::TestCeleryWorkerExecution::test_chord_pattern_execution SKIPPED [ 15%]
tests/integration/test_api_health.py::test_health_endpoint_returns_200 ERROR [ 15%]
tests/integration/test_api_health.py::test_health_endpoint_includes_correlation_id ERROR [ 15%]
tests/integration/test_api_health.py::test_health_endpoint_with_custom_correlation_id ERROR [ 15%]
tests/integration/test_celery_redis.py::test_redis_broker_connection PASSED [ 15%]
tests/integration/test_celery_redis.py::test_redis_result_backend_connection PASSED [ 15%]
tests/integration/test_celery_redis.py::test_celery_task_registration PASSED [ 15%]
tests/integration/test_celery_redis.py::test_celery_broker_connectivity PASSED [ 15%]
tests/integration/test_celery_redis.py::test_celery_inspect_available PASSED [ 15%]
tests/integration/test_celery_redis.py::test_redis_broker_database_separation PASSED [ 15%]
tests/integration/test_celery_redis.py::TestCeleryRedisIntegration::test_broker_url_accessible PASSED [ 16%]
tests/integration/test_celery_redis.py::TestCeleryRedisIntegration::test_result_backend_accessible PASSED [ 16%]
tests/integration/test_celery_redis.py::TestCeleryRedisIntegration::test_serialization_json_only PASSED [ 16%]
tests/integration/test_celery_redis.py::TestCeleryRedisIntegration::test_utc_timezone_configured PASSED [ 16%]
tests/integration/test_celery_redis.py::TestCeleryRedisIntegration::test_task_tracking_enabled PASSED [ 16%]
tests/integration/test_celery_redis.py::TestCeleryRedisIntegration::test_connection_retry_enabled PASSED [ 16%]
tests/integration/test_celery_redis.py::test_celery_app_name PASSED      [ 16%]
tests/integration/test_celery_redis.py::test_redis_connection_from_docker PASSED [ 16%]
tests/integration/test_product_category_service.py::test_create_category_success ERROR [ 16%]
tests/integration/test_product_category_service.py::test_create_category_minimal_fields ERROR [ 16%]
tests/integration/test_product_category_service.py::test_create_category_code_auto_uppercase ERROR [ 16%]
tests/integration/test_product_category_service.py::test_create_category_duplicate_code ERROR [ 16%]
tests/integration/test_product_category_service.py::test_get_category_by_id_success ERROR [ 16%]
tests/integration/test_product_category_service.py::test_get_category_by_id_not_found ERROR [ 17%]
tests/integration/test_product_category_service.py::test_get_all_categories_success ERROR [ 17%]
tests/integration/test_product_category_service.py::test_get_all_categories_empty_database ERROR [ 17%]
tests/integration/test_product_category_service.py::test_update_category_success ERROR [ 17%]
tests/integration/test_product_category_service.py::test_update_category_partial ERROR [ 17%]
tests/integration/test_product_category_service.py::test_update_category_not_found ERROR [ 17%]
tests/integration/test_product_category_service.py::test_delete_category_success ERROR [ 17%]
tests/integration/test_product_category_service.py::test_delete_category_not_found ERROR [ 17%]
tests/integration/test_product_category_service.py::test_category_code_validation ERROR [ 17%]
tests/integration/test_product_category_service.py::test_multiple_categories_independence ERROR [ 17%]
tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_create_family_with_category ERROR [ 17%]
tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_create_family_minimal_fields ERROR [ 17%]
tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_query_families_by_category ERROR [ 17%]
tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_query_family_with_category_join ERROR [ 18%]
tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_create_multiple_families_same_category ERROR [ 18%]
tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_cascade_delete_category_deletes_families ERROR [ 18%]
tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_foreign_key_constraint_invalid_category ERROR [ 18%]
tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_not_null_constraint_name ERROR [ 18%]
tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_not_null_constraint_category_id ERROR [ 18%]
tests/integration/test_product_family_db.py::TestProductFamilyUpdateDelete::test_update_family_name ERROR [ 18%]
tests/integration/test_product_family_db.py::TestProductFamilyUpdateDelete::test_delete_family ERROR [ 18%]
tests/integration/test_product_service.py::test_create_product_success ERROR [ 18%]
tests/integration/test_product_service.py::test_create_product_minimal_fields ERROR [ 18%]
tests/integration/test_product_service.py::test_create_product_sku_auto_increment ERROR [ 18%]
tests/integration/test_product_service.py::test_create_product_different_families_independent_skus ERROR [ 18%]
tests/integration/test_product_service.py::test_create_product_invalid_family ERROR [ 18%]
tests/integration/test_product_service.py::test_get_product_by_id_success ERROR [ 18%]
tests/integration/test_product_service.py::test_get_product_by_id_not_found ERROR [ 19%]
tests/integration/test_product_service.py::test_get_product_by_sku_success ERROR [ 19%]
tests/integration/test_product_service.py::test_get_product_by_sku_case_insensitive ERROR [ 19%]
tests/integration/test_product_service.py::test_get_product_by_sku_not_found ERROR [ 19%]
tests/integration/test_product_service.py::test_get_products_by_family_success ERROR [ 19%]
tests/integration/test_product_service.py::test_get_products_by_family_filtering ERROR [ 19%]
tests/integration/test_product_service.py::test_get_products_by_family_invalid_family ERROR [ 19%]
tests/integration/test_product_service.py::test_get_all_products_success ERROR [ 19%]
tests/integration/test_product_service.py::test_update_product_success ERROR [ 19%]
tests/integration/test_product_service.py::test_update_product_partial ERROR [ 19%]
tests/integration/test_product_service.py::test_update_product_sku_immutable ERROR [ 19%]
tests/integration/test_product_service.py::test_update_product_not_found ERROR [ 19%]
tests/integration/test_product_service.py::test_delete_product_success ERROR [ 19%]
tests/integration/test_product_service.py::test_delete_product_not_found ERROR [ 20%]
tests/integration/test_product_service.py::test_sku_generation_handles_family_name_with_spaces ERROR [ 20%]
tests/integration/test_product_service.py::test_sku_generation_truncates_long_family_names ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_upload_original_full_workflow ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_upload_with_metadata_integration ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_upload_visualization_integration ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_download_uploaded_image_workflow ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_delete_image_integration ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_delete_image_with_thumbnail_integration ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_generate_presigned_url_for_uploaded_image ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_concurrent_uploads_same_session ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_upload_different_content_types ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_upload_rollback_on_s3_failure ERROR [ 20%]
tests/integration/test_s3_image_service.py::test_delete_nonexistent_image_integration ERROR [ 21%]
tests/integration/test_s3_image_service.py::test_upload_with_invalid_gps_coordinates ERROR [ 21%]
tests/integration/test_s3_image_service.py::test_upload_with_valid_gps_coordinates ERROR [ 21%]
tests/integration/test_s3_image_service.py::test_upload_file_exceeds_limit_integration ERROR [ 21%]
tests/integration/test_s3_image_service.py::test_upload_maximum_allowed_file_size ERROR [ 21%]
tests/integration/test_s3_image_service.py::test_upload_sets_initial_status ERROR [ 21%]
tests/integration/test_s3_image_service.py::test_query_images_by_status ERROR [ 21%]
tests/integration/test_warehouse_service_integration.py::test_warehouse_service_full_lifecycle ERROR [ 21%]
tests/integration/test_warehouse_service_integration.py::test_gps_lookup_point_inside_polygon ERROR [ 21%]
tests/integration/test_warehouse_service_integration.py::test_gps_lookup_point_outside_polygon ERROR [ 21%]
tests/integration/test_warehouse_service_integration.py::test_duplicate_code_rejection ERROR [ 21%]
tests/integration/test_warehouse_service_integration.py::test_invalid_geometry_rejected ERROR [ 21%]
tests/integration/test_warehouse_service_integration.py::test_get_warehouse_by_id_not_found ERROR [ 21%]
tests/integration/test_warehouse_service_integration.py::test_update_warehouse_not_found ERROR [ 22%]
tests/integration/test_warehouse_service_integration.py::test_delete_warehouse_not_found ERROR [ 22%]
tests/integration/test_warehouse_service_integration.py::test_get_active_warehouses_filters_inactive ERROR [ 22%]
tests/integration/test_warehouse_service_integration.py::test_polygon_with_minimum_vertices ERROR [ 22%]
tests/integration/test_warehouse_service_integration.py::test_complex_polygon_with_many_vertices ERROR [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_seg_model_property_returns_cached_instance FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_det_model_property_returns_cached_instance FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_seg_and_det_models_are_different FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_models_use_correct_worker_id FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_extracted_from_gpu_hostname FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_defaults_to_zero_for_invalid_format FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_handles_no_request FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_handles_missing_hostname FAILED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskGPUCleanup::test_gpu_cleanup_every_100_tasks PASSED [ 22%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskGPUCleanup::test_gpu_cleanup_every_100_tasks_multiple_cycles PASSED [ 23%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskGPUCleanup::test_gpu_cleanup_skipped_on_cpu PASSED [ 23%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskGPUCleanup::test_gpu_cleanup_logged PASSED [ 23%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskGPUCleanup::test_after_return_handles_task_failure PASSED [ 23%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskIntegrationWithCache::test_multiple_tasks_share_same_model_instance FAILED [ 23%]
tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskIntegrationWithCache::test_tasks_on_different_workers_use_different_models FAILED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisBrokerPoolConfiguration::test_broker_pool_limit_configured PASSED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisBrokerPoolConfiguration::test_broker_connection_retry_enabled PASSED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisBrokerPoolConfiguration::test_broker_connection_max_retries_configured PASSED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisBrokerPoolConfiguration::test_broker_connection_retry_on_startup_enabled PASSED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisBrokerPoolConfiguration::test_broker_pool_limit_is_positive PASSED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisBrokerPoolConfiguration::test_broker_max_retries_is_positive PASSED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_transport_options_configured PASSED [ 23%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_socket_connect_timeout PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_socket_timeout PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_retry_on_timeout_enabled PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_max_connections_configured PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_health_check_configured PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_retry_on_timeout_flag PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_transport_retry_on_timeout_flag PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisResultBackendPoolConfiguration::test_result_backend_max_connections_is_positive PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisGlobalConnectionSettings::test_redis_max_connections_configured PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisGlobalConnectionSettings::test_redis_socket_timeout_configured PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisGlobalConnectionSettings::test_redis_socket_connect_timeout_configured PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisGlobalConnectionSettings::test_redis_max_connections_is_positive PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisGlobalConnectionSettings::test_redis_socket_timeout_is_positive PASSED [ 24%]
tests/unit/celery/test_redis_connection.py::TestRedisGlobalConnectionSettings::test_redis_socket_connect_timeout_is_positive PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionPoolLimits::test_broker_pool_limit_meets_requirement PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionPoolLimits::test_result_backend_max_connections_meets_requirement PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionPoolLimits::test_global_max_connections_meets_requirement PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionPoolLimits::test_broker_pool_smaller_than_result_backend PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisTimeoutConfiguration::test_connection_timeout_meets_requirement PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisTimeoutConfiguration::test_socket_timeout_meets_requirement PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisTimeoutConfiguration::test_global_timeout_meets_requirement PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisTimeoutConfiguration::test_all_timeouts_consistent PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisHealthCheckConfiguration::test_health_check_interval_configured PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisHealthCheckConfiguration::test_health_check_interval_is_positive PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionRetryConfiguration::test_broker_retry_enabled PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionRetryConfiguration::test_broker_retry_on_startup_enabled PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionRetryConfiguration::test_broker_max_retries_configured PASSED [ 25%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionRetryConfiguration::test_result_backend_retry_on_timeout_enabled PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionRetryConfiguration::test_result_backend_global_retry_enabled PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisConnectionRetryConfiguration::test_all_retry_mechanisms_enabled PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisAcceptanceCriteria::test_acceptance_criteria_connection_pool_size PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisAcceptanceCriteria::test_acceptance_criteria_max_connections PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisAcceptanceCriteria::test_acceptance_criteria_connection_timeout PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisAcceptanceCriteria::test_acceptance_criteria_health_check_enabled PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisConfigurationImport::test_celery_app_import_works PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisConfigurationImport::test_redis_configuration_accessible PASSED [ 26%]
tests/unit/celery/test_redis_connection.py::TestRedisConfigurationImport::test_configuration_values_are_correct_types PASSED [ 26%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_gpu_queue_exists PASSED [ 26%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_cpu_queue_exists PASSED [ 26%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_io_queue_exists PASSED [ 26%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_default_queue_exists PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_all_expected_queues_present PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_gpu_queue_has_exchange PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_cpu_queue_has_exchange PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_io_queue_has_exchange PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_gpu_queue_routing_key PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_cpu_queue_routing_key PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestWorkerTopologyConfiguration::test_io_queue_routing_key PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_task_routes_configured PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_ml_tasks_route_to_gpu_queue PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_aggregate_tasks_route_to_cpu_queue PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_upload_tasks_route_to_io_queue PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_task_routes_count PASSED [ 27%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_ml_tasks_routing_configuration PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_aggregate_tasks_routing_configuration PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestTaskRouting::test_upload_tasks_routing_configuration PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_gpu_worker_cmd_exists PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_cpu_worker_cmd_exists PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_io_worker_cmd_exists PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_gpu_worker_uses_solo_pool PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_gpu_worker_concurrency_one PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_gpu_worker_uses_gpu_queue PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_cpu_worker_uses_prefork_pool PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_cpu_worker_concurrency_four PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_cpu_worker_uses_cpu_queue PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_io_worker_uses_gevent_pool PASSED [ 28%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_io_worker_concurrency_fifty PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_io_worker_uses_io_queue PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_all_workers_use_celery_app PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_all_workers_have_hostname PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_gpu_worker_hostname_prefix PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_cpu_worker_hostname_prefix PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestWorkerStartupCommands::test_io_worker_hostname_prefix PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestGPUWorkerCriticalRequirements::test_gpu_worker_pool_is_solo_not_prefork PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestGPUWorkerCriticalRequirements::test_gpu_worker_pool_is_solo_not_threads PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestGPUWorkerCriticalRequirements::test_gpu_worker_single_concurrency PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestGPUWorkerCriticalRequirements::test_task_routing_sends_ml_to_gpu_queue PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestGPUWorkerCriticalRequirements::test_gpu_queue_exists_for_routing PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestDefaultQueueConfiguration::test_default_queue_is_default PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestDefaultQueueConfiguration::test_default_exchange_is_default PASSED [ 29%]
tests/unit/celery/test_worker_topology.py::TestDefaultQueueConfiguration::test_default_routing_key_is_default PASSED [ 30%]
tests/unit/celery/test_worker_topology.py::TestWorkerPoolTypes::test_gpu_worker_not_using_unsupported_pools PASSED [ 30%]
tests/unit/celery/test_worker_topology.py::TestWorkerPoolTypes::test_cpu_worker_uses_optimal_pool PASSED [ 30%]
tests/unit/celery/test_worker_topology.py::TestWorkerPoolTypes::test_io_worker_uses_optimal_pool PASSED [ 30%]
tests/unit/celery/test_worker_topology.py::TestWorkerPoolTypes::test_each_worker_type_uses_different_pool PASSED [ 30%]
tests/unit/celery/test_worker_topology.py::TestQueueIsolation::test_queues_have_separate_exchanges PASSED [ 30%]
tests/unit/celery/test_worker_topology.py::TestQueueIsolation::test_routing_keys_match_queue_names PASSED [ 30%]
tests/unit/models/test_classification.py::TestClassificationModel::test_create_classification_with_all_fks PASSED [ 30%]
tests/unit/models/test_classification.py::TestClassificationModel::test_create_classification_with_product_only PASSED [ 30%]
tests/unit/models/test_classification.py::TestClassificationModel::test_create_classification_with_packaging_only PASSED [ 30%]
tests/unit/models/test_classification.py::TestClassificationModel::test_create_classification_with_size_only PASSED [ 30%]
tests/unit/models/test_classification.py::TestClassificationModel::test_create_classification_minimal_required_fields PASSED [ 30%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_product_conf_min_value PASSED [ 30%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_product_conf_max_value PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_product_conf_mid_range PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_product_conf_nullable PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_packaging_conf_valid PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_packaging_conf_nullable PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_product_size_conf_valid PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_product_size_conf_nullable PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_all_conf_fields_together PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationConfidenceFields::test_conf_fields_independent PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationFKValidation::test_all_fks_null_raises_error PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationFKValidation::test_product_and_packaging_both_present PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationFKValidation::test_product_and_size_both_present PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationFKValidation::test_packaging_and_size_both_present PASSED [ 31%]
tests/unit/models/test_classification.py::TestClassificationModelVersion::test_model_version_nullable PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationModelVersion::test_model_version_valid PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationModelVersion::test_model_version_formats PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationNameDescription::test_name_nullable PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationNameDescription::test_name_valid PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationNameDescription::test_description_nullable PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationNameDescription::test_description_valid PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationNameDescription::test_name_and_description_together PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationFieldValidation::test_nullable_packaging_catalog_id PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationFieldValidation::test_nullable_product_size_id PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationFieldValidation::test_nullable_product_id PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationFieldValidation::test_all_fields_nullable_except_one_fk PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationRepr::test_repr_with_all_fks PASSED [ 32%]
tests/unit/models/test_classification.py::TestClassificationRepr::test_repr_with_product_only PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationRepr::test_repr_without_classification_id PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_table_name PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_table_comment PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_column_comments PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_primary_key PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_foreign_key_cascade PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_check_constraints_exist PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_confidence_fields_integer_type PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_model_version_varchar_type PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_name_varchar_type PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationTableMetadata::test_description_text_type PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationRelationships::test_product_relationship_exists PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationRelationships::test_product_relationship_type_hint PASSED [ 33%]
tests/unit/models/test_classification.py::TestClassificationRelationships::test_product_size_relationship_exists PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationRelationships::test_product_size_relationship_type_hint PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationRelationships::test_packaging_catalog_relationship_commented_out FAILED [ 34%]
tests/unit/models/test_classification.py::TestClassificationRelationships::test_detections_relationship_commented_out FAILED [ 34%]
tests/unit/models/test_classification.py::TestClassificationRelationships::test_estimations_relationship_commented_out FAILED [ 34%]
tests/unit/models/test_classification.py::TestClassificationEdgeCases::test_very_low_confidence PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationEdgeCases::test_zero_confidence PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationEdgeCases::test_perfect_confidence PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationEdgeCases::test_all_confidence_fields_at_max PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationEdgeCases::test_mixed_confidence_values PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationEdgeCases::test_long_model_version_string PASSED [ 34%]
tests/unit/models/test_classification.py::TestClassificationEdgeCases::test_long_description_text PASSED [ 34%]
tests/unit/models/test_detection.py::TestDetectionBasicCRUD::test_create_detection_minimal_fields ERROR [ 34%]
tests/unit/models/test_detection.py::TestDetectionBasicCRUD::test_create_detection_all_fields ERROR [ 35%]
tests/unit/models/test_detection.py::TestDetectionBasicCRUD::test_read_detection_by_id ERROR [ 35%]
tests/unit/models/test_detection.py::TestDetectionConfidenceValidation::test_confidence_min_value ERROR [ 35%]
tests/unit/models/test_detection.py::TestDetectionConfidenceValidation::test_confidence_max_value ERROR [ 35%]
tests/unit/models/test_detection.py::TestDetectionConfidenceValidation::test_confidence_out_of_range_high PASSED [ 35%]
tests/unit/models/test_detection.py::TestDetectionConfidenceValidation::test_confidence_cannot_be_null PASSED [ 35%]
tests/unit/models/test_detection.py::TestDetectionBboxValidation::test_width_px_positive PASSED [ 35%]
tests/unit/models/test_detection.py::TestDetectionBboxValidation::test_height_px_positive PASSED [ 35%]
tests/unit/models/test_detection.py::TestDetectionBboxValidation::test_bbox_coordinates_required_keys PASSED [ 35%]
tests/unit/models/test_detection.py::TestDetectionBboxValidation::test_bbox_coordinates_cannot_be_null PASSED [ 35%]
tests/unit/models/test_detection.py::TestDetectionBooleanFlags::test_is_empty_container_true ERROR [ 35%]
tests/unit/models/test_detection.py::TestDetectionBooleanFlags::test_is_alive_false ERROR [ 35%]
tests/unit/models/test_detection.py::TestDetectionTimestamps::test_created_at_auto_populated ERROR [ 35%]
tests/unit/models/test_detection.py::TestDetectionCascadeDelete::test_delete_session_cascades_to_detections ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationBasicCRUD::test_create_estimation_minimal_fields ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationBasicCRUD::test_create_estimation_all_fields ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationBasicCRUD::test_read_estimation_by_id ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationCalculationMethodEnum::test_calculation_method_band_estimation ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationCalculationMethodEnum::test_calculation_method_density_estimation ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationCalculationMethodEnum::test_calculation_method_grid_analysis ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationConfidenceValidation::test_confidence_default_value ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationConfidenceValidation::test_confidence_min_value ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationConfidenceValidation::test_confidence_max_value ERROR [ 36%]
tests/unit/models/test_estimation.py::TestEstimationConfidenceValidation::test_confidence_out_of_range_high PASSED [ 36%]
tests/unit/models/test_estimation.py::TestEstimationAreaCountValidation::test_detected_area_cm2_non_negative PASSED [ 36%]
tests/unit/models/test_estimation.py::TestEstimationAreaCountValidation::test_estimated_count_non_negative PASSED [ 36%]
tests/unit/models/test_estimation.py::TestEstimationAreaCountValidation::test_vegetation_polygon_cannot_be_null PASSED [ 37%]
tests/unit/models/test_estimation.py::TestEstimationTimestamps::test_created_at_auto_populated ERROR [ 37%]
tests/unit/models/test_estimation.py::TestEstimationCascadeDelete::test_delete_session_cascades_to_estimations ERROR [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipInstantiation::test_create_contains_relationship PASSED [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipInstantiation::test_create_adjacent_to_relationship PASSED [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipInstantiation::test_relationship_type_enum_values PASSED [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipInstantiation::test_relationship_type_string_value PASSED [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipForeignKeys::test_parent_location_id_assignment PASSED [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipForeignKeys::test_child_location_id_assignment PASSED [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipForeignKeys::test_different_location_ids PASSED [ 37%]
tests/unit/models/test_location_relationships.py::TestLocationRelationshipRepresentation::test_repr_method PASSED [ 37%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_create_session_minimal_fields ERROR [ 37%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_create_session_all_fields ERROR [ 37%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_read_session_by_id ERROR [ 37%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_update_session_status ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_delete_session_cascade ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_pending ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_processing ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_completed ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_failed ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_min_value ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_max_value ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_out_of_range_high ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_nullable ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_category_counts_empty_dict_default ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_category_counts_with_data ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_manual_adjustments_empty_dict_default ERROR [ 38%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_manual_adjustments_with_data ERROR [ 39%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionAggregates::test_aggregates_default_zero ERROR [ 39%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionAggregates::test_aggregates_with_values ERROR [ 39%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionTimestamps::test_created_at_auto_populated ERROR [ 39%]
tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionTimestamps::test_updated_at_on_modification ERROR [ 39%]
tests/unit/models/test_product.py::TestProductModel::test_create_product_with_all_fields PASSED [ 39%]
tests/unit/models/test_product.py::TestProductModel::test_create_product_minimal_required_fields PASSED [ 39%]
tests/unit/models/test_product.py::TestProductModel::test_common_name_required PASSED [ 39%]
tests/unit/models/test_product.py::TestProductModel::test_family_id_required PASSED [ 39%]
tests/unit/models/test_product.py::TestProductModel::test_sku_required PASSED [ 39%]
tests/unit/models/test_product.py::TestProductModel::test_scientific_name_nullable PASSED [ 39%]
tests/unit/models/test_product.py::TestProductModel::test_description_nullable PASSED [ 39%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_valid_sku_with_hyphens PASSED [ 39%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_valid_sku_multiple_hyphens PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_valid_sku_no_hyphen PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_uppercase_conversion PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_mixed_case_conversion PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_minimum_length PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_maximum_length PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_too_short_raises_error PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_too_long_raises_error PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_invalid_characters_underscore PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_invalid_characters_space PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_invalid_characters_special PASSED [ 40%]
tests/unit/models/test_product.py::TestProductSKUValidation::test_sku_none_raises_error PASSED [ 40%]
tests/unit/models/test_product.py::TestProductCustomAttributes::test_custom_attributes_default_empty_dict PASSED [ 40%]
tests/unit/models/test_product.py::TestProductCustomAttributes::test_custom_attributes_none_converts_to_empty_dict PASSED [ 40%]
tests/unit/models/test_product.py::TestProductCustomAttributes::test_custom_attributes_simple_dict PASSED [ 41%]
tests/unit/models/test_product.py::TestProductCustomAttributes::test_custom_attributes_nested_dict PASSED [ 41%]
tests/unit/models/test_product.py::TestProductCustomAttributes::test_custom_attributes_complex_metadata PASSED [ 41%]
tests/unit/models/test_product.py::TestProductFieldValidation::test_long_common_name PASSED [ 41%]
tests/unit/models/test_product.py::TestProductFieldValidation::test_long_scientific_name PASSED [ 41%]
tests/unit/models/test_product.py::TestProductFieldValidation::test_long_description PASSED [ 41%]
tests/unit/models/test_product.py::TestProductFieldValidation::test_unicode_characters_in_names PASSED [ 41%]
tests/unit/models/test_product.py::TestProductRepr::test_repr_with_all_fields PASSED [ 41%]
tests/unit/models/test_product.py::TestProductRepr::test_repr_with_minimal_fields PASSED [ 41%]
tests/unit/models/test_product.py::TestProductRepr::test_repr_without_product_id PASSED [ 41%]
tests/unit/models/test_product.py::TestProductTableMetadata::test_table_name PASSED [ 41%]
tests/unit/models/test_product.py::TestProductTableMetadata::test_table_comment PASSED [ 41%]
tests/unit/models/test_product.py::TestProductTableMetadata::test_column_comments PASSED [ 41%]
tests/unit/models/test_product.py::TestProductTableMetadata::test_primary_key PASSED [ 42%]
tests/unit/models/test_product.py::TestProductTableMetadata::test_foreign_key_cascade PASSED [ 42%]
tests/unit/models/test_product.py::TestProductTableMetadata::test_sku_unique_constraint PASSED [ 42%]
tests/unit/models/test_product.py::TestProductTableMetadata::test_check_constraints_exist PASSED [ 42%]
tests/unit/models/test_product.py::TestProductRelationships::test_family_relationship_exists PASSED [ 42%]
tests/unit/models/test_product.py::TestProductRelationships::test_family_relationship_type_hint PASSED [ 42%]
tests/unit/models/test_product.py::TestProductRelationships::test_stock_batches_relationship_commented_out FAILED [ 42%]
tests/unit/models/test_product.py::TestProductRelationships::test_classifications_relationship_exists PASSED [ 42%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_valid_uppercase PASSED [ 42%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_auto_uppercase PASSED [ 42%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_empty_raises_error PASSED [ 42%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_with_hyphens_raises_error PASSED [ 42%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_with_spaces_raises_error PASSED [ 42%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_too_short_raises_error PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_too_long_raises_error PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_with_underscores_valid PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_with_numbers_valid PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryCodeValidation::test_code_mixed_case_uppercased PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryFields::test_create_category_with_all_fields PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryFields::test_description_nullable PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryFields::test_all_fields_assignable PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryRepr::test_repr_format PASSED [ 43%]
tests/unit/models/test_product_category.py::TestProductCategoryRepr::test_repr_without_id PASSED [ 43%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_create_family_with_all_fields PASSED [ 43%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_create_family_minimal_required_fields PASSED [ 43%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_family_name_required PASSED [ 43%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_category_id_required PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_scientific_name_nullable PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_description_nullable PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_long_name PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_long_scientific_name PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyModel::test_long_description PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyRepr::test_repr_with_all_fields PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyRepr::test_repr_with_minimal_fields PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyRepr::test_repr_without_family_id PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyTableMetadata::test_table_name PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyTableMetadata::test_table_comment PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyTableMetadata::test_column_comments PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyTableMetadata::test_primary_key PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyTableMetadata::test_foreign_key_cascade PASSED [ 44%]
tests/unit/models/test_product_family.py::TestProductFamilyRelationships::test_category_relationship_exists PASSED [ 45%]
tests/unit/models/test_product_family.py::TestProductFamilyRelationships::test_category_relationship_type_hint PASSED [ 45%]
tests/unit/models/test_product_family.py::TestProductFamilyRelationships::test_products_relationship_commented_out FAILED [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_valid_uppercase ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_valid_three_chars ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_auto_uppercase ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_empty_raises_error ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_with_hyphens_raises_error ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_with_spaces_raises_error ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_too_short_raises_error ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_too_long_raises_error ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_with_underscores_valid ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_height_ranges_nullable ERROR [ 45%]
tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_height_ranges_valid_values ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_custom_size_no_height_ranges ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_xxl_no_max_height ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeSortOrder::test_sort_order_default_99 ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeSortOrder::test_sort_order_custom_value ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeSortOrder::test_sort_order_zero_valid ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeBasicCRUD::test_create_product_size ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeBasicCRUD::test_update_product_size ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeBasicCRUD::test_delete_product_size ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeRepr::test_repr_format_with_range ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeRepr::test_repr_format_no_range ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeUniqueness::test_duplicate_code_raises_integrity_error ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeFields::test_name_required ERROR [ 46%]
tests/unit/models/test_product_size.py::TestProductSizeFields::test_description_nullable ERROR [ 47%]
tests/unit/models/test_product_size.py::TestProductSizeFields::test_timestamps_auto_generated ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_valid_uppercase ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_auto_uppercase ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_empty_raises_error ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_with_hyphens_raises_error ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_with_spaces_raises_error ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_too_short_raises_error ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_too_long_raises_error ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_with_underscores_valid ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateSellableFlag::test_is_sellable_default_false ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateSellableFlag::test_is_sellable_explicit_true ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateSellableFlag::test_is_sellable_explicit_false ERROR [ 47%]
tests/unit/models/test_product_state.py::TestProductStateSortOrder::test_sort_order_default_99 ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateSortOrder::test_sort_order_custom_value ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateSortOrder::test_sort_order_zero_valid ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateBasicCRUD::test_create_product_state ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateBasicCRUD::test_update_product_state ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateBasicCRUD::test_delete_product_state ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateRepr::test_repr_format ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateUniqueness::test_duplicate_code_raises_integrity_error ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateFields::test_name_required ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateFields::test_description_nullable ERROR [ 48%]
tests/unit/models/test_product_state.py::TestProductStateFields::test_timestamps_auto_generated ERROR [ 48%]
tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_format_validation PASSED [ 48%]
tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_requires_hyphen FAILED [ 48%]
tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_uppercase_enforced FAILED [ 48%]
tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_alphanumeric_only FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_length_validation FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_required FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_empty_string FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaPositionEnum::test_position_enum_valid_values PASSED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaPositionEnum::test_position_enum_invalid_values FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaPositionEnum::test_position_nullable PASSED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaForeignKeys::test_warehouse_id_required FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaForeignKeys::test_parent_area_id_nullable PASSED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaRelationships::test_warehouse_relationship PASSED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaRelationships::test_self_referential_relationship PASSED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaRequiredFields::test_name_field_required FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaRequiredFields::test_geometry_field_required FAILED [ 49%]
tests/unit/models/test_storage_area.py::TestStorageAreaDefaultValues::test_active_defaults_to_true FAILED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaDefaultValues::test_timestamps_auto_set PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaGeometryAssignment::test_geometry_assignment_from_shapely_polygon PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaGeometryAssignment::test_geometry_assignment_with_correct_srid PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaGeometryAssignment::test_geometry_complex_polygon PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaFieldCombinations::test_create_north_position_area PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaFieldCombinations::test_create_south_position_area PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaFieldCombinations::test_create_center_position_area PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaFieldCombinations::test_create_area_without_position PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaFieldCombinations::test_inactive_storage_area PASSED [ 50%]
tests/unit/models/test_storage_area.py::TestStorageAreaFieldCombinations::test_hierarchical_area_with_parent PASSED [ 50%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_format_4_parts_valid PASSED [ 50%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_format_3_parts_invalid PASSED [ 50%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_format_2_parts_invalid PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_format_5_parts_invalid SKIPPED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_uppercase_enforced PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_mixed_case_auto_converted PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_length_validation_minimum PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_length_validation_maximum PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_alphanumeric_validation PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_empty_rejected PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_none_rejected PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinCodeValidation::test_code_whitespace_only_rejected PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinStatusEnum::test_status_enum_valid_values PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinStatusEnum::test_status_default_active PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinStatusEnum::test_status_transition_active_to_maintenance PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinStatusEnum::test_status_transition_maintenance_to_active PASSED [ 51%]
tests/unit/models/test_storage_bin.py::TestStorageBinStatusEnum::test_status_transition_active_to_retired PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinStatusEnum::test_status_transition_maintenance_to_retired PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinStatusEnum::test_status_transition_retired_is_terminal PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinPositionMetadata::test_position_metadata_default_null PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinPositionMetadata::test_position_metadata_accepts_valid_json PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinPositionMetadata::test_position_metadata_partial_schema PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinPositionMetadata::test_position_metadata_nullable PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinPositionMetadata::test_position_metadata_empty_dict PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinForeignKeys::test_storage_location_id_required PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinForeignKeys::test_storage_bin_type_id_nullable PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinForeignKeys::test_storage_bin_type_id_accepts_integer PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinRelationships::test_storage_location_relationship PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinRelationships::test_storage_bin_type_relationship PASSED [ 52%]
tests/unit/models/test_storage_bin.py::TestStorageBinRequiredFields::test_code_field_required PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinRequiredFields::test_storage_location_id_field_required PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinRequiredFields::test_label_field_nullable PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinDefaultValues::test_status_defaults_to_active PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinDefaultValues::test_timestamps_auto_set PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinFieldCombinations::test_create_bin_with_all_fields PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinFieldCombinations::test_create_bin_with_minimal_fields PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinFieldCombinations::test_update_status PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinFieldCombinations::test_bin_with_high_confidence PASSED [ 53%]
tests/unit/models/test_storage_bin.py::TestStorageBinFieldCombinations::test_bin_with_low_confidence PASSED [ 53%]
tests/unit/models/test_storage_bin_type.py::TestBinCategoryEnum::test_valid_categories PASSED [ 53%]
tests/unit/models/test_storage_bin_type.py::TestBinCategoryEnum::test_enum_values_list PASSED [ 53%]
tests/unit/models/test_storage_bin_type.py::TestBinCategoryEnum::test_category_assignment PASSED [ 53%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_valid_code_uppercase PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_lowercase_code_auto_uppercases PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_mixed_case_code_auto_uppercases PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_invalid_code_with_hyphens PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_invalid_code_with_special_chars PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_invalid_code_empty PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_invalid_code_too_short PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_invalid_code_too_long PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestCodeValidation::test_code_with_numbers PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestNullableDimensions::test_create_type_with_all_dimensions_null PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestNullableDimensions::test_create_type_with_partial_dimensions PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestGridFlag::test_grid_type_with_rows_and_columns PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestGridFlag::test_non_grid_type_without_rows_columns PASSED [ 54%]
tests/unit/models/test_storage_bin_type.py::TestRelationships::test_storage_bins_relationship_exists PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestRelationships::test_density_parameters_relationship_commented_out PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestBasicCRUD::test_create_type_with_all_fields PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestBasicCRUD::test_create_type_with_minimal_fields FAILED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestBasicCRUD::test_repr PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestFieldConstraints::test_code_required FAILED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestFieldConstraints::test_name_required FAILED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestFieldConstraints::test_category_required FAILED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestDefaultValues::test_is_grid_default_false FAILED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestDefaultValues::test_created_at_auto_set PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestFieldCombinations::test_plug_tray_with_grid PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestFieldCombinations::test_seedling_tray_with_grid PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestFieldCombinations::test_box_without_grid PASSED [ 55%]
tests/unit/models/test_storage_bin_type.py::TestFieldCombinations::test_segment_no_dimensions PASSED [ 55%]
tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_valid_formats PASSED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_uppercase_enforced PASSED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_alphanumeric_validation PASSED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_length_validation FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_required FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_empty_string_rejected FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_whitespace_only_rejected FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_format_validation PASSED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_requires_two_hyphens PASSED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_uppercase_enforced FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_alphanumeric_only FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_length_validation FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_required FAILED [ 56%]
tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_empty_string FAILED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationPositionMetadata::test_position_metadata_default_empty_dict PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationPositionMetadata::test_position_metadata_accepts_valid_json PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationPositionMetadata::test_position_metadata_nullable PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationGeometry::test_geometry_accepts_point PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationGeometry::test_geometry_with_correct_srid PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationGeometry::test_geometry_rejects_polygon PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationForeignKeys::test_storage_area_id_required FAILED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationForeignKeys::test_photo_session_id_nullable PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationRelationships::test_storage_area_relationship PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationRelationships::test_latest_photo_session_relationship PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationRelationships::test_storage_bins_relationship PASSED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationRequiredFields::test_name_field_required FAILED [ 57%]
tests/unit/models/test_storage_location.py::TestStorageLocationRequiredFields::test_geometry_field_required FAILED [ 58%]
tests/unit/models/test_storage_location.py::TestStorageLocationDefaultValues::test_active_defaults_to_true FAILED [ 58%]
tests/unit/models/test_storage_location.py::TestStorageLocationDefaultValues::test_timestamps_auto_set PASSED [ 58%]
tests/unit/models/test_storage_location.py::TestStorageLocationFieldCombinations::test_create_location_with_photo_session PASSED [ 58%]
tests/unit/models/test_storage_location.py::TestStorageLocationFieldCombinations::test_create_location_without_photo_session PASSED [ 58%]
tests/unit/models/test_storage_location.py::TestStorageLocationFieldCombinations::test_inactive_storage_location FAILED [ 58%]
tests/unit/models/test_storage_location.py::TestStorageLocationFieldCombinations::test_location_with_complex_position_metadata PASSED [ 58%]
tests/unit/models/test_user.py::TestUserModel::test_create_user_with_all_fields PASSED [ 58%]
tests/unit/models/test_user.py::TestUserModel::test_create_user_with_minimal_fields PASSED [ 58%]
tests/unit/models/test_user.py::TestUserModel::test_role_default_worker PASSED [ 58%]
tests/unit/models/test_user.py::TestUserModel::test_active_default_true PASSED [ 58%]
tests/unit/models/test_user.py::TestUserModel::test_last_login_nullable PASSED [ 58%]
tests/unit/models/test_user.py::TestUserEmailValidation::test_email_valid_formats PASSED [ 58%]
tests/unit/models/test_user.py::TestUserEmailValidation::test_email_invalid_formats PASSED [ 59%]
tests/unit/models/test_user.py::TestUserEmailValidation::test_email_normalized_lowercase PASSED [ 59%]
tests/unit/models/test_user.py::TestUserEmailValidation::test_email_mixed_case_normalization PASSED [ 59%]
tests/unit/models/test_user.py::TestUserPasswordHashValidation::test_password_hash_valid_bcrypt PASSED [ 59%]
tests/unit/models/test_user.py::TestUserPasswordHashValidation::test_password_hash_invalid_format PASSED [ 59%]
tests/unit/models/test_user.py::TestUserPasswordHashValidation::test_password_hash_wrong_length PASSED [ 59%]
tests/unit/models/test_user.py::TestUserRoleEnum::test_role_enum_all_values PASSED [ 59%]
tests/unit/models/test_user.py::TestUserRoleEnum::test_role_admin PASSED [ 59%]
tests/unit/models/test_user.py::TestUserRoleEnum::test_role_supervisor PASSED [ 59%]
tests/unit/models/test_user.py::TestUserRoleEnum::test_role_viewer PASSED [ 59%]
tests/unit/models/test_user.py::TestUserProperties::test_full_name_property PASSED [ 59%]
tests/unit/models/test_user.py::TestUserProperties::test_full_name_property_with_unicode PASSED [ 59%]
tests/unit/models/test_user.py::TestUserRepr::test_repr_with_all_fields PASSED [ 59%]
tests/unit/models/test_user.py::TestUserRepr::test_repr_with_minimal_fields PASSED [ 59%]
tests/unit/models/test_user.py::TestUserRepr::test_repr_without_id PASSED [ 60%]
tests/unit/models/test_user.py::TestUserTableMetadata::test_table_name PASSED [ 60%]
tests/unit/models/test_user.py::TestUserTableMetadata::test_table_comment PASSED [ 60%]
tests/unit/models/test_user.py::TestUserTableMetadata::test_column_comments PASSED [ 60%]
tests/unit/models/test_user.py::TestUserTableMetadata::test_primary_key PASSED [ 60%]
tests/unit/models/test_user.py::TestUserTableMetadata::test_email_unique_constraint PASSED [ 60%]
tests/unit/models/test_user.py::TestUserRelationships::test_relationships_commented_out FAILED [ 60%]
tests/unit/models/test_user.py::TestUserRelationships::test_relationship_attributes_not_present FAILED [ 60%]
tests/unit/models/test_warehouse.py::TestWarehouseCodeValidation::test_warehouse_code_uppercase_enforced PASSED [ 60%]
tests/unit/models/test_warehouse.py::TestWarehouseCodeValidation::test_warehouse_code_alphanumeric_only PASSED [ 60%]
tests/unit/models/test_warehouse.py::TestWarehouseCodeValidation::test_warehouse_code_length_validation PASSED [ 60%]
tests/unit/models/test_warehouse.py::TestWarehouseCodeValidation::test_warehouse_code_required PASSED [ 60%]
tests/unit/models/test_warehouse.py::TestWarehouseCodeValidation::test_warehouse_code_empty_string PASSED [ 60%]
tests/unit/models/test_warehouse.py::TestWarehouseTypeEnum::test_warehouse_type_enum_valid_values PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseTypeEnum::test_warehouse_type_enum_invalid_values FAILED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseTypeEnum::test_warehouse_type_required FAILED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseRequiredFields::test_name_field_required FAILED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseRequiredFields::test_geometry_field_required FAILED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseDefaultValues::test_active_defaults_to_true FAILED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseDefaultValues::test_timestamps_auto_set PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseGeometryAssignment::test_geometry_assignment_from_shapely_polygon PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseGeometryAssignment::test_geometry_assignment_with_correct_srid PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseGeometryAssignment::test_geometry_complex_polygon PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseFieldCombinations::test_create_greenhouse_type PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseFieldCombinations::test_create_shadehouse_type PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseFieldCombinations::test_create_open_field_type PASSED [ 61%]
tests/unit/models/test_warehouse.py::TestWarehouseFieldCombinations::test_create_tunnel_type PASSED [ 62%]
tests/unit/models/test_warehouse.py::TestWarehouseFieldCombinations::test_inactive_warehouse PASSED [ 62%]
tests/unit/repositories/test_base_repository.py::test_create_record ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_by_id_found ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_by_id_not_found ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_update_partial ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_update_not_found ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_delete_existing ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_delete_not_found ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_multi_pagination_first_page ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_multi_pagination_second_page ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_multi_empty_result ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_multi_limit_zero ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_multi_with_single_filter ERROR [ 62%]
tests/unit/repositories/test_base_repository.py::test_get_multi_with_multiple_filters ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_count_without_filters ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_count_with_filters ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_count_empty_table ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_exists_true ERROR  [ 63%]
tests/unit/repositories/test_base_repository.py::test_exists_false ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_flush_without_commit ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_multiple_operations_same_session ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_create_with_missing_required_field ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_update_multiple_fields ERROR [ 63%]
tests/unit/repositories/test_base_repository.py::test_get_multi_large_skip ERROR [ 63%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_valid_request_small_file PASSED [ 63%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_valid_request_large_file PASSED [ 63%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_valid_request_empty_file PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_valid_request_binary_data PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_invalid_file_not_bytes PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_invalid_file_integer PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_missing_required_field_file PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_model_dump PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadRequest::test_model_dump_json PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_valid_response_all_fields PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_valid_response_uuid_string PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_valid_response_different_statuses PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_valid_response_large_session_id PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_valid_response_long_message PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_valid_response_url_formats PASSED [ 64%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_invalid_task_id_not_uuid PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_invalid_task_id_integer PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_invalid_session_id_string PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_valid_status_empty PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_missing_required_field_task_id PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_missing_required_field_session_id PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_missing_required_field_status PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_missing_required_field_message PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_missing_required_field_poll_url PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_model_dump PASSED [ 65%]
tests/unit/schemas/test_photo_schema.py::TestPhotoUploadResponse::test_model_dump_json PASSED [ 65%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_valid_request_all_fields PASSED [ 65%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_valid_request_minimal_fields PASSED [ 65%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_valid_request_max_quantity PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_valid_request_notes_at_max_length PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_valid_request_empty_notes PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_storage_location_id_zero PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_storage_location_id_negative PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_product_id_zero PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_packaging_catalog_id_negative PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_product_size_id_zero PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_quantity_zero PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_quantity_negative PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_notes_too_long PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_invalid_planting_date_string PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_missing_required_field_storage_location_id PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_missing_required_field_quantity PASSED [ 66%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_model_dump PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestManualStockInitRequest::test_model_dump_json PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_plantado PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_muerte PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_trasplante PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_ventas PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_ajuste PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_positive_quantity PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_negative_quantity PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_zero_quantity PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_valid_request_notes_at_max_length PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_invalid_storage_batch_id_zero PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_invalid_storage_batch_id_negative PASSED [ 67%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_invalid_movement_type_empty PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_invalid_movement_type_wrong_value PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_invalid_movement_type_case_sensitive PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_invalid_notes_too_long PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_missing_required_field_storage_batch_id PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_missing_required_field_movement_type PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_missing_required_field_quantity PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_model_dump PASSED [ 68%]
tests/unit/schemas/test_stock_schema.py::TestStockMovementRequest::test_model_dump_json PASSED [ 68%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimation::test_valid_band_estimation_creation PASSED [ 68%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimation::test_band_estimation_converts_to_dict PASSED [ 68%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimation::test_band_estimation_area_balance PASSED [ 68%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_divide_into_bands_four_equal_bands PASSED [ 68%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_divide_into_bands_custom_count PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_divide_into_bands_handles_odd_height PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_divide_into_bands_preserves_mask_values PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_create_detection_mask_from_bboxes PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_create_detection_mask_empty_detections PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_create_detection_mask_uses_soft_edges PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_calibrate_plant_size_sufficient_samples PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_calibrate_plant_size_insufficient_samples_fallback PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_calibrate_plant_size_filters_by_band_y_range PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_calibrate_plant_size_removes_outliers_iqr PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_calibrate_plant_size_all_outliers_fallback PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_suppress_floor_reduces_residual_area PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_suppress_floor_uses_otsu_thresholding PASSED [ 69%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_suppress_floor_uses_hsv_color_filtering PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_suppress_floor_applies_morphological_opening PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_alpha_overcount_default_is_0_9 PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_alpha_overcount_custom_value PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_alpha_overcount_increases_estimated_count PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_estimate_undetected_plants_complete_workflow PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_estimate_undetected_plants_no_residual_area PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_estimate_undetected_plants_empty_detections PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationService::test_estimate_undetected_plants_performance_benchmark PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationServiceErrors::test_estimate_undetected_plants_invalid_image_path PASSED [ 70%]
tests/unit/services/ml_processing/test_band_estimation_service.py::TestBandEstimationServiceErrors::test_suppress_floor_empty_residual_mask PASSED [ 70%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheSingleton::test_same_instance_returned_for_same_params PASSED [ 70%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheSingleton::test_separate_instances_for_different_workers PASSED [ 70%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheSingleton::test_separate_instances_for_different_model_types PASSED [ 70%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheSingleton::test_cache_key_format PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheDeviceAssignment::test_gpu_assignment_when_available PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheDeviceAssignment::test_cpu_fallback_when_gpu_unavailable PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheDeviceAssignment::test_gpu_fallback_when_worker_id_exceeds_gpu_count PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheDeviceAssignment::test_model_fuse_called_for_optimization PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheDeviceAssignment::test_device_assignment_logged PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheThreadSafety::test_concurrent_access_from_multiple_threads PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheThreadSafety::test_concurrent_access_different_models PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheThreadSafety::test_lock_released_after_exception PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheMemoryManagement::test_clear_cache_empties_instances PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheMemoryManagement::test_clear_cache_empties_gpu_memory PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheMemoryManagement::test_clear_cache_skips_gpu_cleanup_on_cpu PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheMemoryManagement::test_clear_cache_thread_safe PASSED [ 71%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheErrorHandling::test_invalid_model_type_raises_error PASSED [ 72%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheErrorHandling::test_negative_worker_id_raises_error PASSED [ 72%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheErrorHandling::test_model_loading_exception_propagates PASSED [ 72%]
tests/unit/services/ml_processing/test_model_cache.py::TestModelCacheErrorHandling::test_get_model_paths_returns_valid_paths PASSED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_success FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_progress_updates FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_result_aggregation FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_no_segments FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_segmentation_fails FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_detection_fails_warning FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_estimation_fails_warning FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_persistence_fails FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorContainerTypeRouting::test_process_complete_pipeline_segments_use_sahi FAILED [ 72%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorContainerTypeRouting::test_process_complete_pipeline_boxes_use_direct FAILED [ 73%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorContainerTypeRouting::test_process_complete_pipeline_plugs_use_direct FAILED [ 73%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEstimationLogic::test_process_complete_pipeline_estimation_only_for_segments FAILED [ 73%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEstimationLogic::test_process_complete_pipeline_estimation_receives_detections FAILED [ 73%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorPerformance::test_process_complete_pipeline_performance_benchmark FAILED [ 73%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEdgeCases::test_process_complete_pipeline_invalid_session_id FAILED [ 73%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEdgeCases::test_process_complete_pipeline_invalid_image_path PASSED [ 73%]
tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEdgeCases::test_process_complete_pipeline_zero_confidence_detections FAILED [ 73%]
tests/unit/services/test_batch_lifecycle_service.py::test_calculate_batch_age_days_normal PASSED [ 73%]
tests/unit/services/test_batch_lifecycle_service.py::test_calculate_batch_age_days_today PASSED [ 73%]
tests/unit/services/test_batch_lifecycle_service.py::test_calculate_batch_age_days_none PASSED [ 73%]
tests/unit/services/test_batch_lifecycle_service.py::test_estimate_ready_date_normal PASSED [ 73%]
tests/unit/services/test_batch_lifecycle_service.py::test_estimate_ready_date_none_planting PASSED [ 73%]
tests/unit/services/test_batch_lifecycle_service.py::test_estimate_ready_date_zero_growth PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_seedling PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_growing PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_mature PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_ready PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_default_quality PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_boundary_stage_30_days PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_boundary_stage_90_days PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_boundary_health_good PASSED [ 74%]
tests/unit/services/test_batch_lifecycle_service.py::test_check_batch_status_boundary_health_warning PASSED [ 74%]
tests/unit/services/test_density_parameter_service.py::test_create_density_parameter_success PASSED [ 74%]
tests/unit/services/test_density_parameter_service.py::test_create_density_parameter_default_threshold PASSED [ 74%]
tests/unit/services/test_density_parameter_service.py::test_get_by_id_success PASSED [ 74%]
tests/unit/services/test_density_parameter_service.py::test_get_by_id_not_found PASSED [ 74%]
tests/unit/services/test_density_parameter_service.py::test_get_all_success PASSED [ 75%]
tests/unit/services/test_density_parameter_service.py::test_get_all_empty PASSED [ 75%]
tests/unit/services/test_density_parameter_service.py::test_update_density_parameter_success PASSED [ 75%]
tests/unit/services/test_density_parameter_service.py::test_update_density_parameter_not_found PASSED [ 75%]
tests/unit/services/test_density_parameter_service.py::test_delete_density_parameter_success PASSED [ 75%]
tests/unit/services/test_density_parameter_service.py::test_delete_density_parameter_not_found PASSED [ 75%]
tests/unit/services/test_location_hierarchy_service.py::test_get_full_hierarchy_success PASSED [ 75%]
tests/unit/services/test_location_hierarchy_service.py::test_get_full_hierarchy_multiple_areas PASSED [ 75%]
tests/unit/services/test_location_hierarchy_service.py::test_get_full_hierarchy_empty_areas PASSED [ 75%]
tests/unit/services/test_location_hierarchy_service.py::test_lookup_gps_full_chain_success PASSED [ 75%]
tests/unit/services/test_location_hierarchy_service.py::test_lookup_gps_full_chain_location_not_found PASSED [ 75%]
tests/unit/services/test_location_hierarchy_service.py::test_lookup_gps_full_chain_no_bins PASSED [ 75%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_inbound_success PASSED [ 75%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_outbound_success PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_positive_outbound_success PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_zero_quantity PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_inbound_negative_quantity PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_outbound_positive_quantity PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_missing_movement_type PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_empty_movement_type PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_none_movement_type PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_multiple_errors PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_all_errors PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_inbound_negative_and_zero PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_default_quantity_zero PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_default_is_inbound_false PASSED [ 76%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_large_positive_quantity PASSED [ 77%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_large_negative_quantity PASSED [ 77%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_various_movement_types PASSED [ 77%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_return_structure_valid PASSED [ 77%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_return_structure_invalid PASSED [ 77%]
tests/unit/services/test_movement_validation_service.py::test_validate_movement_request_empty_dict PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_create_success PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_create_different_dimensions PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_create_validates_positive_dimensions PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_get_by_id_success PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_get_by_id_not_found PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_get_all_success PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_get_all_empty PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_get_all_with_custom_limit PASSED [ 77%]
tests/unit/services/test_packaging_catalog_service.py::test_update_success PASSED [ 78%]
tests/unit/services/test_packaging_catalog_service.py::test_update_not_found PASSED [ 78%]
tests/unit/services/test_packaging_catalog_service.py::test_update_partial_name_only PASSED [ 78%]
tests/unit/services/test_packaging_catalog_service.py::test_update_partial_dimensions_only PASSED [ 78%]
tests/unit/services/test_packaging_catalog_service.py::test_delete_success PASSED [ 78%]
tests/unit/services/test_packaging_catalog_service.py::test_delete_not_found PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_create_packaging_color_success PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_get_by_id_success PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_get_by_id_not_found PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_get_all_success PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_get_all_empty PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_update_packaging_color_success PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_update_packaging_color_not_found PASSED [ 78%]
tests/unit/services/test_packaging_color_service.py::test_delete_packaging_color_success PASSED [ 79%]
tests/unit/services/test_packaging_color_service.py::test_delete_packaging_color_not_found PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_create_packaging_material_success PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_get_by_id_success PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_get_by_id_not_found PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_get_all_success PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_get_all_empty PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_update_packaging_material_success PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_update_packaging_material_not_found PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_delete_packaging_material_success PASSED [ 79%]
tests/unit/services/test_packaging_material_service.py::test_delete_packaging_material_not_found PASSED [ 79%]
tests/unit/services/test_packaging_type_service.py::test_create_packaging_type_success PASSED [ 79%]
tests/unit/services/test_packaging_type_service.py::test_get_by_id_success PASSED [ 79%]
tests/unit/services/test_packaging_type_service.py::test_get_by_id_not_found PASSED [ 80%]
tests/unit/services/test_packaging_type_service.py::test_get_all_success PASSED [ 80%]
tests/unit/services/test_packaging_type_service.py::test_get_all_empty PASSED [ 80%]
tests/unit/services/test_packaging_type_service.py::test_update_packaging_type_success PASSED [ 80%]
tests/unit/services/test_packaging_type_service.py::test_update_packaging_type_not_found PASSED [ 80%]
tests/unit/services/test_packaging_type_service.py::test_delete_packaging_type_success PASSED [ 80%]
tests/unit/services/test_packaging_type_service.py::test_delete_packaging_type_not_found PASSED [ 80%]
tests/unit/services/test_price_list_service.py::test_create_success PASSED [ 80%]
tests/unit/services/test_price_list_service.py::test_create_default_currency PASSED [ 80%]
tests/unit/services/test_price_list_service.py::test_create_with_custom_currency PASSED [ 80%]
tests/unit/services/test_price_list_service.py::test_get_by_id_success PASSED [ 80%]
tests/unit/services/test_price_list_service.py::test_get_by_id_not_found PASSED [ 80%]
tests/unit/services/test_price_list_service.py::test_get_all_success PASSED [ 80%]
tests/unit/services/test_price_list_service.py::test_get_all_empty PASSED [ 81%]
tests/unit/services/test_price_list_service.py::test_get_all_with_custom_limit PASSED [ 81%]
tests/unit/services/test_price_list_service.py::test_update_success PASSED [ 81%]
tests/unit/services/test_price_list_service.py::test_update_not_found PASSED [ 81%]
tests/unit/services/test_price_list_service.py::test_update_partial_name_only PASSED [ 81%]
tests/unit/services/test_price_list_service.py::test_update_partial_price_only PASSED [ 81%]
tests/unit/services/test_price_list_service.py::test_delete_success PASSED [ 81%]
tests/unit/services/test_price_list_service.py::test_delete_not_found PASSED [ 81%]
tests/unit/services/test_product_category_service.py::test_create_category_success PASSED [ 81%]
tests/unit/services/test_product_category_service.py::test_create_category_minimal_fields PASSED [ 81%]
tests/unit/services/test_product_category_service.py::test_get_category_by_id_success PASSED [ 81%]
tests/unit/services/test_product_category_service.py::test_get_category_by_id_not_found PASSED [ 81%]
tests/unit/services/test_product_category_service.py::test_get_all_categories_success PASSED [ 81%]
tests/unit/services/test_product_category_service.py::test_get_all_categories_empty PASSED [ 81%]
tests/unit/services/test_product_category_service.py::test_get_all_categories_active_only_flag PASSED [ 82%]
tests/unit/services/test_product_category_service.py::test_update_category_success PASSED [ 82%]
tests/unit/services/test_product_category_service.py::test_update_category_not_found PASSED [ 82%]
tests/unit/services/test_product_category_service.py::test_update_category_partial PASSED [ 82%]
tests/unit/services/test_product_category_service.py::test_delete_category_success PASSED [ 82%]
tests/unit/services/test_product_category_service.py::test_delete_category_not_found PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_create_family_success PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_create_family_minimal_fields PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_create_family_invalid_category PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_get_family_by_id_success PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_get_family_by_id_not_found PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_get_all_families_success PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_get_all_families_empty PASSED [ 82%]
tests/unit/services/test_product_family_service.py::test_update_family_success PASSED [ 83%]
tests/unit/services/test_product_family_service.py::test_update_family_not_found PASSED [ 83%]
tests/unit/services/test_product_family_service.py::test_update_family_partial PASSED [ 83%]
tests/unit/services/test_product_family_service.py::test_delete_family_success PASSED [ 83%]
tests/unit/services/test_product_family_service.py::test_delete_family_not_found PASSED [ 83%]
tests/unit/services/test_product_service.py::test_create_product_success PASSED [ 83%]
tests/unit/services/test_product_service.py::test_create_product_minimal_fields PASSED [ 83%]
tests/unit/services/test_product_service.py::test_create_product_invalid_family PASSED [ 83%]
tests/unit/services/test_product_service.py::test_create_product_auto_increments_sku PASSED [ 83%]
tests/unit/services/test_product_service.py::test_get_product_by_id_success PASSED [ 83%]
tests/unit/services/test_product_service.py::test_get_product_by_id_not_found PASSED [ 83%]
tests/unit/services/test_product_service.py::test_get_product_by_sku_success PASSED [ 83%]
tests/unit/services/test_product_service.py::test_get_product_by_sku_case_insensitive PASSED [ 83%]
tests/unit/services/test_product_service.py::test_get_product_by_sku_not_found PASSED [ 84%]
tests/unit/services/test_product_service.py::test_get_products_by_family_success PASSED [ 84%]
tests/unit/services/test_product_service.py::test_get_products_by_family_empty PASSED [ 84%]
tests/unit/services/test_product_service.py::test_get_products_by_family_invalid_family PASSED [ 84%]
tests/unit/services/test_product_service.py::test_get_all_products_success PASSED [ 84%]
tests/unit/services/test_product_service.py::test_get_all_products_empty PASSED [ 84%]
tests/unit/services/test_product_service.py::test_update_product_success PASSED [ 84%]
tests/unit/services/test_product_service.py::test_update_product_not_found PASSED [ 84%]
tests/unit/services/test_product_service.py::test_update_product_partial PASSED [ 84%]
tests/unit/services/test_product_service.py::test_update_product_sku_immutable PASSED [ 84%]
tests/unit/services/test_product_service.py::test_delete_product_success PASSED [ 84%]
tests/unit/services/test_product_service.py::test_delete_product_not_found PASSED [ 84%]
tests/unit/services/test_product_service.py::test_generate_sku_first_product PASSED [ 84%]
tests/unit/services/test_product_service.py::test_generate_sku_handles_family_name_with_spaces PASSED [ 85%]
tests/unit/services/test_product_service.py::test_generate_sku_long_family_name_truncated PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_create_product_size_success PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_create_product_size_small PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_get_by_id_success PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_get_by_id_not_found PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_get_all_success PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_get_all_empty PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_update_product_size_success PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_update_product_size_not_found PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_delete_product_size_success PASSED [ 85%]
tests/unit/services/test_product_size_service.py::test_delete_product_size_not_found PASSED [ 85%]
tests/unit/services/test_product_state_service.py::test_create_product_state_success PASSED [ 85%]
tests/unit/services/test_product_state_service.py::test_create_product_state_not_sellable PASSED [ 85%]
tests/unit/services/test_product_state_service.py::test_get_by_id_success PASSED [ 86%]
tests/unit/services/test_product_state_service.py::test_get_by_id_not_found PASSED [ 86%]
tests/unit/services/test_product_state_service.py::test_get_all_success PASSED [ 86%]
tests/unit/services/test_product_state_service.py::test_get_all_empty PASSED [ 86%]
tests/unit/services/test_product_state_service.py::test_update_product_state_success PASSED [ 86%]
tests/unit/services/test_product_state_service.py::test_update_product_state_not_found PASSED [ 86%]
tests/unit/services/test_product_state_service.py::test_delete_product_state_success PASSED [ 86%]
tests/unit/services/test_product_state_service.py::test_delete_product_state_not_found PASSED [ 86%]
tests/unit/services/test_s3_image_service.py::test_upload_original_success PASSED [ 86%]
tests/unit/services/test_s3_image_service.py::test_upload_original_file_too_large PASSED [ 86%]
tests/unit/services/test_s3_image_service.py::test_upload_original_file_too_small PASSED [ 86%]
tests/unit/services/test_s3_image_service.py::test_upload_original_s3_failure PASSED [ 86%]
tests/unit/services/test_s3_image_service.py::test_upload_original_with_metadata PASSED [ 86%]
tests/unit/services/test_s3_image_service.py::test_upload_visualization_success PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_upload_visualization_s3_failure PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_download_original_success PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_download_original_not_found PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_download_original_s3_failure PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_generate_presigned_url_success PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_generate_presigned_url_default_expiry PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_generate_presigned_url_invalid_key PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_delete_image_success PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_delete_image_not_found PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_delete_image_with_thumbnail PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_delete_image_s3_failure_rollback PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_upload_with_special_characters_in_filename PASSED [ 87%]
tests/unit/services/test_s3_image_service.py::test_upload_concurrent_same_session PASSED [ 88%]
tests/unit/services/test_s3_image_service.py::test_generate_presigned_url_custom_expiry PASSED [ 88%]
tests/unit/services/test_s3_image_service.py::test_download_large_image PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_create_stock_batch_success PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_create_stock_batch_duplicate_code PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_create_stock_batch_minimal_data PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_get_batch_by_id_success PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_get_batch_by_id_not_found PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_update_batch_quantity_success PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_update_batch_quantity_to_zero PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_update_batch_quantity_increase PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_create_stock_batch_with_zero_empty_containers PASSED [ 88%]
tests/unit/services/test_stock_batch_service.py::test_create_stock_batch_without_packaging PASSED [ 88%]
tests/unit/services/test_stock_movement_service.py::test_create_stock_movement_success PASSED [ 88%]
tests/unit/services/test_stock_movement_service.py::test_create_stock_movement_outbound PASSED [ 89%]
tests/unit/services/test_stock_movement_service.py::test_create_stock_movement_from_ml_pipeline PASSED [ 89%]
tests/unit/services/test_stock_movement_service.py::test_create_stock_movement_transfer PASSED [ 89%]
tests/unit/services/test_stock_movement_service.py::test_create_stock_movement_with_pricing PASSED [ 89%]
tests/unit/services/test_stock_movement_service.py::test_create_stock_movement_minimal_fields PASSED [ 89%]
tests/unit/services/test_stock_movement_service.py::test_create_stock_movement_uuid_uniqueness PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_create_storage_area_success PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_create_storage_area_warehouse_not_found PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_create_storage_area_duplicate_code PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_create_storage_area_geometry_out_of_bounds PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_get_storage_area_by_id_success PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_get_storage_area_by_id_not_found PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_get_storage_area_by_gps_found PASSED [ 89%]
tests/unit/services/test_storage_area_service.py::test_get_storage_area_by_gps_not_found PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_get_areas_by_warehouse_without_locations PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_get_areas_by_warehouse_with_locations PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_calculate_utilization_success PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_calculate_utilization_area_not_found PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_update_storage_area_success PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_update_storage_area_not_found PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_delete_storage_area_success PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_delete_storage_area_not_found PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_validate_within_parent_valid PASSED [ 90%]
tests/unit/services/test_storage_area_service.py::test_validate_within_parent_out_of_bounds PASSED [ 90%]
tests/unit/services/test_storage_bin_service.py::test_create_storage_bin_success PASSED [ 90%]
tests/unit/services/test_storage_bin_service.py::test_create_storage_bin_duplicate_code FAILED [ 90%]
tests/unit/services/test_storage_bin_service.py::test_get_storage_bin_by_id_success PASSED [ 91%]
tests/unit/services/test_storage_bin_service.py::test_get_storage_bin_by_id_not_found PASSED [ 91%]
tests/unit/services/test_storage_bin_service.py::test_get_bins_by_location_success FAILED [ 91%]
tests/unit/services/test_storage_bin_service.py::test_get_bins_by_location_empty FAILED [ 91%]
tests/unit/services/test_storage_bin_type_service.py::test_create_bin_type_success PASSED [ 91%]
tests/unit/services/test_storage_bin_type_service.py::test_create_bin_type_without_description PASSED [ 91%]
tests/unit/services/test_storage_bin_type_service.py::test_get_bin_type_by_id_success PASSED [ 91%]
tests/unit/services/test_storage_bin_type_service.py::test_get_bin_type_by_id_not_found PASSED [ 91%]
tests/unit/services/test_storage_bin_type_service.py::test_get_all_bin_types_success PASSED [ 91%]
tests/unit/services/test_storage_bin_type_service.py::test_get_all_bin_types_empty PASSED [ 91%]
tests/unit/services/test_storage_location_config_service.py::test_create_success PASSED [ 91%]
tests/unit/services/test_storage_location_config_service.py::test_create_with_zero_quantity PASSED [ 91%]
tests/unit/services/test_storage_location_config_service.py::test_create_different_location PASSED [ 91%]
tests/unit/services/test_storage_location_config_service.py::test_get_by_id_success PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_get_by_id_not_found PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_get_all_success PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_get_all_empty PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_get_all_with_custom_limit PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_update_success PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_update_not_found PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_update_partial_product_only PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_update_partial_quantity_only PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_update_partial_multiple_fields PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_delete_success PASSED [ 92%]
tests/unit/services/test_storage_location_config_service.py::test_delete_not_found PASSED [ 92%]
tests/unit/services/test_storage_location_service.py::test_create_storage_location_success PASSED [ 92%]
tests/unit/services/test_storage_location_service.py::test_create_storage_location_duplicate_code PASSED [ 92%]
tests/unit/services/test_storage_location_service.py::test_create_storage_location_point_outside_area PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_get_storage_location_by_id_success PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_get_storage_location_by_id_not_found PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_get_location_by_gps_success PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_get_location_by_gps_warehouse_not_found PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_get_location_by_gps_area_not_found PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_get_locations_by_area_success PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_update_storage_location_success PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_update_storage_location_not_found PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_delete_storage_location_success PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_delete_storage_location_not_found PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_validate_point_within_area_valid PASSED [ 93%]
tests/unit/services/test_storage_location_service.py::test_validate_point_within_area_out_of_bounds PASSED [ 93%]
tests/unit/services/test_warehouse_service.py::test_create_warehouse_success PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_create_warehouse_duplicate_code PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_create_warehouse_invalid_geometry_not_closed PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_create_warehouse_invalid_geometry_too_few_vertices PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_get_warehouse_by_id_success PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_get_warehouse_by_id_not_found PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_get_warehouse_by_gps_found PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_get_warehouse_by_gps_not_found PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_get_active_warehouses_without_areas PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_get_active_warehouses_with_areas PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_update_warehouse_success PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_update_warehouse_not_found PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_update_warehouse_with_geometry PASSED [ 94%]
tests/unit/services/test_warehouse_service.py::test_delete_warehouse_success PASSED [ 95%]
tests/unit/services/test_warehouse_service.py::test_delete_warehouse_not_found PASSED [ 95%]
tests/unit/services/test_warehouse_service.py::test_validate_geometry_valid_polygon PASSED [ 95%]
tests/unit/services/test_warehouse_service.py::test_validate_geometry_invalid_type PASSED [ 95%]
tests/unit/services/test_warehouse_service.py::test_validate_geometry_self_intersecting PASSED [ 95%]
tests/unit/services/test_warehouse_service.py::test_validate_geometry_not_closed PASSED [ 95%]
tests/unit/services/test_warehouse_service.py::test_validate_geometry_too_few_vertices PASSED [ 95%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_closed_state PASSED [ 95%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_open_state PASSED [ 95%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_half_open_allows_request PASSED [ 95%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_transitions_to_half_open_after_timeout PASSED [ 95%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_success_resets_failures PASSED [ 95%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_success_closes_half_open_circuit PASSED [ 95%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_increments_counter PASSED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_opens_after_threshold PASSED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLParentTask::test_ml_parent_task_success PASSED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLParentTask::test_ml_parent_task_empty_image_data FAILED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLParentTask::test_ml_parent_task_circuit_breaker_open FAILED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLParentTask::test_ml_parent_task_retries_on_failure FAILED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_success FAILED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_image_not_found FAILED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_retries_on_ml_failure FAILED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_exponential_backoff FAILED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLAggregationCallback::test_ml_aggregation_callback_all_success PASSED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLAggregationCallback::test_ml_aggregation_callback_partial_success PASSED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLAggregationCallback::test_ml_aggregation_callback_all_failed PASSED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestMLAggregationCallback::test_ml_aggregation_callback_aggregates_detections PASSED [ 96%]
tests/unit/tasks/test_ml_tasks.py::TestHelperFunctions::test_mark_session_processing FAILED [ 97%]
tests/unit/tasks/test_ml_tasks.py::TestHelperFunctions::test_mark_session_completed FAILED [ 97%]
tests/unit/tasks/test_ml_tasks.py::TestHelperFunctions::test_mark_session_failed FAILED [ 97%]
tests/unit/tasks/test_ml_tasks.py::TestTaskRouting::test_ml_parent_task_routes_to_cpu_queue PASSED [ 97%]
tests/unit/tasks/test_ml_tasks.py::TestTaskRouting::test_ml_child_task_routes_to_gpu_queue PASSED [ 97%]
tests/unit/tasks/test_ml_tasks.py::TestTaskRouting::test_ml_aggregation_callback_routes_to_cpu_queue PASSED [ 97%]
tests/unit/tasks/test_ml_tasks.py::TestTaskRouting::test_ml_child_task_has_max_retries PASSED [ 97%]
tests/unit/tasks/test_ml_tasks.py::TestTaskRouting::test_ml_parent_task_has_max_retries PASSED [ 97%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_celery_app_created PASSED [ 97%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_broker_configuration PASSED [ 97%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_result_backend_configuration PASSED [ 97%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_broker_and_backend_separated PASSED [ 97%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_json_serialization_enabled PASSED [ 97%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_pickle_not_accepted PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_timezone_configuration PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_task_tracking_enabled PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_connection_retry_on_startup PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_result_expiry_configured PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_broker_url_format PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSetup::test_result_backend_url_format PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppTaskConfiguration::test_task_autodiscovery_configured PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppTaskConfiguration::test_tasks_can_be_registered PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppQueueConfiguration::test_queues_configured PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppQueueConfiguration::test_default_queue_configured PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppQueueConfiguration::test_default_routing_key_configured PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSecuritySettings::test_no_pickle_serialization PASSED [ 98%]
tests/unit/test_celery_app.py::TestCeleryAppSecuritySettings::test_no_pickle_result_serialization PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppSecuritySettings::test_only_json_accepted PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppImport::test_celery_app_module_exists PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppImport::test_celery_app_exports_app PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppImport::test_celery_app_is_celery_instance PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppConfiguration::test_task_time_limits_configured PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppConfiguration::test_worker_prefetch_multiplier_configured PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppConfiguration::test_task_acks_late_configured PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppRedisConfiguration::test_redis_connection_pool_configured PASSED [ 99%]
tests/unit/test_celery_app.py::TestCeleryAppRedisConfiguration::test_broker_transport_options PASSED [ 99%]
tests/unit/test_sample.py::test_sample_assertion PASSED                  [ 99%]
tests/unit/test_sample.py::test_sample_data_fixture PASSED               [ 99%]
tests/unit/test_sample.py::test_multiple_fixtures PASSED                 [ 99%]
tests/unit/test_sample.py::test_slow_test PASSED                         [100%]
ERROR: Coverage failure: total of 73 is less than fail-under=80


==================================== ERRORS ====================================
_ ERROR at setup of TestProductCategoryDatabasePersistence.test_create_and_persist_category _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductCategoryDatabasePersistence.test_code_uniqueness_at_db_level _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductCategoryDatabasePersistence.test_query_by_code __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductCategoryDatabasePersistence.test_update_category _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductCategoryDatabasePersistence.test_delete_category _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductCategoryDatabasePersistence.test_order_by_name __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductCategoryDatabasePersistence.test_count_categories _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______ ERROR at setup of TestProductSizeSeedData.test_seed_data_loaded ________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductSizeSeedData.test_seed_data_height_ranges ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeDBConstraints.test_code_unique_constraint_db_level _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeDBConstraints.test_code_check_constraint_min_length _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of TestProductSizeQueries.test_order_by_sort_order _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________ ERROR at setup of TestProductSizeQueries.test_query_by_code __________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductSizeQueries.test_filter_with_height_range ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestProductSizeQueries.test_filter_without_height_range ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______ ERROR at setup of TestProductStateSeedData.test_seed_data_loaded _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateSeedData.test_seed_data_is_sellable_logic __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateDBConstraints.test_code_unique_constraint_db_level _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateDBConstraints.test_code_check_constraint_min_length _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestProductStateQueries.test_filter_by_is_sellable_true ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestProductStateQueries.test_filter_by_is_sellable_false __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of TestProductStateQueries.test_order_by_sort_order ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________ ERROR at setup of TestProductStateQueries.test_query_by_code _________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaGeneratedColumnArea.test_area_auto_calculated_on_insert _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaGeneratedColumnArea.test_area_updates_when_geometry_changes _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaGeneratedColumnArea.test_area_calculation_uses_geography_cast _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaCentroidTrigger.test_centroid_auto_set_on_insert _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaCentroidTrigger.test_centroid_within_polygon _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaCentroidTrigger.test_centroid_updates_on_geometry_change _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaSpatialContainment.test_area_within_warehouse_success _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaSpatialContainment.test_area_outside_warehouse_rejected _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaSpatialContainment.test_area_partially_outside_rejected _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaSpatialContainment.test_update_area_outside_boundary_rejected _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestStorageAreaHierarchy.test_hierarchical_area_query ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaCascadeDelete.test_cascade_delete_from_warehouse _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaCascadeDelete.test_cascade_delete_parent_area _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaSpatialQueries.test_find_area_by_gps_point __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaSpatialQueries.test_find_areas_within_radius _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaGISTIndexPerformance.test_gist_index_used_for_spatial_query _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageAreaCodeUniqueness.test_duplicate_code_rejected _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinCascadeDelete.test_cascade_delete_from_location _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinCascadeDelete.test_cascade_delete_from_area __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinCascadeDelete.test_cascade_delete_from_warehouse _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinJsonbQueries.test_filter_by_confidence_high __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestStorageBinJsonbQueries.test_filter_by_confidence_low __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestStorageBinJsonbQueries.test_filter_by_container_type __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinJsonbQueries.test_filter_by_ml_model_version _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinCodeUniqueness.test_code_uniqueness_enforced _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinCodeUniqueness.test_different_codes_allowed __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinForeignKeyIntegrity.test_invalid_storage_location_id _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinForeignKeyIntegrity.test_null_storage_location_id _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageBinForeignKeyIntegrity.test_null_storage_bin_type_id _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of TestSeedData.test_seed_data_loaded _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of TestSeedData.test_seed_data_integrity ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestRestrictDelete.test_delete_bin_type_with_storage_bins_fails _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestRestrictDelete.test_delete_bin_type_without_storage_bins_succeeds _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestRelationships.test_query_storage_bins_from_bin_type ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestRelationships.test_fk_integrity_storage_bins_to_bin_type _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestCodeUniqueness.test_create_two_types_with_same_code_fails _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestCodeUniqueness.test_create_types_with_different_codes_succeeds _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestCheckConstraintAtDBLevel.test_grid_type_with_null_rows_fails _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestCheckConstraintAtDBLevel.test_grid_type_with_null_columns_fails _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestCheckConstraintAtDBLevel.test_non_grid_type_with_null_rows_succeeds _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestCheckConstraintAtDBLevel.test_grid_type_with_rows_and_columns_succeeds _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationGeneratedColumnArea.test_area_always_zero_for_point _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationCentroidTrigger.test_centroid_equals_coordinates_on_insert _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationCentroidTrigger.test_centroid_updates_with_coordinates _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationSpatialContainment.test_location_within_area_success _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationSpatialContainment.test_location_outside_area_rejected _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationSpatialContainment.test_update_location_outside_area_rejected _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationQRCodeUniqueness.test_qr_code_uniqueness_enforced _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationCascadeDelete.test_cascade_delete_from_area _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationPhotoSessionFK.test_photo_session_id_nullable _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationSpatialQueries.test_find_location_by_gps_point _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationSpatialQueries.test_find_locations_in_area _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationGISTIndexPerformance.test_gist_index_used_for_spatial_query _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestStorageLocationCodeUniqueness.test_duplicate_code_rejected _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_insert_user_all_fields _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_insert_user_minimal_fields _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________________ ERROR at setup of test_query_by_email _____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________________ ERROR at setup of test_query_by_role _____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________________ ERROR at setup of test_query_active_users ___________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_unique_email_constraint_db _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________________ ERROR at setup of test_update_last_login ___________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________________ ERROR at setup of test_soft_delete_user ____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_seed_admin_user_exists _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_case_insensitive_email _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseGeneratedColumnArea.test_area_auto_calculated_on_insert _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseGeneratedColumnArea.test_area_updates_when_geometry_changes _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseGeneratedColumnArea.test_area_calculation_uses_geography_cast _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseCentroidTrigger.test_centroid_auto_set_on_insert _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseCentroidTrigger.test_centroid_within_polygon __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseCentroidTrigger.test_centroid_updates_on_geometry_change _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseSpatialQueries.test_find_warehouses_within_radius _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestWarehouseSpatialQueries.test_find_nearest_warehouse ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseSpatialQueries.test_point_in_polygon_localization _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseGISTIndexPerformance.test_gist_index_used_for_spatial_query _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestWarehouseGISTIndexPerformance.test_gist_index_used_for_containment_query _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestWarehouseCodeUniqueness.test_duplicate_code_rejected __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestMLTasksIntegration.test_ml_parent_task_updates_database _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestMLTasksIntegration.test_ml_child_task_with_real_session _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestMLTasksIntegration.test_ml_aggregation_callback_with_database _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_health_endpoint_returns_200 ______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________ ERROR at setup of test_health_endpoint_includes_correlation_id ________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of test_health_endpoint_with_custom_correlation_id _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_create_category_success ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_create_category_minimal_fields _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________ ERROR at setup of test_create_category_code_auto_uppercase __________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_create_category_duplicate_code _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_get_category_by_id_success _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_get_category_by_id_not_found ______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_get_all_categories_success _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_get_all_categories_empty_database ___________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_update_category_success ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_update_category_partial ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_update_category_not_found _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_delete_category_success ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_delete_category_not_found _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_category_code_validation ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_multiple_categories_independence ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyDatabaseOperations.test_create_family_with_category _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyDatabaseOperations.test_create_family_minimal_fields _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyDatabaseOperations.test_query_families_by_category _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyDatabaseOperations.test_query_family_with_category_join _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyDatabaseOperations.test_create_multiple_families_same_category _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyConstraints.test_cascade_delete_category_deletes_families _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyConstraints.test_foreign_key_constraint_invalid_category _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyConstraints.test_not_null_constraint_name _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductFamilyConstraints.test_not_null_constraint_category_id _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestProductFamilyUpdateDelete.test_update_family_name ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of TestProductFamilyUpdateDelete.test_delete_family ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_create_product_success _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_create_product_minimal_fields _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_create_product_sku_auto_increment ___________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of test_create_product_different_families_independent_skus ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_create_product_invalid_family _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_get_product_by_id_success _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_get_product_by_id_not_found ______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_get_product_by_sku_success _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________ ERROR at setup of test_get_product_by_sku_case_insensitive __________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_get_product_by_sku_not_found ______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_get_products_by_family_success _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_get_products_by_family_filtering ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________ ERROR at setup of test_get_products_by_family_invalid_family _________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_get_all_products_success ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_update_product_success _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_update_product_partial _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_update_product_sku_immutable ______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_update_product_not_found ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_delete_product_success _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_delete_product_not_found ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of test_sku_generation_handles_family_name_with_spaces _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of test_sku_generation_truncates_long_family_names _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_upload_original_full_workflow _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_upload_with_metadata_integration ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_upload_visualization_integration ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_download_uploaded_image_workflow ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_delete_image_integration ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________ ERROR at setup of test_delete_image_with_thumbnail_integration ________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______ ERROR at setup of test_generate_presigned_url_for_uploaded_image _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_concurrent_uploads_same_session ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_upload_different_content_types _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_upload_rollback_on_s3_failure _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________ ERROR at setup of test_delete_nonexistent_image_integration __________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________ ERROR at setup of test_upload_with_invalid_gps_coordinates __________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_upload_with_valid_gps_coordinates ___________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________ ERROR at setup of test_upload_file_exceeds_limit_integration _________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_upload_maximum_allowed_file_size ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_upload_sets_initial_status _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_query_images_by_status _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_warehouse_service_full_lifecycle ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_gps_lookup_point_inside_polygon ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_gps_lookup_point_outside_polygon ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_duplicate_code_rejection ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______________ ERROR at setup of test_invalid_geometry_rejected _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_get_warehouse_by_id_not_found _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_update_warehouse_not_found _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________ ERROR at setup of test_delete_warehouse_not_found _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________ ERROR at setup of test_get_active_warehouses_filters_inactive _________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_polygon_with_minimum_vertices _____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________ ERROR at setup of test_complex_polygon_with_many_vertices ___________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestDetectionBasicCRUD.test_create_detection_minimal_fields _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestDetectionBasicCRUD.test_create_detection_all_fields ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of TestDetectionBasicCRUD.test_read_detection_by_id ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestDetectionConfidenceValidation.test_confidence_min_value _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestDetectionConfidenceValidation.test_confidence_max_value _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestDetectionBooleanFlags.test_is_empty_container_true ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______ ERROR at setup of TestDetectionBooleanFlags.test_is_alive_false ________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestDetectionTimestamps.test_created_at_auto_populated ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestDetectionCascadeDelete.test_delete_session_cascades_to_detections _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationBasicCRUD.test_create_estimation_minimal_fields _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationBasicCRUD.test_create_estimation_all_fields __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____ ERROR at setup of TestEstimationBasicCRUD.test_read_estimation_by_id _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationCalculationMethodEnum.test_calculation_method_band_estimation _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationCalculationMethodEnum.test_calculation_method_density_estimation _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationCalculationMethodEnum.test_calculation_method_grid_analysis _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationConfidenceValidation.test_confidence_default_value _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationConfidenceValidation.test_confidence_min_value _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationConfidenceValidation.test_confidence_max_value _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestEstimationTimestamps.test_created_at_auto_populated ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestEstimationCascadeDelete.test_delete_session_cascades_to_estimations _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionBasicCRUD.test_create_session_minimal_fields _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionBasicCRUD.test_create_session_all_fields _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionBasicCRUD.test_read_session_by_id _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionBasicCRUD.test_update_session_status _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionBasicCRUD.test_delete_session_cascade _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestPhotoProcessingSessionStatusEnum.test_status_pending __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionStatusEnum.test_status_processing _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionStatusEnum.test_status_completed _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestPhotoProcessingSessionStatusEnum.test_status_failed ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionConfidenceValidation.test_avg_confidence_min_value _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionConfidenceValidation.test_avg_confidence_max_value _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionConfidenceValidation.test_avg_confidence_out_of_range_high _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionConfidenceValidation.test_avg_confidence_nullable _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionJSONBFields.test_category_counts_empty_dict_default _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionJSONBFields.test_category_counts_with_data _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionJSONBFields.test_manual_adjustments_empty_dict_default _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionJSONBFields.test_manual_adjustments_with_data _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionAggregates.test_aggregates_default_zero _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionAggregates.test_aggregates_with_values _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionTimestamps.test_created_at_auto_populated _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestPhotoProcessingSessionTimestamps.test_updated_at_on_modification _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestProductSizeCodeValidation.test_code_valid_uppercase ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeCodeValidation.test_code_valid_three_chars __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestProductSizeCodeValidation.test_code_auto_uppercase ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeCodeValidation.test_code_empty_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeCodeValidation.test_code_with_hyphens_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeCodeValidation.test_code_with_spaces_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeCodeValidation.test_code_too_short_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeCodeValidation.test_code_too_long_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeCodeValidation.test_code_with_underscores_valid _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestProductSizeHeightRanges.test_height_ranges_nullable ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeHeightRanges.test_height_ranges_valid_values _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeHeightRanges.test_custom_size_no_height_ranges _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____ ERROR at setup of TestProductSizeHeightRanges.test_xxl_no_max_height _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductSizeSortOrder.test_sort_order_default_99 _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestProductSizeSortOrder.test_sort_order_custom_value ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductSizeSortOrder.test_sort_order_zero_valid _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____ ERROR at setup of TestProductSizeBasicCRUD.test_create_product_size ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____ ERROR at setup of TestProductSizeBasicCRUD.test_update_product_size ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____ ERROR at setup of TestProductSizeBasicCRUD.test_delete_product_size ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of TestProductSizeRepr.test_repr_format_with_range _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______ ERROR at setup of TestProductSizeRepr.test_repr_format_no_range ________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductSizeUniqueness.test_duplicate_code_raises_integrity_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________ ERROR at setup of TestProductSizeFields.test_name_required __________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of TestProductSizeFields.test_description_nullable _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductSizeFields.test_timestamps_auto_generated ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestProductStateCodeValidation.test_code_valid_uppercase __
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__ ERROR at setup of TestProductStateCodeValidation.test_code_auto_uppercase ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateCodeValidation.test_code_empty_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateCodeValidation.test_code_with_hyphens_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateCodeValidation.test_code_with_spaces_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateCodeValidation.test_code_too_short_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateCodeValidation.test_code_too_long_raises_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateCodeValidation.test_code_with_underscores_valid _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateSellableFlag.test_is_sellable_default_false _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateSellableFlag.test_is_sellable_explicit_true _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateSellableFlag.test_is_sellable_explicit_false _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductStateSortOrder.test_sort_order_default_99 ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestProductStateSortOrder.test_sort_order_custom_value ___
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductStateSortOrder.test_sort_order_zero_valid ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductStateBasicCRUD.test_create_product_state _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductStateBasicCRUD.test_update_product_state _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____ ERROR at setup of TestProductStateBasicCRUD.test_delete_product_state _____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of TestProductStateRepr.test_repr_format ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_ ERROR at setup of TestProductStateUniqueness.test_duplicate_code_raises_integrity_error _
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________ ERROR at setup of TestProductStateFields.test_name_required __________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______ ERROR at setup of TestProductStateFields.test_description_nullable ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___ ERROR at setup of TestProductStateFields.test_timestamps_auto_generated ____
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________________ ERROR at setup of test_create_record _____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________________ ERROR at setup of test_get_by_id_found ____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________________ ERROR at setup of test_get_by_id_not_found __________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________________ ERROR at setup of test_update_partial _____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________________ ERROR at setup of test_update_not_found ____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________________ ERROR at setup of test_delete_existing ____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________________ ERROR at setup of test_delete_not_found ____________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_get_multi_pagination_first_page ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_get_multi_pagination_second_page ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_get_multi_empty_result _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________________ ERROR at setup of test_get_multi_limit_zero __________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________ ERROR at setup of test_get_multi_with_single_filter ______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
____________ ERROR at setup of test_get_multi_with_multiple_filters ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________________ ERROR at setup of test_count_without_filters _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________________ ERROR at setup of test_count_with_filters ___________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________________ ERROR at setup of test_count_empty_table ___________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
______________________ ERROR at setup of test_exists_true ______________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_____________________ ERROR at setup of test_exists_false ______________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________________ ERROR at setup of test_flush_without_commit __________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
___________ ERROR at setup of test_multiple_operations_same_session ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
__________ ERROR at setup of test_create_with_missing_required_field ___________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
________________ ERROR at setup of test_update_multiple_fields _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_________________ ERROR at setup of test_get_multi_large_skip __________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:691: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/pytest_asyncio/plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest.py:110: in db_session
    await conn.run_sync(Base.metadata.create_all)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/engine.py:887: in run_sync
    return await greenlet_spawn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:5924: in create_all
    bind._run_ddl_visitor(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2459: in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:984: in visit_metadata
    self.traverse_single(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py:661: in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:1022: in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:321: in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py:187: in _execute_on_connection
    return connection._execute_ddl(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1530: in _execute_ddl
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "storage_bin_type_id" referenced in foreign key constraint does not exist
E   [SQL:
E   CREATE TABLE density_parameters (
E   	id SERIAL NOT NULL,
E   	storage_bin_type_id INTEGER NOT NULL,
E   	product_id INTEGER NOT NULL,
E   	packaging_catalog_id INTEGER NOT NULL,
E   	avg_area_per_plant_cm2 NUMERIC(10, 2) NOT NULL,
E   	plants_per_m2 NUMERIC(10, 2) NOT NULL,
E   	overlap_adjustment_factor NUMERIC(3, 2) NOT NULL,
E   	avg_diameter_cm NUMERIC(10, 2) NOT NULL,
E   	notes TEXT,
E   	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL,
E   	updated_at TIMESTAMP WITH TIME ZONE,
E   	PRIMARY KEY (id),
E   	CONSTRAINT ck_density_param_area_positive CHECK (avg_area_per_plant_cm2 > 0.0),
E   	CONSTRAINT ck_density_param_density_positive CHECK (plants_per_m2 > 0.0),
E   	CONSTRAINT ck_density_param_overlap_range CHECK (overlap_adjustment_factor >= 0.0 AND overlap_adjustment_factor <= 1.0),
E   	CONSTRAINT ck_density_param_diameter_positive CHECK (avg_diameter_cm > 0.0),
E   	FOREIGN KEY(storage_bin_type_id) REFERENCES storage_bin_types (storage_bin_type_id) ON DELETE CASCADE,
E   	FOREIGN KEY(product_id) REFERENCES products (id) ON DELETE CASCADE,
E   	FOREIGN KEY(packaging_catalog_id) REFERENCES packaging_catalog (id) ON DELETE CASCADE
E   )
E
E   ]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
=================================== FAILURES ===================================
____ TestBandEstimationAccuracy.test_estimation_accuracy_within_10_percent _____
tests/integration/ml_processing/test_band_estimation_integration.py:187: in test_estimation_accuracy_within_10_percent
    assert (
E   AssertionError: Error rate 397.9% exceeds 10%. Estimated: 2863, Ground truth: 575
E   assert 3.9791304347826086 < 0.1
----------------------------- Captured stdout call -----------------------------
BandEstimationService initialized: 4 bands, alpha=0.9
Starting band estimation for test_segment_gaps.jpg: 557 detections, mask shape (1200, 1600)
Band 1: estimated 643 plants (avg_area=576px, processed=333193px)
Band 2: estimated 811 plants (avg_area=576px, processed=420250px)
Band 3: estimated 419 plants (avg_area=900px, processed=339319px)
Band 4: estimated 433 plants (avg_area=900px, processed=350006px)
Band estimation complete: 2306 plants estimated across 4 bands in 0.14s
------------------------------ Captured log call -------------------------------
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:182 BandEstimationService initialized: 4 bands, alpha=0.9
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:257 Starting band estimation for test_segment_gaps.jpg: 557 detections, mask shape (1200, 1600)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 1: estimated 643 plants (avg_area=576px, processed=333193px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 2: estimated 811 plants (avg_area=576px, processed=420250px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 3: estimated 419 plants (avg_area=900px, processed=339319px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 4: estimated 433 plants (avg_area=900px, processed=350006px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:381 Band estimation complete: 2306 plants estimated across 4 bands in 0.14s
_ TestBandEstimationAccuracy.test_estimation_compensates_for_missed_detections _
tests/integration/ml_processing/test_band_estimation_integration.py:235: in test_estimation_compensates_for_missed_detections
    assert lower_bound <= estimated_undetected <= upper_bound, (
E   AssertionError: Estimated undetected (2303) outside expected range [13, 23]
E   assert 2303 <= 23.400000000000002
----------------------------- Captured stdout call -----------------------------
BandEstimationService initialized: 4 bands, alpha=0.9
Starting band estimation for test_segment_gaps.jpg: 557 detections, mask shape (1200, 1600)
Band 1: estimated 646 plants (avg_area=576px, processed=334376px)
Band 2: estimated 805 plants (avg_area=576px, processed=416972px)
Band 3: estimated 421 plants (avg_area=900px, processed=340304px)
Band 4: estimated 431 plants (avg_area=900px, processed=348541px)
Band estimation complete: 2303 plants estimated across 4 bands in 0.08s
------------------------------ Captured log call -------------------------------
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:182 BandEstimationService initialized: 4 bands, alpha=0.9
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:257 Starting band estimation for test_segment_gaps.jpg: 557 detections, mask shape (1200, 1600)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 1: estimated 646 plants (avg_area=576px, processed=334376px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 2: estimated 805 plants (avg_area=576px, processed=416972px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 3: estimated 421 plants (avg_area=900px, processed=340304px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:356 Band 4: estimated 431 plants (avg_area=900px, processed=348541px)
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:381 Band estimation complete: 2303 plants estimated across 4 bands in 0.08s
_________ TestBandEstimationEndToEnd.test_estimations_match_db_schema __________
tests/integration/ml_processing/test_band_estimation_integration.py:552: in test_estimations_match_db_schema
    estimations = await service.estimate_undetected_plants(
E   TypeError: BandEstimationService.estimate_undetected_plants() got an unexpected keyword argument 'container_index'
----------------------------- Captured stdout call -----------------------------
BandEstimationService initialized: 4 bands, alpha=0.9
------------------------------ Captured log call -------------------------------
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:182 BandEstimationService initialized: 4 bands, alpha=0.9
_ TestModelCacheIntegrationCeleryTasks.test_task_uses_cached_model_across_invocations _
tests/integration/ml_processing/test_model_singleton_integration.py:325: in test_task_uses_cached_model_across_invocations
    task.request = Mock(hostname="gpu0@worker")
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_ TestModelCacheIntegrationCeleryTasks.test_different_workers_use_different_models _
tests/integration/ml_processing/test_model_singleton_integration.py:357: in test_different_workers_use_different_models
    task_gpu0.request = Mock(hostname="gpu0@worker")
    ^^^^^^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_____ TestMLPipelineIntegration.test_complete_pipeline_with_real_services ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
    prepared_stmt = await self._connection.prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:635: in prepare
    return await self._prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:653: in _prepare
    stmt = await self._get_statement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:432: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:165: in prepare
    ???
E   asyncpg.exceptions.UndefinedTableError: relation "photo_processing_sessions" does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedTableError'>: relation "photo_processing_sessions" does not exist

The above exception was the direct cause of the following exception:
tests/integration/ml_processing/test_pipeline_integration.py:203: in test_complete_pipeline_with_real_services
    await test_db_session.commit()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
    await greenlet_spawn(self.sync_session.commit)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2032: in commit
    trans.commit(_to_root=True)
<string>:2: in commit
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1313: in commit
    self._prepare_impl()
<string>:2: in _prepare_impl
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
    self.session.flush()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4345: in flush
    self._flush(objects)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4480: in _flush
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4441: in _flush
    flush_context.execute()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
    _emit_insert_statements(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
    result = connection.execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "photo_processing_sessions" does not exist
E   [SQL: INSERT INTO photo_processing_sessions (session_id, storage_location_id, original_image_id, processed_image_id, total_detected, total_estimated, total_empty_containers, avg_confidence, category_counts, status, error_message, validated, validated_by_user_id, validation_date, manual_adjustments, updated_at) VALUES ($1::UUID, $2::INTEGER, $3::UUID, $4::UUID, $5::INTEGER, $6::INTEGER, $7::INTEGER, $8::NUMERIC(5, 4), $9::JSONB, $10::processing_session_status_enum, $11::VARCHAR, $12::BOOLEAN, $13::INTEGER, $14::TIMESTAMP WITH TIME ZONE, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE) RETURNING photo_processing_sessions.id, photo_processing_sessions.created_at]
E   [parameters: (UUID('24d9b9cf-87d3-419a-8b99-1bfbdd4b87b2'), None, UUID('312df093-f208-42fe-bb50-c1fec3052cb3'), None, 0, 0, 0, None, '{}', 'pending', None, False, None, None, '{}', None)]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
---------------------------- Captured stdout setup -----------------------------
BandEstimationService initialized: 4 bands, alpha=0.9
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:182 BandEstimationService initialized: 4 bands, alpha=0.9
_________ TestMLPipelineIntegration.test_complete_pipeline_empty_image _________
tests/integration/ml_processing/test_pipeline_integration.py:318: in test_complete_pipeline_empty_image
    await test_db_session.commit()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
    await greenlet_spawn(self.sync_session.commit)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2032: in commit
    trans.commit(_to_root=True)
<string>:2: in commit
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1313: in commit
    self._prepare_impl()
<string>:2: in _prepare_impl
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
    self.session.flush()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4345: in flush
    self._flush(objects)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4480: in _flush
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4441: in _flush
    flush_context.execute()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:68: in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:223: in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:1759: in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
<string>:2: in connection
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1039: in connection
    return self._connection_for_bind(bind, execution_options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
<string>:2: in _connection_for_bind
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1175: in _connection_for_bind
    conn = self._parent._connection_for_bind(
<string>:2: in _connection_for_bind
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1189: in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:3277: in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:143: in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:3301: in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py:447: in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
    result = pool._dialect._do_ping_w_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:728: in _do_ping_w_event
    return self.do_ping(dbapi_connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1169: in do_ping
    dbapi_connection.ping()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
    raise error
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
    _ = self.await_(self._async_ping())
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
    await tr.start()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/transaction.py:146: in start
    await self._connection.execute(query)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:349: in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:375: in query
    ???
E   RuntimeError: Task <Task pending name='Task-124' coro=<TestMLPipelineIntegration.test_complete_pipeline_empty_image() running at /home/lucasg/proyectos/DemeterDocs/tests/integration/ml_processing/test_pipeline_integration.py:318> cb=[_run_until_complete_cb() at /home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
----------------------------- Captured stdout call -----------------------------
Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7926707fce60>>
Traceback (most recent call last):
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 372, in _close_connection
    self._dialect.do_terminate(connection)
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1136, in do_terminate
    dbapi_connection.terminate()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
    self.await_(asyncio.shield(self._connection.close(timeout=2)))
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1504, in close
    await self._protocol.close(timeout)
  File "asyncpg/protocol/protocol.pyx", line 627, in close
  File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
    self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 455, in create_task
    self._check_closed()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
------------------------------ Captured log call -------------------------------
ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:376 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7926707fce60>>
Traceback (most recent call last):
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 372, in _close_connection
    self._dialect.do_terminate(connection)
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1136, in do_terminate
    dbapi_connection.terminate()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
    self.await_(asyncio.shield(self._connection.close(timeout=2)))
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1504, in close
    await self._protocol.close(timeout)
  File "asyncpg/protocol/protocol.pyx", line 627, in close
  File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
    self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 455, in create_task
    self._check_closed()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
______ TestMLPipelinePerformance.test_pipeline_performance_cpu_benchmark _______
app/services/ml_processing/segmentation_service.py:217: in segment_image
    segments = self._parse_results(results[0])  # First image
                                   ^^^^^^^^^^
E   TypeError: 'Mock' object is not subscriptable

The above exception was the direct cause of the following exception:
app/services/ml_processing/pipeline_coordinator.py:218: in process_complete_pipeline
    segments = await self.segmentation_service.segment_image(
app/services/ml_processing/segmentation_service.py:229: in segment_image
    raise RuntimeError(f"Segmentation failed: {e}") from e
E   RuntimeError: Segmentation failed: 'Mock' object is not subscriptable

The above exception was the direct cause of the following exception:
tests/integration/ml_processing/test_pipeline_integration.py:400: in test_pipeline_performance_cpu_benchmark
    result = await coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:252: in process_complete_pipeline
    raise RuntimeError(f"Segmentation stage failed: {e}") from e
E   RuntimeError: Segmentation stage failed: Segmentation failed: 'Mock' object is not subscriptable
---------------------------- Captured stdout setup -----------------------------
BandEstimationService initialized: 4 bands, alpha=0.9
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:182 BandEstimationService initialized: 4 bands, alpha=0.9
----------------------------- Captured stdout call -----------------------------
MLPipelineCoordinator initialized with all ML services
Starting ML pipeline for session 1f9ff374-a883-4c60-8c9a-a93b9add37af: test_greenhouse.jpg (worker 0)
[Session 1f9ff374-a883-4c60-8c9a-a93b9add37af] Stage 1/3: Segmentation starting...
Loading segmentation model for worker 0 (lazy initialization)
Segmentation model loaded successfully
Segmentation failed for test_greenhouse.jpg: 'Mock' object is not subscriptable
Traceback (most recent call last):
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/segmentation_service.py", line 217, in segment_image
    segments = self._parse_results(results[0])  # First image
                                   ~~~~~~~^^^
TypeError: 'Mock' object is not subscriptable
[Session 1f9ff374-a883-4c60-8c9a-a93b9add37af] Stage 1/3: Segmentation FAILED: Segmentation failed: 'Mock' object is not subscriptable
Traceback (most recent call last):
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/segmentation_service.py", line 217, in segment_image
    segments = self._parse_results(results[0])  # First image
                                   ~~~~~~~^^^
TypeError: 'Mock' object is not subscriptable

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/pipeline_coordinator.py", line 218, in process_complete_pipeline
    segments = await self.segmentation_service.segment_image(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/segmentation_service.py", line 229, in segment_image
    raise RuntimeError(f"Segmentation failed: {e}") from e
RuntimeError: Segmentation failed: 'Mock' object is not subscriptable
------------------------------ Captured log call -------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:206 Starting ML pipeline for session 1f9ff374-a883-4c60-8c9a-a93b9add37af: test_greenhouse.jpg (worker 0)
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:214 [Session 1f9ff374-a883-4c60-8c9a-a93b9add37af] Stage 1/3: Segmentation starting...
INFO     app.services.ml_processing.segmentation_service:segmentation_service.py:193 Loading segmentation model for worker 0 (lazy initialization)
INFO     app.services.ml_processing.segmentation_service:segmentation_service.py:198 Segmentation model loaded successfully
ERROR    app.services.ml_processing.segmentation_service:segmentation_service.py:228 Segmentation failed for test_greenhouse.jpg: 'Mock' object is not subscriptable
Traceback (most recent call last):
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/segmentation_service.py", line 217, in segment_image
    segments = self._parse_results(results[0])  # First image
                                   ~~~~~~~^^^
TypeError: 'Mock' object is not subscriptable
ERROR    app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:248 [Session 1f9ff374-a883-4c60-8c9a-a93b9add37af] Stage 1/3: Segmentation FAILED: Segmentation failed: 'Mock' object is not subscriptable
Traceback (most recent call last):
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/segmentation_service.py", line 217, in segment_image
    segments = self._parse_results(results[0])  # First image
                                   ~~~~~~~^^^
TypeError: 'Mock' object is not subscriptable

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/pipeline_coordinator.py", line 218, in process_complete_pipeline
    segments = await self.segmentation_service.segment_image(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/proyectos/DemeterDocs/app/services/ml_processing/segmentation_service.py", line 229, in segment_image
    raise RuntimeError(f"Segmentation failed: {e}") from e
RuntimeError: Segmentation failed: 'Mock' object is not subscriptable
______ TestMLPipelineErrorRecovery.test_pipeline_handles_corrupted_image _______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
    prepared_stmt = await self._connection.prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:635: in prepare
    return await self._prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:653: in _prepare
    stmt = await self._get_statement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:432: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:165: in prepare
    ???
E   asyncpg.exceptions.UndefinedTableError: relation "photo_processing_sessions" does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedTableError'>: relation "photo_processing_sessions" does not exist

The above exception was the direct cause of the following exception:
tests/integration/ml_processing/test_pipeline_integration.py:465: in test_pipeline_handles_corrupted_image
    await test_db_session.commit()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
    await greenlet_spawn(self.sync_session.commit)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2032: in commit
    trans.commit(_to_root=True)
<string>:2: in commit
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1313: in commit
    self._prepare_impl()
<string>:2: in _prepare_impl
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
    self.session.flush()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4345: in flush
    self._flush(objects)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4480: in _flush
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4441: in _flush
    flush_context.execute()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
    _emit_insert_statements(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
    result = connection.execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "photo_processing_sessions" does not exist
E   [SQL: INSERT INTO photo_processing_sessions (session_id, storage_location_id, original_image_id, processed_image_id, total_detected, total_estimated, total_empty_containers, avg_confidence, category_counts, status, error_message, validated, validated_by_user_id, validation_date, manual_adjustments, updated_at) VALUES ($1::UUID, $2::INTEGER, $3::UUID, $4::UUID, $5::INTEGER, $6::INTEGER, $7::INTEGER, $8::NUMERIC(5, 4), $9::JSONB, $10::processing_session_status_enum, $11::VARCHAR, $12::BOOLEAN, $13::INTEGER, $14::TIMESTAMP WITH TIME ZONE, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE) RETURNING photo_processing_sessions.id, photo_processing_sessions.created_at]
E   [parameters: (UUID('350954d0-f37e-49ad-9ef1-ea661a963925'), None, UUID('f4b0fc76-2cf1-4bc7-943d-cccfa542ddb3'), None, 0, 0, 0, None, '{}', 'pending', None, False, None, None, '{}', None)]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
_______ TestMLPipelineErrorRecovery.test_pipeline_handles_missing_image ________
tests/integration/ml_processing/test_pipeline_integration.py:514: in test_pipeline_handles_missing_image
    await test_db_session.commit()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
    await greenlet_spawn(self.sync_session.commit)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2032: in commit
    trans.commit(_to_root=True)
<string>:2: in commit
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1313: in commit
    self._prepare_impl()
<string>:2: in _prepare_impl
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
    self.session.flush()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4345: in flush
    self._flush(objects)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4480: in _flush
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4441: in _flush
    flush_context.execute()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:68: in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:223: in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:1759: in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
<string>:2: in connection
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1039: in connection
    return self._connection_for_bind(bind, execution_options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
<string>:2: in _connection_for_bind
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1175: in _connection_for_bind
    conn = self._parent._connection_for_bind(
<string>:2: in _connection_for_bind
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1189: in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:3277: in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:143: in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:3301: in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py:447: in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
    result = pool._dialect._do_ping_w_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:728: in _do_ping_w_event
    return self.do_ping(dbapi_connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1169: in do_ping
    dbapi_connection.ping()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
    raise error
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
    _ = self.await_(self._async_ping())
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
    await tr.start()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/transaction.py:146: in start
    await self._connection.execute(query)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:349: in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:375: in query
    ???
E   RuntimeError: Task <Task pending name='Task-145' coro=<TestMLPipelineErrorRecovery.test_pipeline_handles_missing_image() running at /home/lucasg/proyectos/DemeterDocs/tests/integration/ml_processing/test_pipeline_integration.py:514> cb=[_run_until_complete_cb() at /home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
----------------------------- Captured stdout call -----------------------------
Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x79267082b7a0>>
Traceback (most recent call last):
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 372, in _close_connection
    self._dialect.do_terminate(connection)
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1136, in do_terminate
    dbapi_connection.terminate()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
    self.await_(asyncio.shield(self._connection.close(timeout=2)))
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1504, in close
    await self._protocol.close(timeout)
  File "asyncpg/protocol/protocol.pyx", line 627, in close
  File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
    self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 455, in create_task
    self._check_closed()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
------------------------------ Captured log call -------------------------------
ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:376 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x79267082b7a0>>
Traceback (most recent call last):
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 372, in _close_connection
    self._dialect.do_terminate(connection)
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1136, in do_terminate
    dbapi_connection.terminate()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
    self.await_(asyncio.shield(self._connection.close(timeout=2)))
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1504, in close
    await self._protocol.close(timeout)
  File "asyncpg/protocol/protocol.pyx", line 627, in close
  File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
    self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 455, in create_task
    self._check_closed()
  File "/home/lucasg/anaconda3/envs/demeterai_docs/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
_____ TestMLPipelineResultValidation.test_pipeline_results_match_database ______
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
    prepared_stmt = await self._connection.prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:635: in prepare
    return await self._prepare(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:653: in _prepare
    stmt = await self._get_statement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/asyncpg/connection.py:432: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:165: in prepare
    ???
E   asyncpg.exceptions.UndefinedTableError: relation "photo_processing_sessions" does not exist

The above exception was the direct cause of the following exception:
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedTableError'>: relation "photo_processing_sessions" does not exist

The above exception was the direct cause of the following exception:
tests/integration/ml_processing/test_pipeline_integration.py:575: in test_pipeline_results_match_database
    await test_db_session.commit()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
    await greenlet_spawn(self.sync_session.commit)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2032: in commit
    trans.commit(_to_root=True)
<string>:2: in commit
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1313: in commit
    self._prepare_impl()
<string>:2: in _prepare_impl
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
    self.session.flush()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4345: in flush
    self._flush(objects)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4480: in _flush
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4441: in _flush
    flush_context.execute()
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
    _emit_insert_statements(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
    result = connection.execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
    self._adapt_connection.await_(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
    self._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
    self._adapt_connection._handle_exception(error)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "photo_processing_sessions" does not exist
E   [SQL: INSERT INTO photo_processing_sessions (session_id, storage_location_id, original_image_id, processed_image_id, total_detected, total_estimated, total_empty_containers, avg_confidence, category_counts, status, error_message, validated, validated_by_user_id, validation_date, manual_adjustments, updated_at) VALUES ($1::UUID, $2::INTEGER, $3::UUID, $4::UUID, $5::INTEGER, $6::INTEGER, $7::INTEGER, $8::NUMERIC(5, 4), $9::JSONB, $10::processing_session_status_enum, $11::VARCHAR, $12::BOOLEAN, $13::INTEGER, $14::TIMESTAMP WITH TIME ZONE, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE) RETURNING photo_processing_sessions.id, photo_processing_sessions.created_at]
E   [parameters: (UUID('fd5708a4-b34e-4431-a1ff-e49d175bb836'), None, UUID('85f13d87-2c17-4a61-883a-71ec41cc6c5d'), None, 0, 0, 0, None, '{}', 'pending', None, False, None, None, '{}', None)]
E   (Background on this error at: https://sqlalche.me/e/20/f405)
---------------------------- Captured stdout setup -----------------------------
BandEstimationService initialized: 4 bands, alpha=0.9
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.band_estimation_service:band_estimation_service.py:182 BandEstimationService initialized: 4 bands, alpha=0.9
_ TestModelSingletonTaskModelProperties.test_seg_model_property_returns_cached_instance _
tests/unit/celery/test_base_tasks.py:40: in test_seg_model_property_returns_cached_instance
    with patch.object(task, "request", Mock(hostname="gpu0@worker")):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <@task: None of None> does not have the attribute 'request'
_ TestModelSingletonTaskModelProperties.test_det_model_property_returns_cached_instance _
tests/unit/celery/test_base_tasks.py:61: in test_det_model_property_returns_cached_instance
    task.request = Mock(hostname="gpu0@worker")
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_ TestModelSingletonTaskModelProperties.test_seg_and_det_models_are_different __
tests/unit/celery/test_base_tasks.py:82: in test_seg_and_det_models_are_different
    task.request = Mock(hostname="gpu0@worker")
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
___ TestModelSingletonTaskModelProperties.test_models_use_correct_worker_id ____
tests/unit/celery/test_base_tasks.py:105: in test_models_use_correct_worker_id
    task.request = Mock(hostname="gpu2@worker")
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
__ TestModelSingletonTaskWorkerID.test_worker_id_extracted_from_gpu_hostname ___
tests/unit/celery/test_base_tasks.py:131: in test_worker_id_extracted_from_gpu_hostname
    task.request = Mock(hostname="gpu0@worker")
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_ TestModelSingletonTaskWorkerID.test_worker_id_defaults_to_zero_for_invalid_format _
tests/unit/celery/test_base_tasks.py:152: in test_worker_id_defaults_to_zero_for_invalid_format
    task.request = Mock(hostname="worker@hostname")
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_______ TestModelSingletonTaskWorkerID.test_worker_id_handles_no_request _______
tests/unit/celery/test_base_tasks.py:171: in test_worker_id_handles_no_request
    task.request = None
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
____ TestModelSingletonTaskWorkerID.test_worker_id_handles_missing_hostname ____
tests/unit/celery/test_base_tasks.py:184: in test_worker_id_handles_missing_hostname
    task.request = Mock(hostname=None)
    ^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_ TestModelSingletonTaskIntegrationWithCache.test_multiple_tasks_share_same_model_instance _
tests/unit/celery/test_base_tasks.py:334: in test_multiple_tasks_share_same_model_instance
    task1.request = Mock(hostname="gpu0@worker")
    ^^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_ TestModelSingletonTaskIntegrationWithCache.test_tasks_on_different_workers_use_different_models _
tests/unit/celery/test_base_tasks.py:359: in test_tasks_on_different_workers_use_different_models
    task_gpu0.request = Mock(hostname="gpu0@worker")
    ^^^^^^^^^^^^^^^^^
E   AttributeError: property 'request' of 'ModelSingletonTask' object has no setter
_ TestClassificationRelationships.test_packaging_catalog_relationship_commented_out _
tests/unit/models/test_classification.py:610: in test_packaging_catalog_relationship_commented_out
    assert "packaging_catalog" not in Classification.__mapper__.relationships
E   AssertionError: assert 'packaging_catalog' not in <sqlalchemy.util._collections.ReadOnlyProperties object at 0x79266a489a80>
E    +  where <sqlalchemy.util._collections.ReadOnlyProperties object at 0x79266a489a80> = <Mapper at 0x79298aeb0b30; Classification>.relationships
E    +    where <Mapper at 0x79298aeb0b30; Classification> = Classification.__mapper__
__ TestClassificationRelationships.test_detections_relationship_commented_out __
tests/unit/models/test_classification.py:615: in test_detections_relationship_commented_out
    assert "detections" not in Classification.__mapper__.relationships
E   AssertionError: assert 'detections' not in <sqlalchemy.util._collections.ReadOnlyProperties object at 0x79266a489a80>
E    +  where <sqlalchemy.util._collections.ReadOnlyProperties object at 0x79266a489a80> = <Mapper at 0x79298aeb0b30; Classification>.relationships
E    +    where <Mapper at 0x79298aeb0b30; Classification> = Classification.__mapper__
_ TestClassificationRelationships.test_estimations_relationship_commented_out __
tests/unit/models/test_classification.py:620: in test_estimations_relationship_commented_out
    assert "estimations" not in Classification.__mapper__.relationships
E   AssertionError: assert 'estimations' not in <sqlalchemy.util._collections.ReadOnlyProperties object at 0x79266a489a80>
E    +  where <sqlalchemy.util._collections.ReadOnlyProperties object at 0x79266a489a80> = <Mapper at 0x79298aeb0b30; Classification>.relationships
E    +    where <Mapper at 0x79298aeb0b30; Classification> = Classification.__mapper__
____ TestProductRelationships.test_stock_batches_relationship_commented_out ____
tests/unit/models/test_product.py:495: in test_stock_batches_relationship_commented_out
    assert "stock_batches" not in Product.__mapper__.relationships
E   AssertionError: assert 'stock_batches' not in <sqlalchemy.util._collections.ReadOnlyProperties object at 0x7926702d5bd0>
E    +  where <sqlalchemy.util._collections.ReadOnlyProperties object at 0x7926702d5bd0> = <Mapper at 0x79298ad93b90; Product>.relationships
E    +    where <Mapper at 0x79298ad93b90; Product> = Product.__mapper__
___ TestProductFamilyRelationships.test_products_relationship_commented_out ____
tests/unit/models/test_product_family.py:248: in test_products_relationship_commented_out
    assert "products" not in ProductFamily.__mapper__.relationships
E   AssertionError: assert 'products' not in <sqlalchemy.util._collections.ReadOnlyProperties object at 0x792670281b70>
E    +  where <sqlalchemy.util._collections.ReadOnlyProperties object at 0x792670281b70> = <Mapper at 0x79298adad5e0; ProductFamily>.relationships
E    +    where <Mapper at 0x79298adad5e0; ProductFamily> = ProductFamily.__mapper__
_____ TestStorageAreaCodeValidation.test_storage_area_code_requires_hyphen _____
tests/unit/models/test_storage_area.py:64: in test_storage_area_code_requires_hyphen
    StorageArea(
<string>:4: in __init__
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:571: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:569: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2182: in _declarative_constructor
    setattr(self, k, kwargs[k])
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_area.py:323: in validate_code
    raise ValueError(
E   ValueError: Storage area code must match pattern WAREHOUSE-AREA (e.g., 'INV01-NORTH', got: NORTH)

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_area.py:63: in test_storage_area_code_requires_hyphen
    with pytest.raises(ValueError, match="must contain hyphen"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'must contain hyphen'
E    Input: "Storage area code must match pattern WAREHOUSE-AREA (e.g., 'INV01-NORTH', got: NORTH)"
___ TestStorageAreaCodeValidation.test_storage_area_code_uppercase_enforced ____
tests/unit/models/test_storage_area.py:103: in test_storage_area_code_uppercase_enforced
    with pytest.raises(ValueError, match="must be uppercase"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
____ TestStorageAreaCodeValidation.test_storage_area_code_alphanumeric_only ____
tests/unit/models/test_storage_area.py:132: in test_storage_area_code_alphanumeric_only
    area.code = "WH@AREA-01"
    ^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_area.py:323: in validate_code
    raise ValueError(
E   ValueError: Storage area code must match pattern WAREHOUSE-AREA (e.g., 'INV01-NORTH', got: WH@AREA-01)

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_area.py:131: in test_storage_area_code_alphanumeric_only
    with pytest.raises(ValueError, match="alphanumeric"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'alphanumeric'
E    Input: "Storage area code must match pattern WAREHOUSE-AREA (e.g., 'INV01-NORTH', got: WH@AREA-01)"
____ TestStorageAreaCodeValidation.test_storage_area_code_length_validation ____
tests/unit/models/test_storage_area.py:166: in test_storage_area_code_length_validation
    area.code = "A"
    ^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_area.py:323: in validate_code
    raise ValueError(
E   ValueError: Storage area code must match pattern WAREHOUSE-AREA (e.g., 'INV01-NORTH', got: A)

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_area.py:165: in test_storage_area_code_length_validation
    with pytest.raises(ValueError, match="2-50 characters"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: '2-50 characters'
E    Input: "Storage area code must match pattern WAREHOUSE-AREA (e.g., 'INV01-NORTH', got: A)"
________ TestStorageAreaCodeValidation.test_storage_area_code_required _________
tests/unit/models/test_storage_area.py:175: in test_storage_area_code_required
    StorageArea(
<string>:4: in __init__
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:571: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:569: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2182: in _declarative_constructor
    setattr(self, k, kwargs[k])
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_area.py:317: in validate_code
    raise ValueError("Storage area code cannot be empty")
E   ValueError: Storage area code cannot be empty

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_area.py:174: in test_storage_area_code_required
    with pytest.raises(ValueError, match="required"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'required'
E    Input: 'Storage area code cannot be empty'
______ TestStorageAreaCodeValidation.test_storage_area_code_empty_string _______
tests/unit/models/test_storage_area.py:221: in test_storage_area_code_empty_string
    area.code = ""
    ^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_area.py:317: in validate_code
    raise ValueError("Storage area code cannot be empty")
E   ValueError: Storage area code cannot be empty

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_area.py:203: in test_storage_area_code_empty_string
    with pytest.raises(ValueError, match="required"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'required'
E    Input: 'Storage area code cannot be empty'
________ TestStorageAreaPositionEnum.test_position_enum_invalid_values _________
tests/unit/models/test_storage_area.py:257: in test_position_enum_invalid_values
    with pytest.raises((ValueError, StatementError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'sqlalchemy.exc.StatementError'>)
____________ TestStorageAreaForeignKeys.test_warehouse_id_required _____________
tests/unit/models/test_storage_area.py:306: in test_warehouse_id_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
____________ TestStorageAreaRequiredFields.test_name_field_required ____________
tests/unit/models/test_storage_area.py:428: in test_name_field_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
__________ TestStorageAreaRequiredFields.test_geometry_field_required __________
tests/unit/models/test_storage_area.py:433: in test_geometry_field_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
__________ TestStorageAreaDefaultValues.test_active_defaults_to_true ___________
tests/unit/models/test_storage_area.py:463: in test_active_defaults_to_true
    assert area.active is True
E   AssertionError: assert None is True
E    +  where None = <StorageArea(storage_area_id=None, code='WH-AREA', name='Test Storage Area', warehouse_id=1)>.active
______________ TestBasicCRUD.test_create_type_with_minimal_fields ______________
tests/unit/models/test_storage_bin_type.py:231: in test_create_type_with_minimal_fields
    assert bin_type.is_grid is False  # default value
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert None is False
E    +  where None = <StorageBinType(storage_bin_type_id=None, code='BOX_SMALL', name='Small Box', category='box', is_grid=None)>.is_grid
___________________ TestFieldConstraints.test_code_required ____________________
tests/unit/models/test_storage_bin_type.py:254: in test_code_required
    with pytest.raises((ValueError, IntegrityError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'sqlalchemy.exc.IntegrityError'>)
___________________ TestFieldConstraints.test_name_required ____________________
tests/unit/models/test_storage_bin_type.py:259: in test_name_required
    with pytest.raises((ValueError, IntegrityError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'sqlalchemy.exc.IntegrityError'>)
_________________ TestFieldConstraints.test_category_required __________________
tests/unit/models/test_storage_bin_type.py:264: in test_category_required
    with pytest.raises((ValueError, IntegrityError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'sqlalchemy.exc.IntegrityError'>)
_________________ TestDefaultValues.test_is_grid_default_false _________________
tests/unit/models/test_storage_bin_type.py:274: in test_is_grid_default_false
    assert bin_type.is_grid is False
E   AssertionError: assert None is False
E    +  where None = <StorageBinType(storage_bin_type_id=None, code='TEST_TYPE', name='Test Type', category='box', is_grid=None)>.is_grid
______ TestStorageLocationQRCodeValidation.test_qr_code_length_validation ______
tests/unit/models/test_storage_location.py:116: in test_qr_code_length_validation
    location.qr_code = "SHORT"  # 5 chars
    ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:410: in validate_qr_code
    raise ValueError(
E   ValueError: QR code must be 8-20 chars, uppercase alphanumeric with optional hyphen (-) or underscore (_) (got: SHORT)

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:115: in test_qr_code_length_validation
    with pytest.raises(ValueError, match="8-20 characters"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: '8-20 characters'
E    Input: 'QR code must be 8-20 chars, uppercase alphanumeric with optional hyphen (-) or underscore (_) (got: SHORT)'
__________ TestStorageLocationQRCodeValidation.test_qr_code_required ___________
tests/unit/models/test_storage_location.py:131: in test_qr_code_required
    StorageLocation(
<string>:4: in __init__
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:571: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:569: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2182: in _declarative_constructor
    setattr(self, k, kwargs[k])
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:404: in validate_qr_code
    raise ValueError("QR code cannot be empty")
E   ValueError: QR code cannot be empty

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:130: in test_qr_code_required
    with pytest.raises(ValueError, match="required"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'required'
E    Input: 'QR code cannot be empty'
____ TestStorageLocationQRCodeValidation.test_qr_code_empty_string_rejected ____
tests/unit/models/test_storage_location.py:149: in test_qr_code_empty_string_rejected
    location.qr_code = ""
    ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:404: in validate_qr_code
    raise ValueError("QR code cannot be empty")
E   ValueError: QR code cannot be empty

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:141: in test_qr_code_empty_string_rejected
    with pytest.raises(ValueError, match="required"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'required'
E    Input: 'QR code cannot be empty'
__ TestStorageLocationQRCodeValidation.test_qr_code_whitespace_only_rejected ___
tests/unit/models/test_storage_location.py:161: in test_qr_code_whitespace_only_rejected
    location.qr_code = "   "
    ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:404: in validate_qr_code
    raise ValueError("QR code cannot be empty")
E   ValueError: QR code cannot be empty

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:153: in test_qr_code_whitespace_only_rejected
    with pytest.raises(ValueError, match="required"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'required'
E    Input: 'QR code cannot be empty'
_ TestStorageLocationCodeValidation.test_storage_location_code_uppercase_enforced _
tests/unit/models/test_storage_location.py:219: in test_storage_location_code_uppercase_enforced
    with pytest.raises(ValueError, match="must be uppercase"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
_ TestStorageLocationCodeValidation.test_storage_location_code_alphanumeric_only _
tests/unit/models/test_storage_location.py:238: in test_storage_location_code_alphanumeric_only
    location.code = "WH@AREA-LOC01"
    ^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:361: in validate_code
    raise ValueError(
E   ValueError: Storage location code must match pattern WAREHOUSE-AREA-LOCATION (e.g., 'INV01-NORTH-LOC-001', got: WH@AREA-LOC01)

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:237: in test_storage_location_code_alphanumeric_only
    with pytest.raises(ValueError, match="alphanumeric"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'alphanumeric'
E    Input: "Storage location code must match pattern WAREHOUSE-AREA-LOCATION (e.g., 'INV01-NORTH-LOC-001', got: WH@AREA-LOC01)"
_ TestStorageLocationCodeValidation.test_storage_location_code_length_validation _
tests/unit/models/test_storage_location.py:262: in test_storage_location_code_length_validation
    location.code = "A"
    ^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:361: in validate_code
    raise ValueError(
E   ValueError: Storage location code must match pattern WAREHOUSE-AREA-LOCATION (e.g., 'INV01-NORTH-LOC-001', got: A)

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:261: in test_storage_location_code_length_validation
    with pytest.raises(ValueError, match="2-50 characters"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: '2-50 characters'
E    Input: "Storage location code must match pattern WAREHOUSE-AREA-LOCATION (e.g., 'INV01-NORTH-LOC-001', got: A)"
____ TestStorageLocationCodeValidation.test_storage_location_code_required _____
tests/unit/models/test_storage_location.py:271: in test_storage_location_code_required
    StorageLocation(
<string>:4: in __init__
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:571: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:569: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2182: in _declarative_constructor
    setattr(self, k, kwargs[k])
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:355: in validate_code
    raise ValueError("Storage location code cannot be empty")
E   ValueError: Storage location code cannot be empty

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:270: in test_storage_location_code_required
    with pytest.raises(ValueError, match="required"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'required'
E    Input: 'Storage location code cannot be empty'
__ TestStorageLocationCodeValidation.test_storage_location_code_empty_string ___
tests/unit/models/test_storage_location.py:289: in test_storage_location_code_empty_string
    location.code = ""
    ^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:355: in validate_code
    raise ValueError("Storage location code cannot be empty")
E   ValueError: Storage location code cannot be empty

During handling of the above exception, another exception occurred:
tests/unit/models/test_storage_location.py:281: in test_storage_location_code_empty_string
    with pytest.raises(ValueError, match="required"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'required'
E    Input: 'Storage location code cannot be empty'
_________ TestStorageLocationForeignKeys.test_storage_area_id_required _________
tests/unit/models/test_storage_location.py:408: in test_storage_area_id_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
__________ TestStorageLocationRequiredFields.test_name_field_required __________
tests/unit/models/test_storage_location.py:483: in test_name_field_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
________ TestStorageLocationRequiredFields.test_geometry_field_required ________
tests/unit/models/test_storage_location.py:494: in test_geometry_field_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
________ TestStorageLocationDefaultValues.test_active_defaults_to_true _________
tests/unit/models/test_storage_location.py:518: in test_active_defaults_to_true
    assert location.active is True
E   AssertionError: assert None is True
E    +  where None = <StorageLocation(location_id=None, code='WH-AREA-LOC01', qr_code='LOC12345', name='Test Location', storage_area_id=1)>.active
_____ TestStorageLocationFieldCombinations.test_inactive_storage_location ______
tests/unit/models/test_storage_location.py:571: in test_inactive_storage_location
    location = StorageLocation(
<string>:4: in __init__
    ???
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:571: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/state.py:569: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2182: in _declarative_constructor
    setattr(self, k, kwargs[k])
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:540: in __set__
    self.impl.set(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1287: in set
    value = self.fire_replace_event(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1302: in fire_replace_event
    value = fn(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/events.py:2577: in wrap
    return fn(target, *arg)
           ^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/orm/util.py:307: in set_
    return validator(state.obj(), key, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/models/storage_location.py:361: in validate_code
    raise ValueError(
E   ValueError: Storage location code must match pattern WAREHOUSE-AREA-LOCATION (e.g., 'INV01-NORTH-LOC-001', got: INACTIVE-LOC)
____________ TestUserRelationships.test_relationships_commented_out ____________
tests/unit/models/test_user.py:457: in test_relationships_commented_out
    assert "stock_movements" not in User.__mapper__.relationships
E   AssertionError: assert 'stock_movements' not in <sqlalchemy.util._collections.ReadOnlyProperties object at 0x792670589d20>
E    +  where <sqlalchemy.util._collections.ReadOnlyProperties object at 0x792670589d20> = <Mapper at 0x792982dda570; User>.relationships
E    +    where <Mapper at 0x792982dda570; User> = User.__mapper__
________ TestUserRelationships.test_relationship_attributes_not_present ________
tests/unit/models/test_user.py:465: in test_relationship_attributes_not_present
    assert not hasattr(User, "stock_movements")
E   AssertionError: assert not True
E    +  where True = hasattr(User, 'stock_movements')
________ TestWarehouseTypeEnum.test_warehouse_type_enum_invalid_values _________
tests/unit/models/test_warehouse.py:171: in test_warehouse_type_enum_invalid_values
    with pytest.raises((ValueError, StatementError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'sqlalchemy.exc.StatementError'>)
______________ TestWarehouseTypeEnum.test_warehouse_type_required ______________
tests/unit/models/test_warehouse.py:192: in test_warehouse_type_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
_____________ TestWarehouseRequiredFields.test_name_field_required _____________
tests/unit/models/test_warehouse.py:201: in test_name_field_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
___________ TestWarehouseRequiredFields.test_geometry_field_required ___________
tests/unit/models/test_warehouse.py:206: in test_geometry_field_required
    with pytest.raises((ValueError, TypeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'TypeError'>)
___________ TestWarehouseDefaultValues.test_active_defaults_to_true ____________
tests/unit/models/test_warehouse.py:239: in test_active_defaults_to_true
    assert warehouse.active is True
E   AssertionError: assert None is True
E    +  where None = <Warehouse(warehouse_id=None, code='TEST01', name='Test Warehouse')>.active
__ TestMLPipelineCoordinatorHappyPath.test_process_complete_pipeline_success ___
tests/unit/services/ml_processing/test_pipeline_coordinator.py:299: in test_process_complete_pipeline_success
    result = await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorHappyPath.test_process_complete_pipeline_progress_updates _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:373: in test_process_complete_pipeline_progress_updates
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorHappyPath.test_process_complete_pipeline_result_aggregation _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:403: in test_process_complete_pipeline_result_aggregation
    result = await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorHappyPath.test_process_complete_pipeline_no_segments _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:443: in test_process_complete_pipeline_no_segments
    result = await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/empty_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorErrorHandling.test_process_complete_pipeline_segmentation_fails _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:499: in test_process_complete_pipeline_segmentation_fails
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorErrorHandling.test_process_complete_pipeline_detection_fails_warning _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:544: in test_process_complete_pipeline_detection_fails_warning
    result = await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorErrorHandling.test_process_complete_pipeline_estimation_fails_warning _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:591: in test_process_complete_pipeline_estimation_fails_warning
    result = await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorErrorHandling.test_process_complete_pipeline_persistence_fails _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:631: in test_process_complete_pipeline_persistence_fails
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg

During handling of the above exception, another exception occurred:
tests/unit/services/ml_processing/test_pipeline_coordinator.py:630: in test_process_complete_pipeline_persistence_fails
    with pytest.raises(Exception, match="Database connection lost"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'Database connection lost'
E    Input: 'Image not found: /tmp/test_photo.jpg'
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorContainerTypeRouting.test_process_complete_pipeline_segments_use_sahi _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:669: in test_process_complete_pipeline_segments_use_sahi
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorContainerTypeRouting.test_process_complete_pipeline_boxes_use_direct _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:695: in test_process_complete_pipeline_boxes_use_direct
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorContainerTypeRouting.test_process_complete_pipeline_plugs_use_direct _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:720: in test_process_complete_pipeline_plugs_use_direct
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorEstimationLogic.test_process_complete_pipeline_estimation_only_for_segments _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:752: in test_process_complete_pipeline_estimation_only_for_segments
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorEstimationLogic.test_process_complete_pipeline_estimation_receives_detections _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:772: in test_process_complete_pipeline_estimation_receives_detections
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorPerformance.test_process_complete_pipeline_performance_benchmark _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:805: in test_process_complete_pipeline_performance_benchmark
    result = await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorEdgeCases.test_process_complete_pipeline_invalid_session_id _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:840: in test_process_complete_pipeline_invalid_session_id
    await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
_ TestMLPipelineCoordinatorEdgeCases.test_process_complete_pipeline_zero_confidence_detections _
tests/unit/services/ml_processing/test_pipeline_coordinator.py:882: in test_process_complete_pipeline_zero_confidence_detections
    result = await pipeline_coordinator.process_complete_pipeline(
app/services/ml_processing/pipeline_coordinator.py:204: in process_complete_pipeline
    raise FileNotFoundError(f"Image not found: {image_path}")
E   FileNotFoundError: Image not found: /tmp/test_photo.jpg
---------------------------- Captured stdout setup -----------------------------
MLPipelineCoordinator initialized with all ML services
------------------------------ Captured log setup ------------------------------
INFO     app.services.ml_processing.pipeline_coordinator:pipeline_coordinator.py:151 MLPipelineCoordinator initialized with all ML services
____________________ test_create_storage_bin_duplicate_code ____________________
tests/unit/services/test_storage_bin_service.py:138: in test_create_storage_bin_duplicate_code
    await bin_service.create_storage_bin(request)
app/services/storage_bin_service.py:27: in create_storage_bin
    raise DuplicateCodeException(code=request.code)
E   app.core.exceptions.DuplicateCodeException: Warehouse code 'GH-001-NORTH-LOC01-BIN01' already exists
----------------------------- Captured stdout call -----------------------------
{"technical_message": "Warehouse code 'GH-001-NORTH-LOC01-BIN01' already exists", "user_message": "A warehouse with code 'GH-001-NORTH-LOC01-BIN01' already exists. Please choose a different code.", "code": 409, "warehouse_code": "GH-001-NORTH-LOC01-BIN01", "event": "Client error: DuplicateCodeException", "level": "warning", "timestamp": "2025-10-21T14:25:00.889857Z"}
______________________ test_get_bins_by_location_success _______________________
tests/unit/services/test_storage_bin_service.py:192: in test_get_bins_by_location_success
    result = await bin_service.get_bins_by_location(1)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/storage_bin_service.py:42: in get_bins_by_location
    query = select(self.bin_repo.model).where(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/_selectable_constructors.py:537: in select
    return Select(*entities)
           ^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/selectable.py:5376: in __init__
    coercions.expect(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/coercions.py:332: in expect
    return lambdas.LambdaElement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/lambdas.py:213: in __init__
    rec = self._retrieve_tracker_rec(fn, apply_propagate_attrs, opts)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/lambdas.py:228: in _retrieve_tracker_rec
    closure = fn.__closure__
              ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:662: in __getattr__
    raise AttributeError(name)
E   AttributeError: __closure__
_______________________ test_get_bins_by_location_empty ________________________
tests/unit/services/test_storage_bin_service.py:210: in test_get_bins_by_location_empty
    result = await bin_service.get_bins_by_location(1)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/storage_bin_service.py:42: in get_bins_by_location
    query = select(self.bin_repo.model).where(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/_selectable_constructors.py:537: in select
    return Select(*entities)
           ^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/selectable.py:5376: in __init__
    coercions.expect(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/coercions.py:332: in expect
    return lambdas.LambdaElement(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/lambdas.py:213: in __init__
    rec = self._retrieve_tracker_rec(fn, apply_propagate_attrs, opts)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/sqlalchemy/sql/lambdas.py:228: in _retrieve_tracker_rec
    closure = fn.__closure__
              ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:662: in __getattr__
    raise AttributeError(name)
E   AttributeError: __closure__
____________ TestMLParentTask.test_ml_parent_task_empty_image_data _____________
tests/unit/tasks/test_ml_tasks.py:258: in test_ml_parent_task_empty_image_data
    ml_parent_task(mock_self, session_id=123, image_data=[])
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/local.py:182: in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/app/task.py:411: in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ml_parent_task() got multiple values for argument 'session_id'
__________ TestMLParentTask.test_ml_parent_task_circuit_breaker_open ___________
tests/unit/tasks/test_ml_tasks.py:273: in test_ml_parent_task_circuit_breaker_open
    ml_parent_task(mock_self, session_id=123, image_data=sample_image_data)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/local.py:182: in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/app/task.py:411: in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ml_parent_task() got multiple values for argument 'session_id'
----------------------------- Captured stdout call -----------------------------
{"technical_message": "Circuit breaker OPEN: Too many failures", "user_message": "Service temporarily unavailable due to repeated failures. Please try again later.", "code": 503, "reason": "Too many failures", "event": "Server error: CircuitBreakerException", "level": "error", "timestamp": "2025-10-21T14:25:01.296181Z"}
___________ TestMLParentTask.test_ml_parent_task_retries_on_failure ____________
tests/unit/tasks/test_ml_tasks.py:302: in test_ml_parent_task_retries_on_failure
    ml_parent_task(mock_self, session_id=123, image_data=sample_image_data)
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/local.py:182: in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/app/task.py:411: in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ml_parent_task() got multiple values for argument 'session_id'
__________________ TestMLChildTask.test_ml_child_task_success __________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1451: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'app.tasks.ml_tasks' has no attribute 'asyncio'
______________ TestMLChildTask.test_ml_child_task_image_not_found ______________
tests/unit/tasks/test_ml_tasks.py:387: in test_ml_child_task_image_not_found
    ml_child_task(
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/local.py:182: in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/site-packages/celery/app/task.py:411: in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ml_child_task() got multiple values for argument 'session_id'
___________ TestMLChildTask.test_ml_child_task_retries_on_ml_failure ___________
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1451: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'app.tasks.ml_tasks' has no attribute 'asyncio'
____________ TestMLChildTask.test_ml_child_task_exponential_backoff ____________
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1451: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'app.tasks.ml_tasks' has no attribute 'asyncio'
_______________ TestHelperFunctions.test_mark_session_processing _______________
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.tasks.ml_tasks' from '/home/lucasg/proyectos/DemeterDocs/app/tasks/ml_tasks.py'> does not have the attribute 'get_async_session'
_______________ TestHelperFunctions.test_mark_session_completed ________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.tasks.ml_tasks' from '/home/lucasg/proyectos/DemeterDocs/app/tasks/ml_tasks.py'> does not have the attribute 'get_async_session'
_________________ TestHelperFunctions.test_mark_session_failed _________________
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
../../anaconda3/envs/demeterai_docs/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.tasks.ml_tasks' from '/home/lucasg/proyectos/DemeterDocs/app/tasks/ml_tasks.py'> does not have the attribute 'get_async_session'
=============================== warnings summary ===============================
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_open_state
  /home/lucasg/proyectos/DemeterDocs/tests/unit/tasks/test_ml_tasks.py:139: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ml_tasks.circuit_breaker_state["last_failure_time"] = datetime.utcnow()

tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_open_state
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_transitions_to_half_open_after_timeout
  /home/lucasg/proyectos/DemeterDocs/app/tasks/ml_tasks.py:123: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    elapsed = (datetime.utcnow() - circuit_breaker_state["last_failure_time"]).total_seconds()

tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_check_circuit_breaker_transitions_to_half_open_after_timeout
  /home/lucasg/proyectos/DemeterDocs/tests/unit/tasks/test_ml_tasks.py:161: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ml_tasks.circuit_breaker_state["last_failure_time"] = datetime.utcnow() - timedelta(

tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_increments_counter
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_opens_after_threshold
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_opens_after_threshold
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_opens_after_threshold
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_opens_after_threshold
tests/unit/tasks/test_ml_tasks.py::TestCircuitBreaker::test_record_circuit_breaker_failure_opens_after_threshold
  /home/lucasg/proyectos/DemeterDocs/app/tasks/ml_tasks.py:162: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    circuit_breaker_state["last_failure_time"] = datetime.utcnow()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.11-final-0 _______________

Name                                                      Stmts   Miss  Cover   Missing
---------------------------------------------------------------------------------------
app/__init__.py                                               0      0   100%
app/celery/__init__.py                                        2      0   100%
app/celery/base_tasks.py                                     37     16    57%   19-27, 55-56, 65-66, 77-88
app/celery_app.py                                            14      0   100%
app/controllers/__init__.py                                   6      0   100%
app/controllers/analytics_controller.py                      57     38    33%   26, 46, 55-124, 146-207, 259-303
app/controllers/config_controller.py                         64     43    33%   51-52, 59-60, 106-130, 187-220, 278-306
app/controllers/location_controller.py                      132     80    39%   56-57, 64-67, 74-79, 86-95, 103-110, 126-151, 161-197, 205, 210-246, 254, 259-295, 303, 314-395, 410-481
app/controllers/product_controller.py                       132     99    25%   60-61, 68-71, 78-85, 117-128, 164-182, 223-244, 282-307, 353-381, 436-469, 500-523
app/controllers/stock_controller.py                         138     98    29%   65-79, 86-87, 94-102, 109-121, 175-210, 258-291, 330-347, 388-420, 450-460, 491-506, 542-559
app/core/__init__.py                                          0      0   100%
app/core/config.py                                           17      0   100%
app/core/exceptions.py                                       92      7    92%   600-605, 629-636
app/core/logging.py                                          30      0   100%
app/db/__init__.py                                            0      0   100%
app/db/base.py                                                2      0   100%
app/db/session.py                                            32      2    94%   73-74
app/main.py                                                  48      3    94%   153, 193-194
app/models/__init__.py                                       28      0   100%
app/models/classification.py                                 33      0   100%
app/models/density_parameter.py                              38     11    71%   247-251, 256-260, 264
app/models/detection.py                                      52      4    92%   332, 353, 382, 399
app/models/estimation.py                                     59      7    88%   323, 328, 349, 375, 404, 417-422
app/models/location_relationships.py                         20      0   100%
app/models/packaging_catalog.py                              41     12    71%   325-339, 363-366, 377
app/models/packaging_color.py                                34     18    47%   181-190, 230-248, 259
app/models/packaging_material.py                             24      9    62%   197-213, 224
app/models/packaging_type.py                                 24      9    62%   197-213, 224
app/models/photo_processing_session.py                       61      6    90%   456-459, 494, 506-511
app/models/price_list.py                                     23      1    96%   85
app/models/product.py                                        42      1    98%   343
app/models/product_category.py                               29      0   100%
app/models/product_family.py                                 16      0   100%
app/models/product_sample_image.py                           36      1    97%   160
app/models/product_size.py                                   40     16    60%   252-267, 279-287
app/models/product_state.py                                  32      9    72%   249-264, 276
app/models/s3_image.py                                       73     25    66%   470-493, 524-532, 545-548
app/models/stock_batch.py                                    61     18    70%   428-442, 461-464, 468-470, 478-480, 491
app/models/stock_movement.py                                 55      7    87%   475-481, 492-497
app/models/storage_area.py                                   45      1    98%   328
app/models/storage_bin.py                                    49      1    98%   403
app/models/storage_bin_type.py                               44      0   100%
app/models/storage_location.py                               51      1    98%   367
app/models/storage_location_config.py                        31      6    81%   237-241, 245
app/models/user.py                                           49      2    96%   319, 362
app/models/warehouse.py                                      40      0   100%
app/repositories/__init__.py                                 29      0   100%
app/repositories/base.py                                     47     33    30%   90-91, 112-114, 143-145, 177-181, 212-222, 249-255, 285-287, 312-314
app/repositories/classification_repository.py                 6      1    83%   17
app/repositories/density_parameter_repository.py              6      1    83%   17
app/repositories/detection_repository.py                     19     10    47%   20, 34-41, 57-67
app/repositories/estimation_repository.py                    23     13    43%   20, 34-41, 55-62, 78-88
app/repositories/location_relationship_repository.py         51     36    29%   51, 75-83, 107-115, 144-153, 177-187, 220-229, 243-252, 263-269
app/repositories/packaging_catalog_repository.py              6      1    83%   17
app/repositories/packaging_color_repository.py                6      1    83%   17
app/repositories/packaging_material_repository.py             6      1    83%   17
app/repositories/packaging_type_repository.py                 6      1    83%   17
app/repositories/photo_processing_session_repository.py      26     13    50%   25, 36-38, 52-59, 73-80, 95-105
app/repositories/price_list_repository.py                     6      1    83%   17
app/repositories/product_category_repository.py              26     16    38%   20, 24-26, 30-39, 43-46
app/repositories/product_family_repository.py                26     16    38%   20, 24-26, 30-39, 43-46
app/repositories/product_repository.py                       28     18    36%   20, 24-26, 30-39, 43-49
app/repositories/product_sample_image_repository.py           6      1    83%   17
app/repositories/product_size_repository.py                   6      1    83%   17
app/repositories/product_state_repository.py                  6      1    83%   17
app/repositories/s3_image_repository.py                       6      1    83%   17
app/repositories/stock_batch_repository.py                    6      1    83%   17
app/repositories/stock_movement_repository.py                 6      1    83%   17
app/repositories/storage_area_repository.py                   6      1    83%   17
app/repositories/storage_bin_repository.py                    6      1    83%   17
app/repositories/storage_bin_type_repository.py               6      1    83%   17
app/repositories/storage_location_config_repository.py        6      1    83%   17
app/repositories/storage_location_repository.py               6      1    83%   17
app/repositories/user_repository.py                           6      1    83%   17
app/repositories/warehouse_repository.py                     45     30    33%   53, 64-66, 86-88, 119-125, 153-160, 172-181, 192-198
app/schemas/__init__.py                                       0      0   100%
app/schemas/analytics_schema.py                              10     10     0%   7-47
app/schemas/density_parameter_schema.py                      22      0   100%
app/schemas/detection_schema.py                              46      0   100%
app/schemas/estimation_schema.py                             43      0   100%
app/schemas/packaging_catalog_schema.py                      33      0   100%
app/schemas/packaging_color_schema.py                        21      0   100%
app/schemas/packaging_material_schema.py                     18      0   100%
app/schemas/packaging_type_schema.py                         18      0   100%
app/schemas/photo_processing_session_schema.py               57      1    98%   93
app/schemas/photo_schema.py                                  10      0   100%
app/schemas/price_list_schema.py                             23      0   100%
app/schemas/product_category_schema.py                       21      0   100%
app/schemas/product_family_schema.py                         21      0   100%
app/schemas/product_schema.py                                25      0   100%
app/schemas/product_size_schema.py                           24      0   100%
app/schemas/product_state_schema.py                          21      0   100%
app/schemas/s3_image_schema.py                               42      0   100%
app/schemas/stock_batch_schema.py                            28      0   100%
app/schemas/stock_movement_schema.py                         54      1    98%   25
app/schemas/storage_area_schema.py                           97     19    80%   142, 147, 166, 169, 222-233, 239-248
app/schemas/storage_bin_schema.py                            24      0   100%
app/schemas/storage_bin_type_schema.py                       16      0   100%
app/schemas/storage_location_config_schema.py                27      0   100%
app/schemas/storage_location_schema.py                       55      4    93%   44, 48, 55, 57
app/schemas/warehouse_schema.py                              93     15    84%   135, 140, 159, 162, 213-224, 231, 234, 237
app/services/__init__.py                                      0      0   100%
app/services/analytics_service.py                            36     36     0%   10-157
app/services/batch_lifecycle_service.py                      29      0   100%
app/services/density_parameter_service.py                    29      0   100%
app/services/location_hierarchy_service.py                   28      0   100%
app/services/ml_processing/__init__.py                        6      0   100%
app/services/ml_processing/band_estimation_service.py       169     27    84%   41-43, 95, 98, 101, 104, 107, 112, 117, 178, 252, 255, 300-317, 332-348, 430-432, 516, 608-609, 622-625
app/services/ml_processing/model_cache.py                    48      3    94%   20-23
app/services/ml_processing/pipeline_coordinator.py          127     84    34%   44-45, 223-235, 257-454, 480-519, 538-561
app/services/ml_processing/sahi_detection_service.py        123     91    26%   33-37, 41-42, 81-91, 191-284, 300-333, 356-380, 394-437
app/services/ml_processing/segmentation_service.py           95     51    46%   28-29, 67-86, 183, 186, 189, 219-225, 244-295, 314-332, 344-357
app/services/movement_validation_service.py                  18      0   100%
app/services/packaging_catalog_service.py                    29      0   100%
app/services/packaging_color_service.py                      29      0   100%
app/services/packaging_material_service.py                   29      0   100%
app/services/packaging_type_service.py                       29      0   100%
app/services/photo/__init__.py                                6      0   100%
app/services/photo/detection_service.py                      69     55    20%   61, 83-117, 138-193, 204-208, 222-223, 241-279, 304-320
app/services/photo/estimation_service.py                     68     53    22%   64, 87-128, 149-210, 221-225, 239-240, 254-257, 276-326
app/services/photo/photo_processing_session_service.py       89     66    26%   82, 104-121, 132-136, 147-151, 170-189, 210-240, 276-338, 359-382, 396-397, 411-412, 427-428, 451-459
app/services/photo/photo_upload_service.py                   52     33    37%   94-96, 134-268, 290-308
app/services/photo/s3_image_service.py                      122     16    87%   94-101, 180-185, 271, 276, 302-307, 376-381, 422, 512-517, 529-531
app/services/price_list_service.py                           29      0   100%
app/services/product_category_service.py                     29      0   100%
app/services/product_family_service.py                       35      2    94%   40-41
app/services/product_service.py                              70      3    96%   80-82, 121
app/services/product_size_service.py                         29      0   100%
app/services/product_state_service.py                        29      0   100%
app/services/stock_batch_service.py                          20      0   100%
app/services/stock_movement_service.py                       17      5    71%   27-37
app/services/storage_area_service.py                         90      7    92%   246, 400-410
app/services/storage_bin_service.py                          27      3    89%   45-47
app/services/storage_bin_type_service.py                     17      0   100%
app/services/storage_location_config_service.py              29      0   100%
app/services/storage_location_service.py                     78      7    91%   173, 207-215
app/services/warehouse_service.py                            70      2    97%   399, 405
app/tasks/__init__.py                                         2      0   100%
app/tasks/ml_tasks.py                                       166     68    59%   236-243, 247-250, 290-300, 365-467, 612-619, 634-645, 668-687, 697-708
---------------------------------------------------------------------------------------
TOTAL                                                      5183   1417    73%
Coverage HTML written to dir htmlcov
FAIL Required test coverage of 80% not reached. Total coverage: 72.66%
=========================== short test summary info ============================
FAILED tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationAccuracy::test_estimation_accuracy_within_10_percent
FAILED tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationAccuracy::test_estimation_compensates_for_missed_detections
FAILED tests/integration/ml_processing/test_band_estimation_integration.py::TestBandEstimationEndToEnd::test_estimations_match_db_schema
FAILED tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationCeleryTasks::test_task_uses_cached_model_across_invocations
FAILED tests/integration/ml_processing/test_model_singleton_integration.py::TestModelCacheIntegrationCeleryTasks::test_different_workers_use_different_models
FAILED tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineIntegration::test_complete_pipeline_with_real_services
FAILED tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineIntegration::test_complete_pipeline_empty_image
FAILED tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelinePerformance::test_pipeline_performance_cpu_benchmark
FAILED tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineErrorRecovery::test_pipeline_handles_corrupted_image
FAILED tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineErrorRecovery::test_pipeline_handles_missing_image
FAILED tests/integration/ml_processing/test_pipeline_integration.py::TestMLPipelineResultValidation::test_pipeline_results_match_database
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_seg_model_property_returns_cached_instance
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_det_model_property_returns_cached_instance
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_seg_and_det_models_are_different
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskModelProperties::test_models_use_correct_worker_id
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_extracted_from_gpu_hostname
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_defaults_to_zero_for_invalid_format
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_handles_no_request
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskWorkerID::test_worker_id_handles_missing_hostname
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskIntegrationWithCache::test_multiple_tasks_share_same_model_instance
FAILED tests/unit/celery/test_base_tasks.py::TestModelSingletonTaskIntegrationWithCache::test_tasks_on_different_workers_use_different_models
FAILED tests/unit/models/test_classification.py::TestClassificationRelationships::test_packaging_catalog_relationship_commented_out
FAILED tests/unit/models/test_classification.py::TestClassificationRelationships::test_detections_relationship_commented_out
FAILED tests/unit/models/test_classification.py::TestClassificationRelationships::test_estimations_relationship_commented_out
FAILED tests/unit/models/test_product.py::TestProductRelationships::test_stock_batches_relationship_commented_out
FAILED tests/unit/models/test_product_family.py::TestProductFamilyRelationships::test_products_relationship_commented_out
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_requires_hyphen
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_uppercase_enforced
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_alphanumeric_only
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_length_validation
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_required
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaCodeValidation::test_storage_area_code_empty_string
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaPositionEnum::test_position_enum_invalid_values
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaForeignKeys::test_warehouse_id_required
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaRequiredFields::test_name_field_required
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaRequiredFields::test_geometry_field_required
FAILED tests/unit/models/test_storage_area.py::TestStorageAreaDefaultValues::test_active_defaults_to_true
FAILED tests/unit/models/test_storage_bin_type.py::TestBasicCRUD::test_create_type_with_minimal_fields
FAILED tests/unit/models/test_storage_bin_type.py::TestFieldConstraints::test_code_required
FAILED tests/unit/models/test_storage_bin_type.py::TestFieldConstraints::test_name_required
FAILED tests/unit/models/test_storage_bin_type.py::TestFieldConstraints::test_category_required
FAILED tests/unit/models/test_storage_bin_type.py::TestDefaultValues::test_is_grid_default_false
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_length_validation
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_required
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_empty_string_rejected
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationQRCodeValidation::test_qr_code_whitespace_only_rejected
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_uppercase_enforced
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_alphanumeric_only
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_length_validation
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_required
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationCodeValidation::test_storage_location_code_empty_string
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationForeignKeys::test_storage_area_id_required
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationRequiredFields::test_name_field_required
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationRequiredFields::test_geometry_field_required
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationDefaultValues::test_active_defaults_to_true
FAILED tests/unit/models/test_storage_location.py::TestStorageLocationFieldCombinations::test_inactive_storage_location
FAILED tests/unit/models/test_user.py::TestUserRelationships::test_relationships_commented_out
FAILED tests/unit/models/test_user.py::TestUserRelationships::test_relationship_attributes_not_present
FAILED tests/unit/models/test_warehouse.py::TestWarehouseTypeEnum::test_warehouse_type_enum_invalid_values
FAILED tests/unit/models/test_warehouse.py::TestWarehouseTypeEnum::test_warehouse_type_required
FAILED tests/unit/models/test_warehouse.py::TestWarehouseRequiredFields::test_name_field_required
FAILED tests/unit/models/test_warehouse.py::TestWarehouseRequiredFields::test_geometry_field_required
FAILED tests/unit/models/test_warehouse.py::TestWarehouseDefaultValues::test_active_defaults_to_true
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_success
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_progress_updates
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_result_aggregation
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorHappyPath::test_process_complete_pipeline_no_segments
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_segmentation_fails
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_detection_fails_warning
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_estimation_fails_warning
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorErrorHandling::test_process_complete_pipeline_persistence_fails
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorContainerTypeRouting::test_process_complete_pipeline_segments_use_sahi
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorContainerTypeRouting::test_process_complete_pipeline_boxes_use_direct
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorContainerTypeRouting::test_process_complete_pipeline_plugs_use_direct
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEstimationLogic::test_process_complete_pipeline_estimation_only_for_segments
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEstimationLogic::test_process_complete_pipeline_estimation_receives_detections
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorPerformance::test_process_complete_pipeline_performance_benchmark
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEdgeCases::test_process_complete_pipeline_invalid_session_id
FAILED tests/unit/services/ml_processing/test_pipeline_coordinator.py::TestMLPipelineCoordinatorEdgeCases::test_process_complete_pipeline_zero_confidence_detections
FAILED tests/unit/services/test_storage_bin_service.py::test_create_storage_bin_duplicate_code
FAILED tests/unit/services/test_storage_bin_service.py::test_get_bins_by_location_success
FAILED tests/unit/services/test_storage_bin_service.py::test_get_bins_by_location_empty
FAILED tests/unit/tasks/test_ml_tasks.py::TestMLParentTask::test_ml_parent_task_empty_image_data
FAILED tests/unit/tasks/test_ml_tasks.py::TestMLParentTask::test_ml_parent_task_circuit_breaker_open
FAILED tests/unit/tasks/test_ml_tasks.py::TestMLParentTask::test_ml_parent_task_retries_on_failure
FAILED tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_success
FAILED tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_image_not_found
FAILED tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_retries_on_ml_failure
FAILED tests/unit/tasks/test_ml_tasks.py::TestMLChildTask::test_ml_child_task_exponential_backoff
FAILED tests/unit/tasks/test_ml_tasks.py::TestHelperFunctions::test_mark_session_processing
FAILED tests/unit/tasks/test_ml_tasks.py::TestHelperFunctions::test_mark_session_completed
FAILED tests/unit/tasks/test_ml_tasks.py::TestHelperFunctions::test_mark_session_failed
ERROR tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_create_and_persist_category
ERROR tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_code_uniqueness_at_db_level
ERROR tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_query_by_code
ERROR tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_update_category
ERROR tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_delete_category
ERROR tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_order_by_name
ERROR tests/integration/models/test_product_category.py::TestProductCategoryDatabasePersistence::test_count_categories
ERROR tests/integration/models/test_product_size.py::TestProductSizeSeedData::test_seed_data_loaded
ERROR tests/integration/models/test_product_size.py::TestProductSizeSeedData::test_seed_data_height_ranges
ERROR tests/integration/models/test_product_size.py::TestProductSizeDBConstraints::test_code_unique_constraint_db_level
ERROR tests/integration/models/test_product_size.py::TestProductSizeDBConstraints::test_code_check_constraint_min_length
ERROR tests/integration/models/test_product_size.py::TestProductSizeQueries::test_order_by_sort_order
ERROR tests/integration/models/test_product_size.py::TestProductSizeQueries::test_query_by_code
ERROR tests/integration/models/test_product_size.py::TestProductSizeQueries::test_filter_with_height_range
ERROR tests/integration/models/test_product_size.py::TestProductSizeQueries::test_filter_without_height_range
ERROR tests/integration/models/test_product_state.py::TestProductStateSeedData::test_seed_data_loaded
ERROR tests/integration/models/test_product_state.py::TestProductStateSeedData::test_seed_data_is_sellable_logic
ERROR tests/integration/models/test_product_state.py::TestProductStateDBConstraints::test_code_unique_constraint_db_level
ERROR tests/integration/models/test_product_state.py::TestProductStateDBConstraints::test_code_check_constraint_min_length
ERROR tests/integration/models/test_product_state.py::TestProductStateQueries::test_filter_by_is_sellable_true
ERROR tests/integration/models/test_product_state.py::TestProductStateQueries::test_filter_by_is_sellable_false
ERROR tests/integration/models/test_product_state.py::TestProductStateQueries::test_order_by_sort_order
ERROR tests/integration/models/test_product_state.py::TestProductStateQueries::test_query_by_code
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGeneratedColumnArea::test_area_auto_calculated_on_insert
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGeneratedColumnArea::test_area_updates_when_geometry_changes
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGeneratedColumnArea::test_area_calculation_uses_geography_cast
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCentroidTrigger::test_centroid_auto_set_on_insert
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCentroidTrigger::test_centroid_within_polygon
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCentroidTrigger::test_centroid_updates_on_geometry_change
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_area_within_warehouse_success
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_area_outside_warehouse_rejected
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_area_partially_outside_rejected
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialContainment::test_update_area_outside_boundary_rejected
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaHierarchy::test_hierarchical_area_query
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCascadeDelete::test_cascade_delete_from_warehouse
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCascadeDelete::test_cascade_delete_parent_area
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialQueries::test_find_area_by_gps_point
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaSpatialQueries::test_find_areas_within_radius
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaGISTIndexPerformance::test_gist_index_used_for_spatial_query
ERROR tests/integration/models/test_storage_area_geospatial.py::TestStorageAreaCodeUniqueness::test_duplicate_code_rejected
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinCascadeDelete::test_cascade_delete_from_location
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinCascadeDelete::test_cascade_delete_from_area
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinCascadeDelete::test_cascade_delete_from_warehouse
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_confidence_high
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_confidence_low
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_container_type
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinJsonbQueries::test_filter_by_ml_model_version
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinCodeUniqueness::test_code_uniqueness_enforced
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinCodeUniqueness::test_different_codes_allowed
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinForeignKeyIntegrity::test_invalid_storage_location_id
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinForeignKeyIntegrity::test_null_storage_location_id
ERROR tests/integration/models/test_storage_bin.py::TestStorageBinForeignKeyIntegrity::test_null_storage_bin_type_id
ERROR tests/integration/models/test_storage_bin_type.py::TestSeedData::test_seed_data_loaded
ERROR tests/integration/models/test_storage_bin_type.py::TestSeedData::test_seed_data_integrity
ERROR tests/integration/models/test_storage_bin_type.py::TestRestrictDelete::test_delete_bin_type_with_storage_bins_fails
ERROR tests/integration/models/test_storage_bin_type.py::TestRestrictDelete::test_delete_bin_type_without_storage_bins_succeeds
ERROR tests/integration/models/test_storage_bin_type.py::TestRelationships::test_query_storage_bins_from_bin_type
ERROR tests/integration/models/test_storage_bin_type.py::TestRelationships::test_fk_integrity_storage_bins_to_bin_type
ERROR tests/integration/models/test_storage_bin_type.py::TestCodeUniqueness::test_create_two_types_with_same_code_fails
ERROR tests/integration/models/test_storage_bin_type.py::TestCodeUniqueness::test_create_types_with_different_codes_succeeds
ERROR tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_grid_type_with_null_rows_fails
ERROR tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_grid_type_with_null_columns_fails
ERROR tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_non_grid_type_with_null_rows_succeeds
ERROR tests/integration/models/test_storage_bin_type.py::TestCheckConstraintAtDBLevel::test_grid_type_with_rows_and_columns_succeeds
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationGeneratedColumnArea::test_area_always_zero_for_point
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCentroidTrigger::test_centroid_equals_coordinates_on_insert
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCentroidTrigger::test_centroid_updates_with_coordinates
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialContainment::test_location_within_area_success
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialContainment::test_location_outside_area_rejected
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialContainment::test_update_location_outside_area_rejected
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationQRCodeUniqueness::test_qr_code_uniqueness_enforced
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCascadeDelete::test_cascade_delete_from_area
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationPhotoSessionFK::test_photo_session_id_nullable
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialQueries::test_find_location_by_gps_point
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationSpatialQueries::test_find_locations_in_area
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationGISTIndexPerformance::test_gist_index_used_for_spatial_query
ERROR tests/integration/models/test_storage_location_geospatial.py::TestStorageLocationCodeUniqueness::test_duplicate_code_rejected
ERROR tests/integration/models/test_user_db.py::test_insert_user_all_fields
ERROR tests/integration/models/test_user_db.py::test_insert_user_minimal_fields
ERROR tests/integration/models/test_user_db.py::test_query_by_email - sqlalch...
ERROR tests/integration/models/test_user_db.py::test_query_by_role - sqlalche...
ERROR tests/integration/models/test_user_db.py::test_query_active_users - sql...
ERROR tests/integration/models/test_user_db.py::test_unique_email_constraint_db
ERROR tests/integration/models/test_user_db.py::test_update_last_login - sqla...
ERROR tests/integration/models/test_user_db.py::test_soft_delete_user - sqlal...
ERROR tests/integration/models/test_user_db.py::test_seed_admin_user_exists
ERROR tests/integration/models/test_user_db.py::test_case_insensitive_email
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGeneratedColumnArea::test_area_auto_calculated_on_insert
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGeneratedColumnArea::test_area_updates_when_geometry_changes
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGeneratedColumnArea::test_area_calculation_uses_geography_cast
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCentroidTrigger::test_centroid_auto_set_on_insert
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCentroidTrigger::test_centroid_within_polygon
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCentroidTrigger::test_centroid_updates_on_geometry_change
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseSpatialQueries::test_find_warehouses_within_radius
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseSpatialQueries::test_find_nearest_warehouse
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseSpatialQueries::test_point_in_polygon_localization
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGISTIndexPerformance::test_gist_index_used_for_spatial_query
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseGISTIndexPerformance::test_gist_index_used_for_containment_query
ERROR tests/integration/models/test_warehouse_geospatial.py::TestWarehouseCodeUniqueness::test_duplicate_code_rejected
ERROR tests/integration/tasks/test_ml_tasks_integration.py::TestMLTasksIntegration::test_ml_parent_task_updates_database
ERROR tests/integration/tasks/test_ml_tasks_integration.py::TestMLTasksIntegration::test_ml_child_task_with_real_session
ERROR tests/integration/tasks/test_ml_tasks_integration.py::TestMLTasksIntegration::test_ml_aggregation_callback_with_database
ERROR tests/integration/test_api_health.py::test_health_endpoint_returns_200
ERROR tests/integration/test_api_health.py::test_health_endpoint_includes_correlation_id
ERROR tests/integration/test_api_health.py::test_health_endpoint_with_custom_correlation_id
ERROR tests/integration/test_product_category_service.py::test_create_category_success
ERROR tests/integration/test_product_category_service.py::test_create_category_minimal_fields
ERROR tests/integration/test_product_category_service.py::test_create_category_code_auto_uppercase
ERROR tests/integration/test_product_category_service.py::test_create_category_duplicate_code
ERROR tests/integration/test_product_category_service.py::test_get_category_by_id_success
ERROR tests/integration/test_product_category_service.py::test_get_category_by_id_not_found
ERROR tests/integration/test_product_category_service.py::test_get_all_categories_success
ERROR tests/integration/test_product_category_service.py::test_get_all_categories_empty_database
ERROR tests/integration/test_product_category_service.py::test_update_category_success
ERROR tests/integration/test_product_category_service.py::test_update_category_partial
ERROR tests/integration/test_product_category_service.py::test_update_category_not_found
ERROR tests/integration/test_product_category_service.py::test_delete_category_success
ERROR tests/integration/test_product_category_service.py::test_delete_category_not_found
ERROR tests/integration/test_product_category_service.py::test_category_code_validation
ERROR tests/integration/test_product_category_service.py::test_multiple_categories_independence
ERROR tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_create_family_with_category
ERROR tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_create_family_minimal_fields
ERROR tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_query_families_by_category
ERROR tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_query_family_with_category_join
ERROR tests/integration/test_product_family_db.py::TestProductFamilyDatabaseOperations::test_create_multiple_families_same_category
ERROR tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_cascade_delete_category_deletes_families
ERROR tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_foreign_key_constraint_invalid_category
ERROR tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_not_null_constraint_name
ERROR tests/integration/test_product_family_db.py::TestProductFamilyConstraints::test_not_null_constraint_category_id
ERROR tests/integration/test_product_family_db.py::TestProductFamilyUpdateDelete::test_update_family_name
ERROR tests/integration/test_product_family_db.py::TestProductFamilyUpdateDelete::test_delete_family
ERROR tests/integration/test_product_service.py::test_create_product_success
ERROR tests/integration/test_product_service.py::test_create_product_minimal_fields
ERROR tests/integration/test_product_service.py::test_create_product_sku_auto_increment
ERROR tests/integration/test_product_service.py::test_create_product_different_families_independent_skus
ERROR tests/integration/test_product_service.py::test_create_product_invalid_family
ERROR tests/integration/test_product_service.py::test_get_product_by_id_success
ERROR tests/integration/test_product_service.py::test_get_product_by_id_not_found
ERROR tests/integration/test_product_service.py::test_get_product_by_sku_success
ERROR tests/integration/test_product_service.py::test_get_product_by_sku_case_insensitive
ERROR tests/integration/test_product_service.py::test_get_product_by_sku_not_found
ERROR tests/integration/test_product_service.py::test_get_products_by_family_success
ERROR tests/integration/test_product_service.py::test_get_products_by_family_filtering
ERROR tests/integration/test_product_service.py::test_get_products_by_family_invalid_family
ERROR tests/integration/test_product_service.py::test_get_all_products_success
ERROR tests/integration/test_product_service.py::test_update_product_success
ERROR tests/integration/test_product_service.py::test_update_product_partial
ERROR tests/integration/test_product_service.py::test_update_product_sku_immutable
ERROR tests/integration/test_product_service.py::test_update_product_not_found
ERROR tests/integration/test_product_service.py::test_delete_product_success
ERROR tests/integration/test_product_service.py::test_delete_product_not_found
ERROR tests/integration/test_product_service.py::test_sku_generation_handles_family_name_with_spaces
ERROR tests/integration/test_product_service.py::test_sku_generation_truncates_long_family_names
ERROR tests/integration/test_s3_image_service.py::test_upload_original_full_workflow
ERROR tests/integration/test_s3_image_service.py::test_upload_with_metadata_integration
ERROR tests/integration/test_s3_image_service.py::test_upload_visualization_integration
ERROR tests/integration/test_s3_image_service.py::test_download_uploaded_image_workflow
ERROR tests/integration/test_s3_image_service.py::test_delete_image_integration
ERROR tests/integration/test_s3_image_service.py::test_delete_image_with_thumbnail_integration
ERROR tests/integration/test_s3_image_service.py::test_generate_presigned_url_for_uploaded_image
ERROR tests/integration/test_s3_image_service.py::test_concurrent_uploads_same_session
ERROR tests/integration/test_s3_image_service.py::test_upload_different_content_types
ERROR tests/integration/test_s3_image_service.py::test_upload_rollback_on_s3_failure
ERROR tests/integration/test_s3_image_service.py::test_delete_nonexistent_image_integration
ERROR tests/integration/test_s3_image_service.py::test_upload_with_invalid_gps_coordinates
ERROR tests/integration/test_s3_image_service.py::test_upload_with_valid_gps_coordinates
ERROR tests/integration/test_s3_image_service.py::test_upload_file_exceeds_limit_integration
ERROR tests/integration/test_s3_image_service.py::test_upload_maximum_allowed_file_size
ERROR tests/integration/test_s3_image_service.py::test_upload_sets_initial_status
ERROR tests/integration/test_s3_image_service.py::test_query_images_by_status
ERROR tests/integration/test_warehouse_service_integration.py::test_warehouse_service_full_lifecycle
ERROR tests/integration/test_warehouse_service_integration.py::test_gps_lookup_point_inside_polygon
ERROR tests/integration/test_warehouse_service_integration.py::test_gps_lookup_point_outside_polygon
ERROR tests/integration/test_warehouse_service_integration.py::test_duplicate_code_rejection
ERROR tests/integration/test_warehouse_service_integration.py::test_invalid_geometry_rejected
ERROR tests/integration/test_warehouse_service_integration.py::test_get_warehouse_by_id_not_found
ERROR tests/integration/test_warehouse_service_integration.py::test_update_warehouse_not_found
ERROR tests/integration/test_warehouse_service_integration.py::test_delete_warehouse_not_found
ERROR tests/integration/test_warehouse_service_integration.py::test_get_active_warehouses_filters_inactive
ERROR tests/integration/test_warehouse_service_integration.py::test_polygon_with_minimum_vertices
ERROR tests/integration/test_warehouse_service_integration.py::test_complex_polygon_with_many_vertices
ERROR tests/unit/models/test_detection.py::TestDetectionBasicCRUD::test_create_detection_minimal_fields
ERROR tests/unit/models/test_detection.py::TestDetectionBasicCRUD::test_create_detection_all_fields
ERROR tests/unit/models/test_detection.py::TestDetectionBasicCRUD::test_read_detection_by_id
ERROR tests/unit/models/test_detection.py::TestDetectionConfidenceValidation::test_confidence_min_value
ERROR tests/unit/models/test_detection.py::TestDetectionConfidenceValidation::test_confidence_max_value
ERROR tests/unit/models/test_detection.py::TestDetectionBooleanFlags::test_is_empty_container_true
ERROR tests/unit/models/test_detection.py::TestDetectionBooleanFlags::test_is_alive_false
ERROR tests/unit/models/test_detection.py::TestDetectionTimestamps::test_created_at_auto_populated
ERROR tests/unit/models/test_detection.py::TestDetectionCascadeDelete::test_delete_session_cascades_to_detections
ERROR tests/unit/models/test_estimation.py::TestEstimationBasicCRUD::test_create_estimation_minimal_fields
ERROR tests/unit/models/test_estimation.py::TestEstimationBasicCRUD::test_create_estimation_all_fields
ERROR tests/unit/models/test_estimation.py::TestEstimationBasicCRUD::test_read_estimation_by_id
ERROR tests/unit/models/test_estimation.py::TestEstimationCalculationMethodEnum::test_calculation_method_band_estimation
ERROR tests/unit/models/test_estimation.py::TestEstimationCalculationMethodEnum::test_calculation_method_density_estimation
ERROR tests/unit/models/test_estimation.py::TestEstimationCalculationMethodEnum::test_calculation_method_grid_analysis
ERROR tests/unit/models/test_estimation.py::TestEstimationConfidenceValidation::test_confidence_default_value
ERROR tests/unit/models/test_estimation.py::TestEstimationConfidenceValidation::test_confidence_min_value
ERROR tests/unit/models/test_estimation.py::TestEstimationConfidenceValidation::test_confidence_max_value
ERROR tests/unit/models/test_estimation.py::TestEstimationTimestamps::test_created_at_auto_populated
ERROR tests/unit/models/test_estimation.py::TestEstimationCascadeDelete::test_delete_session_cascades_to_estimations
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_create_session_minimal_fields
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_create_session_all_fields
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_read_session_by_id
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_update_session_status
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionBasicCRUD::test_delete_session_cascade
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_pending
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_processing
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_completed
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionStatusEnum::test_status_failed
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_min_value
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_max_value
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_out_of_range_high
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionConfidenceValidation::test_avg_confidence_nullable
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_category_counts_empty_dict_default
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_category_counts_with_data
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_manual_adjustments_empty_dict_default
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionJSONBFields::test_manual_adjustments_with_data
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionAggregates::test_aggregates_default_zero
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionAggregates::test_aggregates_with_values
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionTimestamps::test_created_at_auto_populated
ERROR tests/unit/models/test_photo_processing_session.py::TestPhotoProcessingSessionTimestamps::test_updated_at_on_modification
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_valid_uppercase
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_valid_three_chars
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_auto_uppercase
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_empty_raises_error
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_with_hyphens_raises_error
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_with_spaces_raises_error
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_too_short_raises_error
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_too_long_raises_error
ERROR tests/unit/models/test_product_size.py::TestProductSizeCodeValidation::test_code_with_underscores_valid
ERROR tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_height_ranges_nullable
ERROR tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_height_ranges_valid_values
ERROR tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_custom_size_no_height_ranges
ERROR tests/unit/models/test_product_size.py::TestProductSizeHeightRanges::test_xxl_no_max_height
ERROR tests/unit/models/test_product_size.py::TestProductSizeSortOrder::test_sort_order_default_99
ERROR tests/unit/models/test_product_size.py::TestProductSizeSortOrder::test_sort_order_custom_value
ERROR tests/unit/models/test_product_size.py::TestProductSizeSortOrder::test_sort_order_zero_valid
ERROR tests/unit/models/test_product_size.py::TestProductSizeBasicCRUD::test_create_product_size
ERROR tests/unit/models/test_product_size.py::TestProductSizeBasicCRUD::test_update_product_size
ERROR tests/unit/models/test_product_size.py::TestProductSizeBasicCRUD::test_delete_product_size
ERROR tests/unit/models/test_product_size.py::TestProductSizeRepr::test_repr_format_with_range
ERROR tests/unit/models/test_product_size.py::TestProductSizeRepr::test_repr_format_no_range
ERROR tests/unit/models/test_product_size.py::TestProductSizeUniqueness::test_duplicate_code_raises_integrity_error
ERROR tests/unit/models/test_product_size.py::TestProductSizeFields::test_name_required
ERROR tests/unit/models/test_product_size.py::TestProductSizeFields::test_description_nullable
ERROR tests/unit/models/test_product_size.py::TestProductSizeFields::test_timestamps_auto_generated
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_valid_uppercase
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_auto_uppercase
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_empty_raises_error
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_with_hyphens_raises_error
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_with_spaces_raises_error
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_too_short_raises_error
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_too_long_raises_error
ERROR tests/unit/models/test_product_state.py::TestProductStateCodeValidation::test_code_with_underscores_valid
ERROR tests/unit/models/test_product_state.py::TestProductStateSellableFlag::test_is_sellable_default_false
ERROR tests/unit/models/test_product_state.py::TestProductStateSellableFlag::test_is_sellable_explicit_true
ERROR tests/unit/models/test_product_state.py::TestProductStateSellableFlag::test_is_sellable_explicit_false
ERROR tests/unit/models/test_product_state.py::TestProductStateSortOrder::test_sort_order_default_99
ERROR tests/unit/models/test_product_state.py::TestProductStateSortOrder::test_sort_order_custom_value
ERROR tests/unit/models/test_product_state.py::TestProductStateSortOrder::test_sort_order_zero_valid
ERROR tests/unit/models/test_product_state.py::TestProductStateBasicCRUD::test_create_product_state
ERROR tests/unit/models/test_product_state.py::TestProductStateBasicCRUD::test_update_product_state
ERROR tests/unit/models/test_product_state.py::TestProductStateBasicCRUD::test_delete_product_state
ERROR tests/unit/models/test_product_state.py::TestProductStateRepr::test_repr_format
ERROR tests/unit/models/test_product_state.py::TestProductStateUniqueness::test_duplicate_code_raises_integrity_error
ERROR tests/unit/models/test_product_state.py::TestProductStateFields::test_name_required
ERROR tests/unit/models/test_product_state.py::TestProductStateFields::test_description_nullable
ERROR tests/unit/models/test_product_state.py::TestProductStateFields::test_timestamps_auto_generated
ERROR tests/unit/repositories/test_base_repository.py::test_create_record - s...
ERROR tests/unit/repositories/test_base_repository.py::test_get_by_id_found
ERROR tests/unit/repositories/test_base_repository.py::test_get_by_id_not_found
ERROR tests/unit/repositories/test_base_repository.py::test_update_partial - ...
ERROR tests/unit/repositories/test_base_repository.py::test_update_not_found
ERROR tests/unit/repositories/test_base_repository.py::test_delete_existing
ERROR tests/unit/repositories/test_base_repository.py::test_delete_not_found
ERROR tests/unit/repositories/test_base_repository.py::test_get_multi_pagination_first_page
ERROR tests/unit/repositories/test_base_repository.py::test_get_multi_pagination_second_page
ERROR tests/unit/repositories/test_base_repository.py::test_get_multi_empty_result
ERROR tests/unit/repositories/test_base_repository.py::test_get_multi_limit_zero
ERROR tests/unit/repositories/test_base_repository.py::test_get_multi_with_single_filter
ERROR tests/unit/repositories/test_base_repository.py::test_get_multi_with_multiple_filters
ERROR tests/unit/repositories/test_base_repository.py::test_count_without_filters
ERROR tests/unit/repositories/test_base_repository.py::test_count_with_filters
ERROR tests/unit/repositories/test_base_repository.py::test_count_empty_table
ERROR tests/unit/repositories/test_base_repository.py::test_exists_true - sql...
ERROR tests/unit/repositories/test_base_repository.py::test_exists_false - sq...
ERROR tests/unit/repositories/test_base_repository.py::test_flush_without_commit
ERROR tests/unit/repositories/test_base_repository.py::test_multiple_operations_same_session
ERROR tests/unit/repositories/test_base_repository.py::test_create_with_missing_required_field
ERROR tests/unit/repositories/test_base_repository.py::test_update_multiple_fields
ERROR tests/unit/repositories/test_base_repository.py::test_get_multi_large_skip
= 92 failed, 935 passed, 8 skipped, 10 warnings, 292 errors in 140.92s (0:02:20) =
